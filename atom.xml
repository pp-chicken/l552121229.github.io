<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°å½ã®åšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://hexo.lilis.xin/"/>
  <updated>2019-09-12T09:36:21.478Z</updated>
  <id>https://hexo.lilis.xin/</id>
  
  <author>
    <name>å°å½</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>hexo æ’ä»¶</title>
    <link href="https://hexo.lilis.xin/posts/54690ca6/"/>
    <id>https://hexo.lilis.xin/posts/54690ca6/</id>
    <published>2019-09-12T07:45:38.000Z</published>
    <updated>2019-09-12T09:36:21.478Z</updated>
    
    <content type="html"><![CDATA[<p>æœé›†æ•´ç†å¸¸ç”¨çš„<code>hexo</code>æ’ä»¶<br><a id="more"></a></p><h4 id="hexo-github-card"><a href="#hexo-github-card" class="headerlink" title="hexo-github-card"></a>hexo-github-card</h4><div style="text-align:text-align_position"><div class="github-card" data-user="Gisonrg" data-repo="hexo-github-card" data-height="200" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>ä½¿ç”¨è¿™ä¸ªæ’ä»¶å¯ä»¥åƒä¸Šé¢è¿™æ ·ğŸ‘†æ˜¾ç¤ºé€¼æ ¼è¾ƒé«˜çš„GitHubé“¾æ¥<br>ä½¿ç”¨æ—¶åªéœ€è¦æ’å…¥ä¸‹é¢ğŸ‘‡è¿™ä¸ªğŸ·ï¸å°±å¯ä»¥äº†<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% githubCard user:your_user [repo:your_repo] [width:400] [height:200] [theme:default] [client_id:your_client_id] [client_secret:your_client_secret] [align:text-align_position] %&#125;</span><br></pre></td></tr></table></figure><p></p><p>è¿™ä¸ªæ’ä»¶çš„é»˜è®¤å®½åº¦æ„Ÿè§‰æœ‰ç‚¹ä¸å¤Ÿç¾è§‚ï¼Œæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦è‡ªå®šä¹‰å®½åº¦ä¹Ÿæœ‰ç‚¹è´¹äº‹ï¼Œè€Œä¸”é»˜è®¤æ‰“å¼€æ–¹å¼æ˜¯åœ¨å½“å‰é¡µé¢é¡µæ‰“å¼€å¾ˆä¸äººæ€§åŒ–ï¼Œæˆ‘å°±åœ¨æºæ–‡ä»¶<code>node_modules/hexo-github-card/index.js</code>è¿›è¡Œäº†å°çš„ä¿®æ”¹<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = argsObj.user,</span><br><span class="line">  repo = argsObj.repo,</span><br><span class="line">  width = argsObj.width || <span class="string">'100%'</span>,<span class="comment">//å®½åº¦è‡ªé€‚åº”</span></span><br><span class="line">  height = argsObj.height || <span class="string">'200'</span>,</span><br><span class="line">  theme = argsObj.theme || <span class="string">'default'</span>,</span><br><span class="line">  client_id = argsObj.client_id || <span class="string">''</span>,</span><br><span class="line">  client_secret = argsObj.client_secret || <span class="string">''</span>,</span><br><span class="line">  align = argsObj.align || <span class="string">'center'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> payload = &#123;</span><br><span class="line">  user,</span><br><span class="line">  repo,</span><br><span class="line">  height,</span><br><span class="line">  width,</span><br><span class="line">  theme,</span><br><span class="line">  client_id,</span><br><span class="line">  client_secret,</span><br><span class="line">  style: <span class="string">`text-align: <span class="subst">$&#123;align&#125;</span>`</span>,</span><br><span class="line">  target: <span class="string">'blank'</span>,<span class="comment">//åŠ ä¸Šè¿™ä¸ªå¯ä»¥åœ¨å…¶ä»–æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœé›†æ•´ç†å¸¸ç”¨çš„&lt;code&gt;hexo&lt;/code&gt;æ’ä»¶&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>gitæœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“</title>
    <link href="https://hexo.lilis.xin/posts/ac107f22/"/>
    <id>https://hexo.lilis.xin/posts/ac107f22/</id>
    <published>2019-09-11T09:50:25.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<h4 id="git-åˆå§‹åŒ–"><a href="#git-åˆå§‹åŒ–" class="headerlink" title="git åˆå§‹åŒ–"></a>git åˆå§‹åŒ–</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git init #gitç›®å½•åˆå§‹åŒ–</span><br><span class="line">git init &lt;repo&gt; #æœ¬åœ°åˆå§‹åŒ–ï¼Œå¹¶ä¸”å»ºç«‹ä¸€ä¸ªåä¸ºrepoçš„ç©ºä»“åº“</span><br><span class="line">git init --bare #gitè£¸ä»“åº“åˆå§‹åŒ–</span><br><span class="line">git init --bare &lt;repo&gt; #æŒ‡å®šæŸä¸ªç›®å½•æˆä¸ºä¸­å¿ƒä»“åº“ï¼ˆè£¸ä»“åº“ï¼‰</span><br></pre></td></tr></table></figure><p><code>git init</code>è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª .git çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥è¿½è¸ªä»“åº“çš„æ‰€æœ‰å˜æ›´ã€‚<br><code>--bare</code>: ä½¿ç”¨ â€“bare å‚æ•°åˆå§‹åŒ–çš„ä»“åº“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºè£¸ä»“åº“ï¼Œ å› ä¸ºè¿™æ ·åˆ›å»ºçš„ä»“åº“å¹¶ä¸åŒ…å« å·¥ä½œåŒº ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„ Git å‘½ä»¤ã€‚<br><a id="more"></a></p><h5 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h5><ul><li><p>ç›´æ¥ git init åˆ›å»ºçš„ä»“åº“:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">repositoryformatversion = 0</span><br><span class="line">filemode = true</span><br><span class="line">bare = false</span><br><span class="line">logallrefupdates = true</span><br><span class="line">ignorecase = true</span><br><span class="line">precomposeunicode = true</span><br></pre></td></tr></table></figure></li><li><p>åŠ äº†<code>--bare</code>åˆ›å»ºçš„è£¸ä»“åº“:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">repositoryformatversion = 0</span><br><span class="line">filemode = true</span><br><span class="line">bare = true</span><br><span class="line">ignorecase = true</span><br><span class="line">precomposeunicode = true</span><br></pre></td></tr></table></figure></li></ul><p>å¯ä»¥çœ‹åˆ°æœ€ç›´è§‚çš„å·®å¼‚åœ¨äº<code>bare</code>é…ç½®é¡¹æ˜¯å¦ä¸º<code>true</code>ï¼Œ æ­¤å¤–ä¸åŠ <code>--bare</code>åˆ›å»ºçš„æœ¬åœ°ä»“åº“é…ç½®ä¸­æœ‰ä¸€é¡¹<code>logallrefupdates = true</code>, ä½œç”¨æ ¹æ®åå­—å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œ è®°å½•æ‰€æœ‰çš„<code>ref</code>(å¼•ç”¨) æ›´æ–°ï¼Œ å…³äº<code>ref</code>çš„éƒ¨åˆ†ä¹‹åæœ‰æ—¶é—´å¯ä»¥å†å†™ï¼Œè¿™ä¸ªé…ç½®å¯ä»¥ç†è§£ä¸ºæ˜¯ Git çš„ä¸€é“é˜²çº¿ã€‚</p><h4 id="åŠŸèƒ½å·®å¼‚"><a href="#åŠŸèƒ½å·®å¼‚" class="headerlink" title="åŠŸèƒ½å·®å¼‚"></a>åŠŸèƒ½å·®å¼‚</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ä¾‹å­æ¼”ç¤ºä¸€ä¸‹ã€‚<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ç›´æ¥åˆ›å»ºæœ¬åœ°ä»“åº“</span></span><br><span class="line">git â¤ git init repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºè£¸ä»“åº“</span></span><br><span class="line">git â¤  git init --bare repo.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ†åˆ« <span class="built_in">clone</span> ä¸¤ä¸ªä»“åº“</span></span><br><span class="line">git â¤ git clone repo test1</span><br><span class="line">æ­£å…‹éš†åˆ° 'test1'...</span><br><span class="line">warning: æ‚¨ä¼¼ä¹å…‹éš†äº†ä¸€ä¸ªç©ºç‰ˆæœ¬åº“ã€‚</span><br><span class="line">å®Œæˆã€‚</span><br><span class="line">git â¤ git clone repo.git test2</span><br><span class="line">æ­£å…‹éš†åˆ° 'test2'...</span><br><span class="line">warning: æ‚¨ä¼¼ä¹å…‹éš†äº†ä¸€ä¸ªç©ºç‰ˆæœ¬åº“ã€‚</span><br><span class="line">å®Œæˆã€‚</span><br><span class="line">git â¤</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ test1 ä»“åº“</span></span><br><span class="line">git â¤ cd test1</span><br><span class="line">test1 â¤ touch test                                                                                                                                                                                   git:master</span><br><span class="line">test1 â¤ git add .                                                                                                                                                                                   git:master*</span><br><span class="line">test1 â¤ git commit -m 'æµ‹è¯•æäº¤'                                                                                                                                                                    git:master*</span><br><span class="line">[masterï¼ˆæ ¹æäº¤ï¼‰ 456cf23] æµ‹è¯•æäº¤</span><br><span class="line"> 1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 test</span><br><span class="line">test1 â¤ git push origin master                                                                                                                                                                       git:master</span><br><span class="line">Counting objects: 3, done.</span><br><span class="line">Writing objects: 100% (3/3), 217 bytes | 0 bytes/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">remote: error: refusing to update checked out branch: refs/heads/master</span><br><span class="line">remote: error: By default, updating the current branch in a non-bare repository</span><br><span class="line">remote: error: is denied, because it will make the index and work tree inconsistent</span><br><span class="line">remote: error: with what you pushed, and will require 'git reset --hard' to match</span><br><span class="line">remote: error: the work tree to HEAD.</span><br><span class="line">remote: error:</span><br><span class="line">remote: error: You can set 'receive.denyCurrentBranch' configuration variable to</span><br><span class="line">remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into</span><br><span class="line">remote: error: its current branch; however, this is not recommended unless you</span><br><span class="line">remote: error: arranged to update its work tree to match what you pushed in some</span><br><span class="line">remote: error: other way.</span><br><span class="line">remote: error:</span><br><span class="line">remote: error: To squelch this message and still keep the default behaviour, set</span><br><span class="line">remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.</span><br><span class="line">To /home/git/repo</span><br><span class="line"> ! [remote rejected] master -&gt; master (branch is currently checked out)</span><br><span class="line">error: æ— æ³•æ¨é€ä¸€äº›å¼•ç”¨åˆ° '/home/git/repo'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ test2 ä»“åº“é‡å¤æ‰§è¡Œ</span></span><br><span class="line">test1 â¤ cd ../test2                                                                                                                                                                                  git:master</span><br><span class="line">test2 â¤ touch test                                                                                                                                                                                   git:master</span><br><span class="line">test2 â¤ git add .                                                                                                                                                                                   git:master*</span><br><span class="line">test2 â¤ git commit -m 'å†æ¬¡æµ‹è¯•æäº¤'                                                                                                                                                                git:master*</span><br><span class="line">[masterï¼ˆæ ¹æäº¤ï¼‰ c56efe8] å†æ¬¡æµ‹è¯•æäº¤</span><br><span class="line"> 1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 test</span><br><span class="line">test2 â¤ git push origin master                                                                                                                                                                       git:master</span><br><span class="line">Counting objects: 3, done.</span><br><span class="line">Writing objects: 100% (3/3), 223 bytes | 0 bytes/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To /home/git/repo.git</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">test2 â¤</span><br></pre></td></tr></table></figure><p></p><p>ä»è£¸ä»“åº“ä¸­<code>clone</code>ä¸‹æ¥çš„æœ¬åœ°ä»“åº“å¯ä»¥æ­£å¸¸çš„<code>push</code>æ“ä½œï¼Œè¿™ä¹Ÿæ­£æ˜¯è£¸ä»“åº“çš„å­˜åœ¨æ„ä¹‰</p><p>åŸæ–‡é“¾æ¥ï¼š<br><a href="https://moelove.info/2016/12/04/Git-%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E5%92%8C%E8%A3%B8%E4%BB%93%E5%BA%93/" title="Git æœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“" target="_blank" rel="noopener">Git æœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;git-åˆå§‹åŒ–&quot;&gt;&lt;a href=&quot;#git-åˆå§‹åŒ–&quot; class=&quot;headerlink&quot; title=&quot;git åˆå§‹åŒ–&quot;&gt;&lt;/a&gt;git åˆå§‹åŒ–&lt;/h4&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git init #gitç›®å½•åˆå§‹åŒ–&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init &amp;lt;repo&amp;gt; #æœ¬åœ°åˆå§‹åŒ–ï¼Œå¹¶ä¸”å»ºç«‹ä¸€ä¸ªåä¸ºrepoçš„ç©ºä»“åº“&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init --bare #gitè£¸ä»“åº“åˆå§‹åŒ–&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init --bare &amp;lt;repo&amp;gt; #æŒ‡å®šæŸä¸ªç›®å½•æˆä¸ºä¸­å¿ƒä»“åº“ï¼ˆè£¸ä»“åº“ï¼‰&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;code&gt;git init&lt;/code&gt;è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª .git çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥è¿½è¸ªä»“åº“çš„æ‰€æœ‰å˜æ›´ã€‚&lt;br&gt;&lt;code&gt;--bare&lt;/code&gt;: ä½¿ç”¨ â€“bare å‚æ•°åˆå§‹åŒ–çš„ä»“åº“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºè£¸ä»“åº“ï¼Œ å› ä¸ºè¿™æ ·åˆ›å»ºçš„ä»“åº“å¹¶ä¸åŒ…å« å·¥ä½œåŒº ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„ Git å‘½ä»¤ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>git åˆå¹¶æ“ä½œ</title>
    <link href="https://hexo.lilis.xin/posts/150d1834/"/>
    <id>https://hexo.lilis.xin/posts/150d1834/</id>
    <published>2019-09-11T07:36:04.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<h3 id="git-åˆå¹¶æ“ä½œ"><a href="#git-åˆå¹¶æ“ä½œ" class="headerlink" title="git åˆå¹¶æ“ä½œ"></a>git åˆå¹¶æ“ä½œ</h3><p>é€šè¿‡<code>git log</code>æŸ¥çœ‹æäº¤è®°å½•åŠå…¶commitId<br>å†é€šè¿‡<code>git reset --soft commitId</code>æ¥å›é€€ç‰ˆæœ¬(â€“soft å’Œ â€“hardçš„åŒºåˆ«å°±æ˜¯ â€“softæ˜¯è½¯å›é€€ï¼Œä¼šå°†ä½ è¿™æ¬¡commitIdä¹‹åçš„æäº¤å…¨éƒ¨å›é€€åˆ°æš‚å­˜åŒºä¸­ï¼Œâ€“hardä¼šå°†ä½ <br>è¿™æ¬¡commitIdä¹‹åçš„æäº¤å…¨éƒ¨æ¸…é™¤æ‰)<br>æ­¤æ—¶ä½ è¿™æ¬¡commitIdä¹‹åçš„æäº¤éƒ½ä¼šå›åˆ°æš‚å­˜åŒºä¸­<br>git commit -m éšä¾¿å†™æ³¨é‡Š</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;git-åˆå¹¶æ“ä½œ&quot;&gt;&lt;a href=&quot;#git-åˆå¹¶æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;git åˆå¹¶æ“ä½œ&quot;&gt;&lt;/a&gt;git åˆå¹¶æ“ä½œ&lt;/h3&gt;&lt;p&gt;é€šè¿‡&lt;code&gt;git log&lt;/code&gt;æŸ¥çœ‹æäº¤è®°å½•åŠå…¶commitId&lt;br&gt;å†é€šè¿‡&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>åŸºäºRedisçš„GeoHashåœ¨PHPä¸Šçš„åº”ç”¨</title>
    <link href="https://hexo.lilis.xin/posts/3dd74411/"/>
    <id>https://hexo.lilis.xin/posts/3dd74411/</id>
    <published>2018-11-29T07:26:08.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>GeoHashæœ‰ç€ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹</p><ol><li>GeoHashç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºç»åº¦å’Œçº¬åº¦ä¸¤ä¸ªåæ ‡,ä¾¿äºåŠ ä¸Šç´¢å¼•.</li><li>GeoHashè¡¨ç¤ºçš„å¹¶ä¸æ˜¯ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸ.</li><li>ç¼–ç çš„å‰ç¼€å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„åŒºåŸŸ, å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡ŒåŒºåŸŸæ£€ç´¢, èšåˆç­‰ç›¸å…³æ“ä½œ.</li></ol><p>ç»¼ä¸Šæ‰€è¿°, GeoHashæ¯”ç›´æ¥ç”¨ç»çº¬åº¦çš„é«˜æ•ˆå¾ˆå¤š.</p><a id="more"></a><h3 id="GeoHashç®—æ³•"><a href="#GeoHashç®—æ³•" class="headerlink" title="GeoHashç®—æ³•"></a>GeoHashç®—æ³•</h3><p>ç¼–ç </p><ul><li>GeoHashé¦–å…ˆå°†ç²¾åº¦èŒƒå›´è®¾å®šä¸ºåˆ’åˆ†æˆä¸¤ä¸ªåŒºé—´(-180, 0), (0, 180), å¦‚æœç»åº¦åæ ‡è½åˆ°äº†å‰ä¸€ä¸ªåŒºé—´åˆ™æ ‡è®°ä¸º0, åä¹‹åˆ™æ ‡è®°ä¸º1.</li><li>ç„¶åå†å°†ä¸Šä¸€æ­¥è·å¾—åˆ°çš„åŒºé—´åˆ’åˆ†æˆä¸¤ä¸ªåŒºé—´, é‡å¤ä¸Šä¸€æ­¥.</li><li>é‡å¤å‰å‰ä¸¤æ­¥ç›´åˆ°å¾—åˆ°è‡ªå·±æ‰€éœ€è¦çš„ç²¾åº¦</li><li><p>ä»¥æ­¤ç±»æ¨æ¥å¾—åˆ°çº¬åº¦çš„HashBin (å…³äºçº¬åº¦çš„åˆå§‹åˆ’åˆ†åŒºé—´, ä¸€èˆ¬çš„å…±ç”¨ç®—æ³•é‡Œéƒ½æ˜¯Â±90, è€Œredisé‡Œç”¨çš„å´æ˜¯Â±85.05112878)<br>å¦‚ (23.17015353059966287, 113.46623629331588745) é€šè¿‡åŒºé—´åˆ’åˆ†å¯ä»¥å¾—åˆ°:<br>(1101000010101111111001011110, 101000101101111011011100011)</p></li><li><p>æ¥ä¸‹æ¥æ˜¯å¯¹åˆ’åˆ†ç»“æœçš„åˆå¹¶, æŒ‰ç…§<code>å¥‡æ•°ä½æ˜¯çº¬åº¦, å¶æ•°ä½ä¸ºç»åº¦</code>çš„åŸåˆ™æ¥è¿›è¡Œåˆå¹¶.<br>ä¸Šé¢çš„ä¾‹å­åˆå¹¶å¯å¾—:<br>1110011000000100110110011111111011111001011100101011110</p></li><li>ä¹‹åå†æŒ‰ç…§éæ ‡å‡†çš„base32ç®—æ³•è¿›è¡Œå­—ç¬¦ä¸²çš„è½¬åŒ–, ä¸‹é¢æ˜¯å¯¹ç…§è¡¨æ ¼</li></ul><table><thead><tr><th>åè¿›åˆ¶</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td>äºŒè¿›åˆ¶</td><td>00000</td><td>00001</td><td>00010</td><td>00011</td><td>00100</td><td>00101</td><td>00110</td><td>00111</td><td>01000</td><td>01001</td><td>01010</td><td>01011</td><td>01100</td><td>01101</td><td>01110</td><td>01111</td></tr><tr><td>base32</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td></tr><tr><td>åè¿›åˆ¶</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td></tr><tr><td>äºŒè¿›åˆ¶</td><td>10000</td><td>10001</td><td>10010</td><td>10011</td><td>10100</td><td>10101</td><td>10110</td><td>10111</td><td>11000</td><td>11001</td><td>11010</td><td>11011</td><td>11100</td><td>11101</td><td>11110</td><td>11111</td></tr><tr><td>base32</td><td>h</td><td>j</td><td>k</td><td>m</td><td>n</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>u</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td></tr></tbody></table><p>æœ€ç»ˆ(23.17015353059966287, 113.46623629331588745)è¢«è½¬åŒ–æˆâ€™ws2emzrtfbyâ€™.</p><p>è§£ç åˆ™å’Œç¼–ç æ­£å¥½ç›¸åå³å¯.</p><h3 id="PHPçš„å®ç°"><a href="#PHPçš„å®ç°" class="headerlink" title="PHPçš„å®ç°"></a>PHPçš„å®ç°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geohash</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $coding    = <span class="string">'0123456789bcdefghjkmnpqrstuvwxyz'</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $codingMap = [</span><br><span class="line">        <span class="string">'0'</span> =&gt; <span class="string">'00000'</span>, <span class="string">'1'</span> =&gt; <span class="string">'00001'</span>, <span class="string">'2'</span> =&gt; <span class="string">'00010'</span>,</span><br><span class="line">        <span class="string">'3'</span> =&gt; <span class="string">'00011'</span>, <span class="string">'4'</span> =&gt; <span class="string">'00100'</span>, <span class="string">'5'</span> =&gt; <span class="string">'00101'</span>,</span><br><span class="line">        <span class="string">'6'</span> =&gt; <span class="string">'00110'</span>, <span class="string">'7'</span> =&gt; <span class="string">'00111'</span>, <span class="string">'8'</span> =&gt; <span class="string">'01000'</span>,</span><br><span class="line">        <span class="string">'9'</span> =&gt; <span class="string">'01001'</span>, <span class="string">'b'</span> =&gt; <span class="string">'01010'</span>, <span class="string">'c'</span> =&gt; <span class="string">'01011'</span>,</span><br><span class="line">        <span class="string">'d'</span> =&gt; <span class="string">'01100'</span>, <span class="string">'e'</span> =&gt; <span class="string">'01101'</span>, <span class="string">'f'</span> =&gt; <span class="string">'01110'</span>,</span><br><span class="line">        <span class="string">'g'</span> =&gt; <span class="string">'01111'</span>, <span class="string">'h'</span> =&gt; <span class="string">'10000'</span>, <span class="string">'j'</span> =&gt; <span class="string">'10001'</span>,</span><br><span class="line">        <span class="string">'k'</span> =&gt; <span class="string">'10010'</span>, <span class="string">'m'</span> =&gt; <span class="string">'10011'</span>, <span class="string">'n'</span> =&gt; <span class="string">'10100'</span>,</span><br><span class="line">        <span class="string">'p'</span> =&gt; <span class="string">'10101'</span>, <span class="string">'q'</span> =&gt; <span class="string">'10110'</span>, <span class="string">'r'</span> =&gt; <span class="string">'10111'</span>,</span><br><span class="line">        <span class="string">'s'</span> =&gt; <span class="string">'11000'</span>, <span class="string">'t'</span> =&gt; <span class="string">'11001'</span>, <span class="string">'u'</span> =&gt; <span class="string">'11010'</span>,</span><br><span class="line">        <span class="string">'v'</span> =&gt; <span class="string">'11011'</span>, <span class="string">'w'</span> =&gt; <span class="string">'11100'</span>, <span class="string">'x'</span> =&gt; <span class="string">'11101'</span>,</span><br><span class="line">        <span class="string">'y'</span> =&gt; <span class="string">'11110'</span>, <span class="string">'z'</span> =&gt; <span class="string">'11111'</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">decode</span><span class="params">(string $hash, $number = false)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($number) &#123;</span><br><span class="line">            $binary = base_convert($hash, <span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $binary = <span class="string">''</span>;</span><br><span class="line">            $hl     = strlen($hash);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;$hl; $i++) &#123;</span><br><span class="line">                $binary .= <span class="keyword">self</span>::$codingMap[substr($hash,$i,<span class="number">1</span>)];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $bl    = strlen($binary);</span><br><span class="line">        $blat  = <span class="string">''</span>;</span><br><span class="line">        $blong = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–å‡ºç»çº¬åº¦</span></span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;$bl; $i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ($i%<span class="number">2</span>)</span><br><span class="line">                $blat  = $blat.substr($binary,$i,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                $blong = $blong.substr($binary,$i,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¿»è¯‘ç»çº¬åº¦</span></span><br><span class="line">        <span class="keyword">list</span>(</span><br><span class="line">            $lat,</span><br><span class="line">            $latErr</span><br><span class="line">            ) = <span class="keyword">self</span>::binDecode($blat,<span class="number">-85.05112878</span>,<span class="number">85.05112878</span>);</span><br><span class="line">        <span class="keyword">list</span>(</span><br><span class="line">            $long,</span><br><span class="line">            $longErr</span><br><span class="line">            ) = <span class="keyword">self</span>::binDecode($blong,<span class="number">-180</span>,<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç²¾åº¦å¤„ç†</span></span><br><span class="line">        $latPlaces  = max(<span class="number">1</span>, -round(log10($latErr))) - <span class="number">1</span>;</span><br><span class="line">        $longPlaces = max(<span class="number">1</span>, -round(log10($longErr))) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        $lat        = round($lat, $latPlaces);</span><br><span class="line">        $long       = round($long, $longPlaces);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$lat, $long];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">hash2num</span><span class="params">(string $hash, $bin = false)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        $binary = <span class="string">''</span>;</span><br><span class="line">        $hl     = strlen($hash);</span><br><span class="line">        <span class="keyword">for</span>($i=<span class="number">0</span>; $i&lt;$hl; $i++)</span><br><span class="line">        &#123;</span><br><span class="line">            $binary .= <span class="keyword">self</span>::$codingMap[substr($hash,$i,<span class="number">1</span>)];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($bin)</span><br><span class="line">            <span class="keyword">return</span> $binary;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> base_convert(substr($binary, <span class="number">0</span>, <span class="number">52</span>), <span class="number">2</span>, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åæ ‡è½¬åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $lat</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $long</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">encode</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        $lat, $long,</span></span></span><br><span class="line"><span class="function"><span class="params">        bool $number = false</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> :<span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è®¡ç®—latç²¾åº¦</span></span><br><span class="line">        $latbits = <span class="number">1</span>;</span><br><span class="line">        $err     = <span class="number">45</span>;</span><br><span class="line">        $plat    = <span class="keyword">self</span>::precision($lat);</span><br><span class="line">        <span class="comment">//è®¡ç®—è®¡ç®—æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">while</span>($err &gt; $plat)</span><br><span class="line">        &#123;</span><br><span class="line">            $err     /= <span class="number">2</span>;</span><br><span class="line">            $latbits ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $longbits = <span class="number">1</span>;</span><br><span class="line">        $err      = <span class="number">90</span>;</span><br><span class="line">        $plong    = <span class="keyword">self</span>::precision($long);</span><br><span class="line">        <span class="keyword">while</span>($err &gt; $plong)</span><br><span class="line">        &#123;</span><br><span class="line">            $err      /= <span class="number">2</span>;</span><br><span class="line">            $longbits ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $bits     = max($latbits, $longbits);</span><br><span class="line"></span><br><span class="line">        $longbits = $bits;</span><br><span class="line">        $latbits  = $bits;</span><br><span class="line">        $addlong  = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸ºäº†å¯ä»¥è¿›è¡Œåˆå¹¶å¡«å……æ•°ä½ 2^5 = 32</span></span><br><span class="line">        <span class="keyword">while</span> (($longbits+$latbits)%<span class="number">5</span> != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $longbits += $addlong;</span><br><span class="line">            $latbits  += !$addlong;</span><br><span class="line">            $addlong  = !$addlong;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $blat     = <span class="keyword">self</span>::binEncode($lat,<span class="number">90</span>, <span class="number">90</span>, $latbits);</span><br><span class="line">        $blong    = <span class="keyword">self</span>::binEncode($long, <span class="number">-180</span>, <span class="number">180</span>, $longbits);</span><br><span class="line"></span><br><span class="line">        $binary  = <span class="string">''</span>;</span><br><span class="line">        $uselong = <span class="number">1</span>;</span><br><span class="line">        $strlen  = strlen($blat) + strlen($blong);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆå¹¶ä½æ•°</span></span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i&lt;$strlen; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($uselong)</span><br><span class="line">            &#123;</span><br><span class="line">                $binary .= substr($blong,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                $blong  = substr($blong,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                $binary .= substr($blat,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                $blat   = substr($blat,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $uselong = !$uselong;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($number)</span><br><span class="line">            <span class="keyword">return</span> bindec(substr($binary, <span class="number">0</span>, <span class="number">52</span>));</span><br><span class="line"></span><br><span class="line">        $hash = <span class="string">''</span>;</span><br><span class="line">        $leng = strlen($binary);</span><br><span class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;$leng; $i+=<span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $n    = bindec(substr($binary,$i,<span class="number">5</span>));</span><br><span class="line">            $hash = $hash. <span class="keyword">self</span>::$coding[$n];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $hash;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¡ç®—ç²¾åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> float $number</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> float|int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">precision</span><span class="params">(float $number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $precision = <span class="number">0</span>;</span><br><span class="line">        $pt        = strpos($number,<span class="string">'.'</span>);</span><br><span class="line">        <span class="keyword">if</span> ($pt !== <span class="keyword">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $precision = - (strlen($number) - $pt - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pow(<span class="number">10</span>, $precision) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">binEncode</span><span class="params">($number, $min, $max, $bitcount)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($bitcount == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">        $mid = bcdiv(bcadd($min, $max, <span class="number">52</span>), <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">        <span class="keyword">if</span> (bccomp($number, $mid, <span class="number">52</span>) == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'1'</span>. <span class="keyword">self</span>::binEncode(</span><br><span class="line">                $number, $mid,</span><br><span class="line">                $max,$bitcount<span class="number">-1</span></span><br><span class="line">            );</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">'0'</span>. <span class="keyword">self</span>::binEncode(</span><br><span class="line">                $number, $min,</span><br><span class="line">                $mid,$bitcount<span class="number">-1</span></span><br><span class="line">            );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">binDecode</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        $binary, $min,</span></span></span><br><span class="line"><span class="function"><span class="params">        $max</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>&#123;</span><br><span class="line">        $binlen = strlen($binary);</span><br><span class="line">        $err    = bcsub($max, $min, <span class="number">52</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $binlen; $i++) &#123;</span><br><span class="line">            $bit = substr($binary,$i,<span class="number">1</span>);</span><br><span class="line">            $mid = bcdiv(bcadd($min, $max, <span class="number">52</span>), <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">            $err = bcdiv($err, <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">            <span class="keyword">if</span> ($bit == <span class="number">1</span>) &#123;</span><br><span class="line">                $min = $mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $max = $mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [$mid, $err];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Redisä¸Šçš„åº”ç”¨"><a href="#Redisä¸Šçš„åº”ç”¨" class="headerlink" title="Redisä¸Šçš„åº”ç”¨"></a>Redisä¸Šçš„åº”ç”¨</h3><p>Redisçš„GEOç‰¹æ€§åœ¨<code>Redis 3.2</code>ç‰ˆæœ¬é‡Šå‡º,è¿™ä¸ªåŠŸèƒ½å¯ä»¥å°†ç”¨æˆ·ç»™å®šçš„åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥,å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œ.</p><p><code>GEOADD</code><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOADD key longitude latitude name [longitude latitude name ...]</span><br></pre></td></tr></table></figure><p></p><p>GEOADD å‘½ä»¤æ¯æ¬¡å¯ä»¥æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªç»çº¬åº¦åœ°ç†ä½ç½®ã€‚ å…¶ä¸­<code>key</code>ä¸ºå‚¨å­˜åœ°ç†ä½ç½®çš„é›†åˆï¼Œ è€Œ <code>longitude</code> ã€ <code>latitude</code> å’Œ <code>name</code> åˆ™åˆ†åˆ«ä¸ºåœ°ç†ä½ç½®çš„ç»åº¦ã€çº¬åº¦ã€åå­—.<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEOADD geo_test 113.46623629331588745 23.17015353059966287 test_1 113.46620947122573853 23.17010790561879929 test_2</span><br></pre></td></tr></table></figure><p></p><p><code>GEOPOS</code><br><code>GEOPOS</code> å‘½ä»¤å¯ä»¥è·å–Geoçš„åæ ‡<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOPOS key name [name ...]</span><br></pre></td></tr></table></figure><p></p><p>å¦‚:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geopos geo_test test_2</span><br><span class="line">1) 1) &quot;113.46620947122573853&quot;</span><br><span class="line">   2) &quot;23.17010790561879929&quot;</span><br></pre></td></tr></table></figure><p></p><p><code>GEODIST</code><br>è®¡ç®—ä¸¤ä¸ªåæ ‡ç‚¹ä¹‹é—´çš„è·ç¦»<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEODIST key location-x location-y [unit]</span><br></pre></td></tr></table></figure><p></p><p>å…¶ä¸­<code>unit</code>è¡¨ç¤ºå•ä½ é»˜è®¤ä¸º <code>m</code></p><ul><li><code>m</code> è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li><li><code>km</code> è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li><li><code>mi</code> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li><li><code>ft</code> è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li></ul><p><code>GEORADIUS</code> å’Œ <code>GEORADIUSBYMEMBER</code><br>è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½æ˜¯è·å–ä¸€å®šèŒƒå›´å†…çš„åæ ‡<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GEORADIUS key longitude latitude radius m|km|ft|mi[WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC] [STORE key] [STOREDIST key]</span><br><span class="line">GEORADIUSBYMEMBER key location radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC] [STORE key] [STOREDIST key]</span><br></pre></td></tr></table></figure><p></p><ul><li><code>WITHCOORD</code> åœ¨è¿”å›åŒ¹é…çš„ä½ç½®æ—¶ä¼šå°†ä½ç½®çš„ç»çº¬åº¦ä¸€å¹¶è¿”å›.</li><li><code>WITHDIST</code> æŒ‡å®šä¸­å¿ƒè¿”å›é¡¹ç›®çš„è·ç¦», è·ç¦»ä»¥ä¸æŒ‡å®šä¸ºå‘½ä»¤çš„radiuså‚æ•°çš„å•ä½ç›¸åŒçš„å•ä½è¿”å›.</li><li><code>WITHHASH</code> è¿˜ä»¥52ä½æ— ç¬¦å·æ•´æ•°çš„å½¢å¼è¿”å›é¡¹çš„åŸå§‹geohashç¼–ç çš„æœ‰åºé›†åˆ†æ•°</li><li><code>ASC|DESC</code> <code>ASC</code> å¯ä»¥è®©æŸ¥æ‰¾ç»“æœæ ¹æ®è·ç¦»ä»è¿‘åˆ°è¿œæ’åºï¼Œ è€Œ <code>DESC</code> åˆ™å¯ä»¥è®©æŸ¥æ‰¾ç»“æœæ ¹æ®ä»è¿œåˆ°è¿‘æ’åº</li><li><code>COUNT</code> æŒ‡å®šè¦è¿”å›çš„ç»“æœæ•°é‡</li><li><code>STORE key</code> ç»“æœå­˜åˆ°æ–°çš„æœ‰åºé›†åˆä¸­, ä»¥<code>GeoHash</code>å€¼åš<code>score</code>, è¯¥é€‰é¡¹ä¸<code>WITH[DIST|COORD|HASH]</code>é€‰é¡¹å†²çª</li><li><code>STOREDIST key</code> ç»“æœå­˜åˆ°æ–°çš„æœ‰åºé›†åˆä¸­, ä»¥ä¸æŒ‡å®šä½ç½®çš„è·ç¦»ä½œ<code>score</code>, è¯¥é€‰é¡¹ä¸<code>WITH[DIST|COORD|HASH]</code>é€‰é¡¹å†²çª<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; georadius key 113.46620947122573853 23.17010790561879929 100 km WITHCOORD WITHDIST</span><br><span class="line">1) 1) &quot;test_2&quot;</span><br><span class="line">   2) &quot;0.0000&quot;</span><br><span class="line">   3) 1) &quot;113.46620947122573853&quot;</span><br><span class="line">      2) &quot;23.17010790561879929&quot;</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure></li></ul><p><code>GEOHASH</code><br>å°†redisé‡Œçš„<code>Geo</code>è½¬åŒ–ä¸ºæ ‡å‡†çš„<code>GeoHash</code>è¾“å‡º<br>æ³¨æ„:è¿™é‡Œè¾“å‡ºçš„æ˜¯æ ‡å‡†çš„<code>GeoHash</code>, ä¸æ˜¯redisé‡Œé¢å­˜å‚¨çš„<code>HashInt</code>è½¬åŒ–å‡ºæ¥çš„<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOHASH key member [member ...]</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geohash geo_test test_1 test_2</span><br><span class="line">1) &quot;7pkg3sdkv40&quot;</span><br><span class="line">2) &quot;ws0evczxdm0&quot;</span><br></pre></td></tr></table></figure><h4 id="å­˜å‚¨åŸç†"><a href="#å­˜å‚¨åŸç†" class="headerlink" title="å­˜å‚¨åŸç†"></a>å­˜å‚¨åŸç†</h4><p><code>Redis</code>é‡Œçš„<code>Geo</code>åæ ‡åœ¨å®é™…å­˜å‚¨æ—¶æ˜¯å°†<code>gps</code>åæ ‡åˆ†åˆ«æŒ‰ç…§(-180, 180)å’Œ(-85.05112878, 85.05112878)æ¥åˆ’åˆ†è®¡ç®—æˆ<code>HashInt</code>ä½œä¸º<code>zseté›†åˆ</code>è¿›è¡Œå­˜å‚¨çš„.<br>æ‰€ä»¥<code>Redis</code>çš„<code>Geo</code>æ“ä½œä¸­å¹¶æ²¡æœ‰åˆ é™¤å‘½ä»¤, å¯ä»¥ç›´æ¥ä½¿ç”¨<code>zrem</code>å‘½ä»¤å»åˆ é™¤<code>Geo</code>åæ ‡.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;GeoHashæœ‰ç€ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹&lt;/p&gt;&lt;ol&gt;&lt;li&gt;GeoHashç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºç»åº¦å’Œçº¬åº¦ä¸¤ä¸ªåæ ‡,ä¾¿äºåŠ ä¸Šç´¢å¼•.&lt;/li&gt;&lt;li&gt;GeoHashè¡¨ç¤ºçš„å¹¶ä¸æ˜¯ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸ.&lt;/li&gt;&lt;li&gt;ç¼–ç çš„å‰ç¼€å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„åŒºåŸŸ, å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡ŒåŒºåŸŸæ£€ç´¢, èšåˆç­‰ç›¸å…³æ“ä½œ.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;ç»¼ä¸Šæ‰€è¿°, GeoHashæ¯”ç›´æ¥ç”¨ç»çº¬åº¦çš„é«˜æ•ˆå¾ˆå¤š.&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="redis" scheme="https://hexo.lilis.xin/tags/redis/"/>
    
      <category term="GeoHash" scheme="https://hexo.lilis.xin/tags/GeoHash/"/>
    
      <category term="GPS" scheme="https://hexo.lilis.xin/tags/GPS/"/>
    
  </entry>
  
  <entry>
    <title>nginxæœåŠ¡è„šæœ¬</title>
    <link href="https://hexo.lilis.xin/posts/5bc4c6e7/"/>
    <id>https://hexo.lilis.xin/posts/5bc4c6e7/</id>
    <published>2018-11-14T04:49:30.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>nginxæœåŠ¡è„šæœ¬</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nginx - this script starts and stops the nginx daemin</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> chkconfig:   - 85 15 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</span></span><br><span class="line"><span class="meta">#</span><span class="bash">               proxy and IMAP/POP3 proxy server</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> processname: nginx</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> config:      /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pidfile:     /usr/<span class="built_in">local</span>/nginx/logs/nginx.pid</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Source <span class="keyword">function</span> library.</span></span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Source networking configuration.</span></span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Check that networking is up.</span></span><br><span class="line">[ "$NETWORKING" = "no" ] &amp;&amp; exit 0</span><br><span class="line"></span><br><span class="line">nginx="/usr/local/sbin/nginx"</span><br><span class="line">prog=$(basename $nginx)</span><br><span class="line"></span><br><span class="line">NGINX_CONF_FILE="/usr/local/nginx/conf/nginx.conf"</span><br><span class="line"></span><br><span class="line">lockfile=/var/lock/subsys/nginx</span><br><span class="line"></span><br><span class="line">start() &#123;</span><br><span class="line">    [ -x $nginx ] || exit 5</span><br><span class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</span><br><span class="line">    echo -n $"Starting $prog: "</span><br><span class="line">    daemon $nginx -c $NGINX_CONF_FILE</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop() &#123;</span><br><span class="line">    echo -n $"Stopping $prog: "</span><br><span class="line">    killproc $prog -QUIT</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">restart() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reload() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    echo -n $"Reloading $prog: "</span><br><span class="line">    killproc $nginx -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    echo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">force_reload() &#123;</span><br><span class="line">    restart</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configtest() &#123;</span><br><span class="line"><span class="meta">  $</span><span class="bash">nginx -t -c <span class="variable">$NGINX_CONF_FILE</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status() &#123;</span><br><span class="line">    status $prog</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status_q() &#123;</span><br><span class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case "$1" in</span><br><span class="line">    start)</span><br><span class="line">        rh_status_q &amp;&amp; exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    restart|configtest)</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    reload)</span><br><span class="line">        rh_status_q || exit 7</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    force-reload)</span><br><span class="line">        force_reload</span><br><span class="line">        ;;</span><br><span class="line">    status)</span><br><span class="line">        rh_status</span><br><span class="line">        ;;</span><br><span class="line">    condrestart|try-restart)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">            ;;</span><br><span class="line">    *)</span><br><span class="line">        echo $"Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;"</span><br><span class="line">        exit 2</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;nginxæœåŠ¡è„šæœ¬&lt;/p&gt;
    
    </summary>
    
    
      <category term="nginx" scheme="https://hexo.lilis.xin/tags/nginx/"/>
    
      <category term="server" scheme="https://hexo.lilis.xin/tags/server/"/>
    
  </entry>
  
  <entry>
    <title>PHPåŠ¨æ€giféªŒè¯ç </title>
    <link href="https://hexo.lilis.xin/posts/491b8778/"/>
    <id>https://hexo.lilis.xin/posts/491b8778/</id>
    <published>2018-11-08T04:02:23.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ„Ÿè§‰è‡ªå·±çš„é¡¹ç›®ä¸Šçš„éªŒè¯ç å¤ªlowäº†,å†³å®šæ¢ä¸€ä¸ªæœ‰æ„æ€çš„åŠ¨æ€giféªŒè¯ç <br><a id="more"></a><br>æ•ˆæœ<br><img src="https://blog.lilis.xin/wp-admin/Captcha.php" alt="Captcha" title="Captcha"><br>åºŸè¯ä¸å¤šè¯´,ç›´æ¥ä¸Šæºç </p><h4 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h4><p>ä¸»å‡½æ•°:<br><a href="https://blog.lilis.xin/wp-admin/fonts/comic.ttf" title="comic.ttf" target="_blank" rel="noopener">comic.ttf</a><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ImageCode</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        $string=<span class="string">''</span>, $frames = <span class="number">60</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        $time = <span class="number">1</span>,$width=<span class="number">75</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        $height=<span class="number">25</span>, $font = <span class="number">6</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        $loops = <span class="number">0</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>&#123;</span><br><span class="line">        $authstr = $string?:((time()%<span class="number">2</span>==<span class="number">0</span>)?mt_rand(<span class="number">1000</span>,<span class="number">9999</span>):mt_rand(<span class="number">10000</span>,<span class="number">99999</span>));</span><br><span class="line">        $authlen = strlen($authstr);</span><br><span class="line">        $board_width=$width;</span><br><span class="line">        $board_height=$height;</span><br><span class="line">        $delay = $time*<span class="number">100</span>/$frames;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆä¸€ä¸ªnå¸§çš„GIFåŠ¨ç”»</span></span><br><span class="line">        <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;$frames;$i++)&#123;</span><br><span class="line">            ob_start();</span><br><span class="line">            $image=imagecreate($board_width,$board_height);</span><br><span class="line">            imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¾å®šæ–‡å­—é¢œè‰²æ•°ç»„</span></span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">15</span>,<span class="number">73</span>,<span class="number">210</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">64</span>,<span class="number">0</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">64</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">128</span>,<span class="number">128</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">27</span>,<span class="number">52</span>,<span class="number">47</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">51</span>,<span class="number">0</span>,<span class="number">102</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">145</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">113</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">51</span>,<span class="number">51</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">158</span>,<span class="number">180</span>,<span class="number">35</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">59</span>,<span class="number">59</span>,<span class="number">59</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">1</span>,<span class="number">128</span>,<span class="number">180</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">153</span>,<span class="number">51</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">60</span>,<span class="number">131</span>,<span class="number">1</span>);</span><br><span class="line">            $colorList[]=imagecolorallocate($image,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            $gray=imagecolorallocate($image,<span class="number">245</span>,<span class="number">245</span>,<span class="number">245</span>);</span><br><span class="line">            imagefill($image,<span class="number">0</span>,<span class="number">0</span>,$gray);</span><br><span class="line">            $space=$font*<span class="number">0.65</span>;<span class="comment">// å­—ç¬¦é—´è·</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>($k=<span class="number">0</span>;$k&lt;$authlen;$k++)&#123;</span><br><span class="line">                $colorRandom=mt_rand(<span class="number">0</span>,sizeof($colorList)<span class="number">-1</span>);</span><br><span class="line">                $float_top=rand(<span class="number">0</span>,<span class="number">4</span>);</span><br><span class="line">                $float_left=rand(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">                imagettftext(</span><br><span class="line">                    $image, $font, <span class="number">0</span>,</span><br><span class="line">                    $space*$k+$float_left, $font+$float_top,</span><br><span class="line">                    $colorList[$colorRandom],</span><br><span class="line">                    <span class="string">'./fonts/comic.ttf'</span>,</span><br><span class="line">                    substr($authstr,$k,<span class="number">1</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>($k=<span class="number">0</span>;$k&lt;<span class="number">20</span>;$k++)&#123;</span><br><span class="line">                $colorRandom=mt_rand(<span class="number">0</span>,sizeof($colorList)<span class="number">-1</span>);</span><br><span class="line">                imagesetpixel($image,rand()%<span class="number">70</span>,rand()%<span class="number">15</span>,$colorList[$colorRandom]);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ·»åŠ å¹²æ‰°çº¿</span></span><br><span class="line">            <span class="keyword">for</span>($k=<span class="number">0</span>;$k&lt;<span class="number">3</span>;$k++)&#123;</span><br><span class="line">                $colorRandom=mt_rand(<span class="number">0</span>,sizeof($colorList)<span class="number">-1</span>);</span><br><span class="line">                $toDrawLine=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>($toDrawLine)&#123;</span><br><span class="line">                    imageline($image,mt_rand(<span class="number">0</span>,$board_width),mt_rand(<span class="number">0</span>,$board_height),mt_rand(<span class="number">0</span>,$board_width),mt_rand(<span class="number">0</span>,$board_height),$colorList[$colorRandom]);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    $w=mt_rand(<span class="number">0</span>,$board_width);</span><br><span class="line">                    $h=mt_rand(<span class="number">0</span>,$board_width);</span><br><span class="line">                    imagearc($image,$board_width-floor($w / <span class="number">2</span>),floor($h / <span class="number">2</span>),$w,$h, rand(<span class="number">90</span>,<span class="number">180</span>),rand(<span class="number">180</span>,<span class="number">270</span>),$colorList[$colorRandom]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            imagegif($image);</span><br><span class="line">            imagedestroy($image);</span><br><span class="line">            $imagedata[]=ob_get_contents();</span><br><span class="line">            $delays[] = $delay;</span><br><span class="line">            ob_clean();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnimatedGif($imagedata, $delays, $loops);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p></p><p>AnimatedGif:<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *AnimatedGifç±»</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnimatedGif</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The built gif image</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $image = <span class="string">''</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The array of images to stack</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $buffer = <span class="keyword">Array</span>();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * How many times to loop? 0 = infinite</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $number_of_loops = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $DIS = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Which colour is transparent</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $transparent_colour = <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Is this the first frame</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $first_frame = <span class="keyword">TRUE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encode an animated gif</span></span><br><span class="line"><span class="comment">     * AnimatedGif constructor.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $source_images</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $image_delays</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $number_of_loops</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        array $source_images,</span></span></span><br><span class="line"><span class="function"><span class="params">        array $image_delays,</span></span></span><br><span class="line"><span class="function"><span class="params">        $number_of_loops</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * I have no idea what these even do, they appear to do nothing to the image so far</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        $transparent_colour_red = <span class="number">0</span>;</span><br><span class="line">        $transparent_colour_green = <span class="number">0</span>;</span><br><span class="line">        $transparent_colour_blue = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;number_of_loops = ( $number_of_loops &gt; <span class="number">-1</span> ) ? $number_of_loops : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;set_transparent_colour($transparent_colour_red, $transparent_colour_green, $transparent_colour_blue);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;buffer_images($source_images);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;addHeader();</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count(<span class="keyword">$this</span>-&gt;buffer); $i++) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;addFrame($i, $image_delays [$i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set the transparent colour</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $red</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $green</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $blue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">set_transparent_colour</span><span class="params">($red, $green, $blue)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;transparent_colour = ( $red &gt; <span class="number">-1</span> &amp;&amp; $green &gt; <span class="number">-1</span> &amp;&amp; $blue &gt; <span class="number">-1</span> ) ?</span><br><span class="line">            ( $red | ( $green &lt;&lt; <span class="number">8</span> ) | ( $blue &lt;&lt; <span class="number">16</span> ) ) : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Buffer the images and check to make sure they are vaild</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $source_images</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buffer_images</span><span class="params">($source_images)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; count($source_images); $i++) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;buffer [] = $source_images [$i];</span><br><span class="line">            <span class="keyword">if</span> (substr(<span class="keyword">$this</span>-&gt;buffer [$i], <span class="number">0</span>, <span class="number">6</span>) != <span class="string">"GIF87a"</span> &amp;&amp; substr(<span class="keyword">$this</span>-&gt;buffer [$i], <span class="number">0</span>, <span class="number">6</span>) != <span class="string">"GIF89a"</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'Image at position '</span> . $i. <span class="string">' is not a gif'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> ($j = ( <span class="number">13</span> + <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [$i] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ) ), $k = <span class="keyword">TRUE</span>; $k; $j++) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;buffer [$i] &#123; $j &#125;) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"!"</span>:</span><br><span class="line">                        <span class="keyword">if</span> (( substr(<span class="keyword">$this</span>-&gt;buffer [$i], ( $j + <span class="number">3</span>), <span class="number">8</span>) ) == <span class="string">"NETSCAPE"</span>) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">'You cannot make an animation from an animated gif.'</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">";"</span>:</span><br><span class="line">                        $k = <span class="keyword">FALSE</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add the gif header to the image</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addHeader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $cmap = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;image = <span class="string">'GIF89a'</span>;</span><br><span class="line">        <span class="keyword">if</span> (ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span>) &#123;</span><br><span class="line">            $cmap = <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) );</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">6</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">13</span>, $cmap);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= <span class="string">"!\377\13NETSCAPE2.0\3\1"</span> . <span class="keyword">$this</span>-&gt;word(<span class="keyword">$this</span>-&gt;number_of_loops) . <span class="string">"\0"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add a frame to the animation</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $frame The frame to be added</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $delay The delay associated with the frame</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addFrame</span><span class="params">($frame, $delay)</span> </span>&#123;</span><br><span class="line">        $Locals_str = <span class="number">13</span> + <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) );</span><br><span class="line">        $Locals_end = strlen(<span class="keyword">$this</span>-&gt;buffer [$frame]) - $Locals_str - <span class="number">1</span>;</span><br><span class="line">        $Locals_tmp = substr(<span class="keyword">$this</span>-&gt;buffer [$frame], $Locals_str, $Locals_end);</span><br><span class="line">        $Global_len = <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">        $Locals_len = <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">        $Global_rgb = substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">13</span>, <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ));</span><br><span class="line">        $Locals_rgb = substr(<span class="keyword">$this</span>-&gt;buffer [$frame], <span class="number">13</span>, <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ));</span><br><span class="line">        $Locals_ext = <span class="string">"!\xF9\x04"</span> . chr(( <span class="keyword">$this</span>-&gt;DIS &lt;&lt; <span class="number">2</span> ) + <span class="number">0</span>) .</span><br><span class="line">            chr(( $delay &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span>) . chr(( $delay &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) . <span class="string">"\x0\x0"</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;transparent_colour &gt; <span class="number">-1</span> &amp;&amp; ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ); $j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                    ord($Locals_rgb &#123; <span class="number">3</span> * $j + <span class="number">0</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">16</span> ) &amp; <span class="number">0xFF</span> ) &amp;&amp;</span><br><span class="line">                    ord($Locals_rgb &#123; <span class="number">3</span> * $j + <span class="number">1</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span> ) &amp;&amp;</span><br><span class="line">                    ord($Locals_rgb &#123; <span class="number">3</span> * $j + <span class="number">2</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span> )</span><br><span class="line">                ) &#123;</span><br><span class="line">                    $Locals_ext = <span class="string">"!\xF9\x04"</span> . chr(( <span class="keyword">$this</span>-&gt;DIS &lt;&lt; <span class="number">2</span> ) + <span class="number">1</span>) .</span><br><span class="line">                        chr(( $delay &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span>) . chr(( $delay &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) . chr($j) . <span class="string">"\x0"</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> ($Locals_tmp &#123; <span class="number">0</span> &#125;) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"!"</span>:</span><br><span class="line">                $Locals_img = substr($Locals_tmp, <span class="number">8</span>, <span class="number">10</span>);</span><br><span class="line">                $Locals_tmp = substr($Locals_tmp, <span class="number">18</span>, strlen($Locals_tmp) - <span class="number">18</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">","</span>:</span><br><span class="line">                $Locals_img = substr($Locals_tmp, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">                $Locals_tmp = substr($Locals_tmp, <span class="number">10</span>, strlen($Locals_tmp) - <span class="number">10</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span> &amp;&amp; <span class="keyword">$this</span>-&gt;first_frame === <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($Global_len == $Locals_len) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;blockCompare($Global_rgb, $Locals_rgb, $Global_len)) &#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;image .= ( $Locals_ext . $Locals_img . $Locals_tmp );</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $byte = ord($Locals_img &#123; <span class="number">9</span> &#125;);</span><br><span class="line">                    $byte |= <span class="number">0x80</span>;</span><br><span class="line">                    $byte &amp;= <span class="number">0xF8</span>;</span><br><span class="line">                    $byte |= ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">                    $Locals_img &#123; <span class="number">9</span> &#125; = chr($byte);</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;image .= ( $Locals_ext . $Locals_img . $Locals_rgb . $Locals_tmp );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $byte = ord($Locals_img &#123; <span class="number">9</span> &#125;);</span><br><span class="line">                $byte |= <span class="number">0x80</span>;</span><br><span class="line">                $byte &amp;= <span class="number">0xF8</span>;</span><br><span class="line">                $byte |= ( ord(<span class="keyword">$this</span>-&gt;buffer [$frame] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">                $Locals_img &#123; <span class="number">9</span> &#125; = chr($byte);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;image .= ( $Locals_ext . $Locals_img . $Locals_rgb . $Locals_tmp );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= ( $Locals_ext . $Locals_img . $Locals_tmp );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;first_frame = <span class="keyword">FALSE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add the gif footer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addFooter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;image .= <span class="string">";"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Compare gif blocks? What is a block?</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $GlobalBlock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $LocalBlock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $Len</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">blockCompare</span><span class="params">($GlobalBlock, $LocalBlock, $Len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $Len; $i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                $GlobalBlock &#123; <span class="number">3</span> * $i + <span class="number">0</span> &#125; != $LocalBlock &#123; <span class="number">3</span> * $i + <span class="number">0</span> &#125; ||</span><br><span class="line">                $GlobalBlock &#123; <span class="number">3</span> * $i + <span class="number">1</span> &#125; != $LocalBlock &#123; <span class="number">3</span> * $i + <span class="number">1</span> &#125; ||</span><br><span class="line">                $GlobalBlock &#123; <span class="number">3</span> * $i + <span class="number">2</span> &#125; != $LocalBlock &#123; <span class="number">3</span> * $i + <span class="number">2</span> &#125;</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="keyword">return</span> ( <span class="number">0</span> );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="number">1</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * No clue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $int</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string the char you meant?</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">word</span><span class="params">($int)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ( chr($int &amp; <span class="number">0xFF</span>) . chr(( $int &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the animated gif</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getAnimation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;image;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the animated gif</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@echo</span> image</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//late footer add</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;addFooter();</span><br><span class="line">        header(<span class="string">'Content-type:image/gif'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;image;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ä½¿ç”¨ç¤ºä¾‹ä»£ç :<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="string">'abcdefghijkmnpqrstuvwxy3456789'</span>;</span><br><span class="line">$len = strlen($str) - <span class="number">1</span>;</span><br><span class="line">$text = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">6</span>; $i++) &#123;</span><br><span class="line">$text .= $str[rand(<span class="number">0</span>, $len)];</span><br><span class="line">&#125;</span><br><span class="line">$gif = ImageCode(</span><br><span class="line">$text, <span class="number">8</span>, <span class="number">1</span>,</span><br><span class="line"><span class="number">100</span>, <span class="number">35</span>,</span><br><span class="line"><span class="number">23</span></span><br><span class="line">);</span><br><span class="line">$gif-&gt;display();</span><br></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘æ„Ÿè§‰è‡ªå·±çš„é¡¹ç›®ä¸Šçš„éªŒè¯ç å¤ªlowäº†,å†³å®šæ¢ä¸€ä¸ªæœ‰æ„æ€çš„åŠ¨æ€giféªŒè¯ç &lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="ä»£ç " scheme="https://hexo.lilis.xin/tags/%E4%BB%A3%E7%A0%81/"/>
    
      <category term="captcha" scheme="https://hexo.lilis.xin/tags/captcha/"/>
    
      <category term="gif" scheme="https://hexo.lilis.xin/tags/gif/"/>
    
  </entry>
  
  <entry>
    <title>gd-è¾“å‡ºå›¾ç‰‡æµ</title>
    <link href="https://hexo.lilis.xin/posts/faad097e/"/>
    <id>https://hexo.lilis.xin/posts/faad097e/</id>
    <published>2018-11-06T10:11:07.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ælaravelsé¡¹ç›®,ç”±äºlaravelsæ˜¯é€šè¿‡swooleæ¥åŠ é€Ÿlaravelçš„,php-fpmæ¨¡å¼ä¸‹çš„ä¸€äº›è¾“å‡ºå‡½æ•°æ”¶åˆ°äº†å¹²æ‰°,æ¯”å¦‚:header(),åœ¨laravelsä¸‹è¿”å›è¾“å‡ºå’Œheaderå¤´çš„è®¾å®šéœ€è¦ç”±response()æ¥å®Œæˆ.ä½†æ˜¯gdçš„è¾“å‡ºå°±æ¯”è¾ƒç‰¹åˆ«äº†,å®ƒè¦ä¹ˆè¾“å‡ºç½‘é¡µ,è¦ä¹ˆè¾“å‡ºæ–‡ä»¶.å¦‚æœæƒ³è¦è¾“å‡ºäºŒè¿›åˆ¶æµå†äº¤ç»™PHPå°±æ¯”è¾ƒéº»çƒ¦äº†,ç½‘ä¸Šæ™®éçš„æ–¹æ¡ˆå°±æ˜¯å…ˆæŠŠgdå›¾åƒè¾“å‡ºåˆ°ç¼“å­˜æ–‡ä»¶é‡Œ,å†è¯»å–å‡ºæ¥.å¯æ˜¯åœ¨è¦æœ‰å ç”¨äº†å¤ªå¤šçš„ç£ç›˜I/O<br><a id="more"></a></p><h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><p><code>gd</code>ç›´æ¥è¾“å‡ºåˆ°ç½‘é¡µæˆ‘ä»¬åå°æ— æ³•å¾ˆå¥½çš„è®¾ç½®<code>header</code>æ¥æ ‡æ³¨æ–‡ä»¶ç±»å‹.</p><h4 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h4><p><code>gd</code>å…ˆè¾“å‡ºåˆ°æ–‡ä»¶,åœ¨ç”¨<code>file_get_contents</code>è¯»å–.<br>ç¼ºé™·:å¤ªè¿‡äºå ç”¨ç£ç›˜<code>I/O</code><br><code>gd</code>çš„è¾“å‡ºå…ˆç”±<code>ob</code>ç¼“å­˜ä¸‹æ¥,å†ç”¨<code>ob_get_contents</code>è·å–.<br>ä»£ç :<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ob_start();</span><br><span class="line"><span class="keyword">switch</span> ($type) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'jpg'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'jpeg'</span>:</span><br><span class="line">$type = <span class="string">'image/jpeg'</span>;</span><br><span class="line">imagejpeg(<span class="keyword">$this</span>-&gt;image, <span class="string">''</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'png'</span>:</span><br><span class="line">$type = <span class="string">'image/png'</span>;</span><br><span class="line">imagepng(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'bmp'</span>:</span><br><span class="line">$type = <span class="string">'image/vnd.wap.wbmp'</span>;</span><br><span class="line">imagewbmp(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'gif'</span>:</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">$type = <span class="string">'image/gif'</span>;</span><br><span class="line">imagegif(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">$contents = ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line"><span class="keyword">return</span> response($content)</span><br><span class="line">-&gt;header(<span class="string">'Content-type'</span>, $type);</span><br></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨ælaravelsé¡¹ç›®,ç”±äºlaravelsæ˜¯é€šè¿‡swooleæ¥åŠ é€Ÿlaravelçš„,php-fpmæ¨¡å¼ä¸‹çš„ä¸€äº›è¾“å‡ºå‡½æ•°æ”¶åˆ°äº†å¹²æ‰°,æ¯”å¦‚:header(),åœ¨laravelsä¸‹è¿”å›è¾“å‡ºå’Œheaderå¤´çš„è®¾å®šéœ€è¦ç”±response()æ¥å®Œæˆ.ä½†æ˜¯gdçš„è¾“å‡ºå°±æ¯”è¾ƒç‰¹åˆ«äº†,å®ƒè¦ä¹ˆè¾“å‡ºç½‘é¡µ,è¦ä¹ˆè¾“å‡ºæ–‡ä»¶.å¦‚æœæƒ³è¦è¾“å‡ºäºŒè¿›åˆ¶æµå†äº¤ç»™PHPå°±æ¯”è¾ƒéº»çƒ¦äº†,ç½‘ä¸Šæ™®éçš„æ–¹æ¡ˆå°±æ˜¯å…ˆæŠŠgdå›¾åƒè¾“å‡ºåˆ°ç¼“å­˜æ–‡ä»¶é‡Œ,å†è¯»å–å‡ºæ¥.å¯æ˜¯åœ¨è¦æœ‰å ç”¨äº†å¤ªå¤šçš„ç£ç›˜I/O&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="gd" scheme="https://hexo.lilis.xin/tags/gd/"/>
    
      <category term="ob" scheme="https://hexo.lilis.xin/tags/ob/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨Merlinä¸Šå®‰è£…Entware</title>
    <link href="https://hexo.lilis.xin/posts/32c6b91b/"/>
    <id>https://hexo.lilis.xin/posts/32c6b91b/</id>
    <published>2018-11-05T08:01:50.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¹‹å‰å®‰è£…å¥½Merlinå,æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…Entware,ä¸è¿‡åœ¨å®‰è£…Entwareä¹‹å‰éœ€è¦å…ˆæŒ‚è½½Uç›˜å¹¶æ ¼å¼åŒ–ä¸ºext4.<br><a id="more"></a></p><h3 id="å®‰è£…fdisk"><a href="#å®‰è£…fdisk" class="headerlink" title="å®‰è£…fdisk"></a>å®‰è£…fdisk</h3><p>fdiskä¸€èˆ¬çš„Merlinéƒ½æ˜¯è‡ªå¸¦çš„,æ— éœ€å®‰è£…,å¦‚æœè¿˜æ²¡æœ‰å®‰è£…fdiskè€Œä¸”ä¹Ÿè¿˜æ²¡æœ‰Entwareçš„è¯è¦ä¹ˆå°±ç›´æ¥ç”¨ç”µè„‘æ ¼å¼åŒ–åæŒ‚è½½è¿›å»(è¿™ä¸ªæˆ‘æ²¡æœ‰è¯•è¿‡,åº”è¯¥æ•ˆæœä¸€è‡´)</p><h3 id="æ£€æŸ¥è®¾å¤‡"><a href="#æ£€æŸ¥è®¾å¤‡" class="headerlink" title="æ£€æŸ¥è®¾å¤‡"></a>æ£€æŸ¥è®¾å¤‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿™é‡Œå…ˆè¾“å‡ºç³»ç»Ÿåˆ†åŒºä¹‹ç±»çš„ä¸ç”¨ç®¡ï¼Œå¤–ç½®è®¾å¤‡ä¸€èˆ¬åœ¨æœ€å</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸€èˆ¬ä¼šæœ‰ç±»ä¼¼äºè¿™æ ·çš„,å¦‚æœæ²¡æœ‰é‚£ä½ éœ€è¦æ£€æŸ¥ä¸€ä¸‹Uç›˜æ˜¯å¦æ­£å¸¸</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¿¡æ¯æ³¨æ„çœ‹åˆ°å’Œä½ çš„å­˜å‚¨å¤§å°ä¸€æ ·çš„è®¾å¤‡ï¼Œæˆ‘çš„æ˜¯<code>/dev/sda</code>ï¼Œåœ¨å®ƒé‡Œé¢æœ‰ä¸ª<code>/dev/sda1</code>çš„åˆ†åŒº</p><h3 id="åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº"><a href="#åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº" class="headerlink" title="åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº"></a>åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sda # è¿™æ˜¯ä½ çš„è®¾å¤‡åˆ¥æ‰“æˆåˆ†åŒº,æ³¨æ„åˆ«æ‰“æˆäº†sda1</span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.29.2).</span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Command (m for help): d # è¾“å…¥då›è½¦ï¼Œæˆ‘åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œå®ƒè‡ªåŠ¨é€‰æ‹©äº†ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªåˆ†åŒºï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨d</span><br><span class="line">Selected partition 1</span><br><span class="line">Partition 1 has been deleted.</span><br><span class="line"></span><br><span class="line">Command (m for help): n # è¾“å…¥nä¼šè½¦ï¼Œåˆ›å»ºåˆ†åŒº</span><br><span class="line">Partition type</span><br><span class="line">p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">e   extended (container for logical partitions)</span><br><span class="line"></span><br><span class="line">Select (default p): p # é€‰æ‹©p</span><br><span class="line">Partition number (1-4, default 1): # å›è½¦</span><br><span class="line">First sector (2048-2065023, default 2048): #å›è½¦</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (2048-2065023, default 2065023): # å›è½¦</span><br><span class="line">Created a new partition 1 of type 'Linux' and of size 1007.3 MiB.</span><br><span class="line"></span><br><span class="line">Command (m for help): w # è¾“å…¥wå›è½¦ï¼Œä¿å­˜å¹¶é€€å‡º</span><br><span class="line">The partition table has been altered.</span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><p>ç»è¿‡ä»¥ä¸Šçš„æ“ä½œï¼Œä½ å¯ä»¥ç”¨<code>fdisk -l</code>å‘½ä»¤æŸ¥çœ‹Uç›˜ä¸Šæ˜¯å¦åªæœ‰ä¸€ä¸ª<code>Linux</code>åˆ†åŒº<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰¾åˆ°ä½ çš„è®¾å¤‡ å¯ä»¥çœ‹åˆ°IDä¸º83å°±å¯¹äº†</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Device Boot      Start         End      Blocks  Id System</span><br><span class="line">/dev/sda1               2       29327    30029824  83 Linux</span><br></pre></td></tr></table></figure><p></p><h3 id="æ ¼å¼åŒ–åˆ†åŒº"><a href="#æ ¼å¼åŒ–åˆ†åŒº" class="headerlink" title="æ ¼å¼åŒ–åˆ†åŒº"></a>æ ¼å¼åŒ–åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 /dev/sda1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœä½ çš„ç¡¬ç›˜æ¯”è¾ƒå¤§ï¼Œ256Gä»¥ä¸Šçš„è¯ï¼Œæ˜¯è¿™ä¸ªå‘½ä»¤ï¼šmkfs.ext4 -T largefile /dev/sda1</span></span><br><span class="line">mke2fs 1.43.3 (04-Sep-2016)</span><br><span class="line">/dev/sda1 contains a ext4 file system labelled 'ONMP'</span><br><span class="line">last mounted on Sun Nov 12 09:21:22 2017</span><br><span class="line">Proceed anyway? (y,n) y # è¾“å…¥yå›è½¦</span><br><span class="line">umount /dev/sda1 # å¦‚æœå‡ºé”™ï¼Œå¯èƒ½æ˜¯å› ä¸ºå·²ç»è¢«æŒ‚è½½äº†ï¼Œå…ˆæ‰§è¡Œè¿™ä¸ªå¸è½½</span><br></pre></td></tr></table></figure><h3 id="æŒ‚è½½åˆ†åŒº"><a href="#æŒ‚è½½åˆ†åŒº" class="headerlink" title="æŒ‚è½½åˆ†åŒº"></a>æŒ‚è½½åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /mnt/sda1</span><br><span class="line">mount -t ext4 /dev/sda1 /mnt/sda1/</span><br><span class="line">df -h</span><br><span class="line">Filesystem                Size      Used Available Use% Mounted on</span><br><span class="line">/dev/sda1               975.5M      2.5M    906.6M   0% /tmp/mnt/sda1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯ä»¥çœ‹åˆ°å·²ç»æŒ‚è½½</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…å’Œä½¿ç”¨Entware"><a href="#å®‰è£…å’Œä½¿ç”¨Entware" class="headerlink" title="å®‰è£…å’Œä½¿ç”¨Entware"></a>å®‰è£…å’Œä½¿ç”¨Entware</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entware-setup.sh</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸€ä¸‹é€‰æ‹©åˆ†åŒºçš„æ—¶å€™é€‰æ‹©åˆšæ‰æŒ‚è½½ä¸Šå»çš„é‚£ä¸ª<br>å‚è€ƒ:</p><ul><li><a href="https://github.com/xzhih/ONMP/wiki/%E5%9C%A8%E6%A2%85%E6%9E%97%E4%B8%8A%E5%AE%89%E8%A3%85-Entware" title="åœ¨æ¢…æ—ä¸Šå®‰è£… Entware" target="_blank" rel="noopener">åœ¨æ¢…æ—ä¸Šå®‰è£… Entware</a></li><li><a href="https://github.com/xzhih/ONMP/wiki/%E5%A6%82%E4%BD%95%E5%9C%A8%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%8A%E6%A0%BC%E5%BC%8F%E5%8C%96-U-%E7%9B%98%E4%B8%BA-ext4" title="å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ– U ç›˜ä¸º ext4" target="_blank" rel="noopener">å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ– U ç›˜ä¸º ext4</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ä¹‹å‰å®‰è£…å¥½Merlinå,æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…Entware,ä¸è¿‡åœ¨å®‰è£…Entwareä¹‹å‰éœ€è¦å…ˆæŒ‚è½½Uç›˜å¹¶æ ¼å¼åŒ–ä¸ºext4.&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Merlin" scheme="https://hexo.lilis.xin/tags/Merlin/"/>
    
      <category term="R7000" scheme="https://hexo.lilis.xin/tags/R7000/"/>
    
      <category term="è·¯ç”±å™¨" scheme="https://hexo.lilis.xin/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
      <category term="Entware" scheme="https://hexo.lilis.xin/tags/Entware/"/>
    
      <category term="ç£ç›˜ç®¡ç†" scheme="https://hexo.lilis.xin/tags/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>R7000åˆ·Merlin</title>
    <link href="https://hexo.lilis.xin/posts/50136e28/"/>
    <id>https://hexo.lilis.xin/posts/50136e28/</id>
    <published>2018-11-05T05:56:02.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä¹°äº†ä¸€ä¸ªNetgear R7000 è·¯ç”±å™¨,åˆ°æ‰‹åå°±æ„Ÿè§‰å¿å—ä¸äº†å®ƒçš„é‚£ä¸ªè¶…ä¸å¥½ç”¨çš„web ui,æ‰€ä»¥å°±æ²¡ä¸Šæ‰‹ä¸¤åˆ†é’Ÿæœæ–­åˆ·æœºæˆMerlinäº†.<br><a id="more"></a></p><h3 id="ä¸»è¦æ­¥éª¤"><a href="#ä¸»è¦æ­¥éª¤" class="headerlink" title="ä¸»è¦æ­¥éª¤"></a>ä¸»è¦æ­¥éª¤</h3><ol><li>åˆ·æœºåˆ°<code>Merlin</code>å’Œ<code>Netgear</code>ä¹‹é—´çš„ä¸€ä¸ªè¿‡æ¸¡å›ºä»¶(è¿™å…¶å®å°±æ˜¯ä¸€äº›ç©å®¶åšçš„<code>Netgear</code>ç‰ˆçš„<code>Merlin</code>å›ºä»¶åŒ…,æ˜¯ä¸€ä¸ªå®Œæ•´ç‰ˆçš„<code>Merlin</code>,åªæ˜¯ç‰ˆæœ¬æ¯”è¾ƒè€)</li><li>åˆ·æœºåˆ°æœ€æ–°ç‰ˆçš„<code>Merlin</code><h3 id="æ‰€éœ€ææ–™"><a href="#æ‰€éœ€ææ–™" class="headerlink" title="æ‰€éœ€ææ–™"></a>æ‰€éœ€ææ–™</h3><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.chk" title="R7000_380.70_0-X7.9.1-koolshare.chk" target="_blank" rel="noopener">R7000_380.70_0-X7.9.1-koolshare.chk</a><br><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.trx" title="R7000_380.70_0-X7.9.1-koolshare.trx" target="_blank" rel="noopener">R7000_380.70_0-X7.9.1-koolshare.trx</a></li></ol><h3 id="åˆ·æœºæ–¹æ³•"><a href="#åˆ·æœºæ–¹æ³•" class="headerlink" title="åˆ·æœºæ–¹æ³•"></a>åˆ·æœºæ–¹æ³•</h3><ul><li>æµè§ˆå™¨è¾“å…¥<a href="http://www.routerlogin.net" target="_blank" rel="noopener">www.routerlogin.net</a></li><li>è¿›å…¥<code>é«˜çº§</code>â€”<code>ç®¡ç†</code>â€”<code>å›ºä»¶æ›´æ–°</code>ï¼Œä¸Šä¼  <code>R7000_380.70_0-X7.9.1-koolshare.chk</code> å›ºä»¶ï¼Œç‚¹æ›´æ–°(æœ‰å¾ˆå¤šæ•™ç¨‹è¯´è¦åœ¨è¿™ä¸€æ­¥ä¹‹å‰æ¢å¤å‡ºå‚è®¾ç½®,ä¸è¿‡æˆ‘è¿™è¾¹æ²¡æœ‰æ¢å¤ä¹Ÿå¯ä»¥,å¦‚æœæœ‰ç©å®¶ä¸æ”¾å¿ƒæ¢å¤å‡ºå‚è®¾ç½®ä¹Ÿå¯ä»¥)<br>æ›´æ–°å›ºä»¶è¿‡ç¨‹ä¸­è·¯ç”±å™¨å¯èƒ½è¦é‡å¯å‡ æ¬¡</li><li>å†è¾“å…¥<a href="http://router.asus.com/" title="http://router.asus.com/" target="_blank" rel="noopener">http://router.asus.com/</a>è®¿é—®æ–°çš„å›ºä»¶çš„æ§åˆ¶é¢æ¿</li><li>æ¢å¤ä¸€æ¬¡å‡ºå‚è®¾ç½®(è¿™ä¸€æ¬¡æ¢å¤å‡ºå‚è®¾ç½®å’Œæ ¼å¼åŒ–jffsåˆ†åŒºä¹Ÿä¸æ˜¯æ˜¯å¿…é¡»çš„)</li><li>æ ¼å¼åŒ–jffsåˆ†åŒº è¿›å…¥è·¯ç”±ç®¡ç†ç•Œé¢ -<code>ç³»ç»Ÿç®¡ç†</code>- <code>ç³»ç»Ÿè®¾ç½®</code>ï¼Œå‹¾é€‰<code>Format JFFS partition at next boot</code>ï¼Œç‚¹å‡»åº”ç”¨æœ¬é¡µé¢è®¾ç½®åé‡å¯è·¯ç”±å™¨</li><li>è¿›å…¥è·¯ç”±å™¨è®¾ç½®ã€‚<code>ç³»ç»Ÿç®¡ç†</code>â€”<code>å›ºä»¶å‡çº§</code>ï¼Œé€‰æ‹© <code>R7000_380.70_0-X7.9.1-koolshare.trx</code> ä¸Šä¼ åæ›´æ–°ã€‚</li><li>å†æ¢å¤ä¸€æ¬¡å‡ºå‚è®¾ç½®å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†<h5 id="æ¸…é…ç½®è¯´æ˜"><a href="#æ¸…é…ç½®è¯´æ˜" class="headerlink" title="æ¸…é…ç½®è¯´æ˜"></a>æ¸…é…ç½®è¯´æ˜</h5></li></ul><table><thead><tr><th>A åˆ· B</th><th>ï¼ˆBï¼‰X6.x</th><th>ï¼ˆBï¼‰X7.x</th><th>ï¼ˆBï¼‰X7.9.1</th></tr></thead><tbody><tr><td>ï¼ˆAï¼‰X6.x</td><td>ä¿æŒ</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td></tr><tr><td>ï¼ˆAï¼‰X7.x</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>ä¿æŒ</td><td>ä¿æŒ</td></tr><tr><td>ï¼ˆAï¼‰X7.9.1</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>ä»…æ ¼å¼åŒ–jffs</td><td>ä¿æŒ</td></tr></tbody></table><h5 id="å›ºä»¶åŒæ¸…æ–¹æ³•"><a href="#å›ºä»¶åŒæ¸…æ–¹æ³•" class="headerlink" title="å›ºä»¶åŒæ¸…æ–¹æ³•"></a>å›ºä»¶åŒæ¸…æ–¹æ³•</h5><p>å¦‚æœå›ºä»¶å‡ºç°é—®é¢˜,ä¸€æ—¶æ‰¾ä¸åˆ°è§£å†³åŠæ³•,å¯ä»¥å°è¯•åŒæ¸…å¹¶æ‰‹åŠ¨é…ç½®,æ–¹æ³•å¦‚ä¸‹</p><ul><li>æ ¼å¼åŒ–jffsåˆ†åŒºï¼šæ–¹æ³•åŒä¸Šï¼›</li><li>æ¢å¤å‡ºå‚è®¾ç½®ï¼šè¿›å…¥è·¯ç”±ç®¡ç†ç•Œé¢ -ã€ã€ç³»ç»Ÿç®¡ç†ã€‘- ã€æ¢å¤/å¯¼å‡º/ä¸Šä¼ è®¾ç½®ã€‘- ã€åŸå‚é»˜è®¤å€¼ã€‘ï¼Œç‚¹å‡»åŸå‚é»˜è®¤å€¼ä¸€æ çš„ã€æ¢å¤ã€‘æŒ‰é’®ï¼›</li><li>å»ºè®®å®ŒæˆåŒæ¸…åæ‰‹åŠ¨é…ç½®è·¯ç”±ï¼Œè€Œä¸æ˜¯ç”¨ä»¥å‰å¤‡ä»½çš„é…ç½®ï¼Œä»¥é¿å…å¯èƒ½çš„é—®é¢˜ï¼›<h3 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h3></li><li>X7.9.1 å›ºä»¶ (trx)<ul><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9.1-koolshare.trx" title="R6300V2" target="_blank" rel="noopener">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9.1-koolshare.trx" title="R6400" target="_blank" rel="noopener">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.trx" title="R6900/R7000" target="_blank" rel="noopener">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9.1-koolshare.trx" title="R8000" target="_blank" rel="noopener">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9.1-koolshare.trx" title="R8500" target="_blank" rel="noopener">R8500</a></li></ul></li><li>X7.9.1 è¿‡æ¸¡å›ºä»¶ (chk)<ul><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9.1-koolshare.chk" title="R6300V2" target="_blank" rel="noopener">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9.1-koolshare.chk" title="R6400" target="_blank" rel="noopener">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.chk" title="R6900/R7000" target="_blank" rel="noopener">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9.1-koolshare.chk" title="R8000" target="_blank" rel="noopener">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9.1-koolshare.chk" title="R8500" target="_blank" rel="noopener">R8500</a></li></ul></li><li>X7.9<ul><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9-koolshare.trx" title="R6300V2" target="_blank" rel="noopener">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9-koolshare.trx" title="R6400" target="_blank" rel="noopener">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9-koolshare.trx" title="R6900/R7000" target="_blank" rel="noopener">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9-koolshare.trx" title="R8000" target="_blank" rel="noopener">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9-koolshare.trx" title="R8500" target="_blank" rel="noopener">R8500</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ä¹°äº†ä¸€ä¸ªNetgear R7000 è·¯ç”±å™¨,åˆ°æ‰‹åå°±æ„Ÿè§‰å¿å—ä¸äº†å®ƒçš„é‚£ä¸ªè¶…ä¸å¥½ç”¨çš„web ui,æ‰€ä»¥å°±æ²¡ä¸Šæ‰‹ä¸¤åˆ†é’Ÿæœæ–­åˆ·æœºæˆMerlinäº†.&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Merlin" scheme="https://hexo.lilis.xin/tags/Merlin/"/>
    
      <category term="R7000" scheme="https://hexo.lilis.xin/tags/R7000/"/>
    
      <category term="è·¯ç”±å™¨" scheme="https://hexo.lilis.xin/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æµ‹è¯•Emojiè¡¨æƒ…</title>
    <link href="https://hexo.lilis.xin/posts/5cd7067a/"/>
    <id>https://hexo.lilis.xin/posts/5cd7067a/</id>
    <published>2018-10-29T13:43:42.000Z</published>
    <updated>2019-09-12T06:27:03.600Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸ° ğŸ¨ ğŸ¸ ğŸ ğŸ¾ ğŸ˜„ ğŸ’™âœˆï¸ğŸ‘¶ğŸ¤ğŸˆğŸ»ğŸŒµğŸ‘¯ğŸ˜°ğŸ‚ğŸ’‹ğŸƒğŸ™</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ğŸ° ğŸ¨ ğŸ¸ ğŸ ğŸ¾ ğŸ˜„ ğŸ’™âœˆï¸ğŸ‘¶ğŸ¤ğŸˆğŸ»ğŸŒµğŸ‘¯ğŸ˜°ğŸ‚ğŸ’‹ğŸƒğŸ™&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="emoji" scheme="https://hexo.lilis.xin/tags/emoji/"/>
    
  </entry>
  
  <entry>
    <title>LaravelSå¼€å‘è®°å½•</title>
    <link href="https://hexo.lilis.xin/posts/45ef7ac/"/>
    <id>https://hexo.lilis.xin/posts/45ef7ac/</id>
    <published>2018-10-29T08:35:19.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸»è¦è®°å½•äº†ç”±æ™®é€šPHPå¼€å‘è€…åˆæ­¥æ¥è§¦laravelSæ˜¯æ‰€é‡åˆ°çš„ä¸€äº›å°å‘<br><a id="more"></a></p><h3 id="LaravelSä»‹ç»"><a href="#LaravelSä»‹ç»" class="headerlink" title="LaravelSä»‹ç»"></a>LaravelSä»‹ç»</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> _                               _  _____</span><br><span class="line">| |                             | |/ ____|</span><br><span class="line">| |     __ _ _ __ __ ___   _____| | (___</span><br><span class="line">| |    / _` | &apos;__/ _` \ \ / / _ \ |\___ \</span><br><span class="line">| |___| (_| | | | (_| |\ V /  __/ |____) |</span><br><span class="line">|______\__,_|_|  \__,_| \_/ \___|_|_____/</span><br></pre></td></tr></table></figure><p>LaravelSæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä½¿æ™®é€šçš„laravelé¡¹ç›®å°½å¿«çš„äº«å—ä¸Šswooleçš„ä¼˜åŠ¿çš„laravelæ’ä»¶<br>å®˜æ–¹æè¿°:<br>ğŸš€LaravelSæ˜¯ä¸€ä¸ªèƒ¶æ°´é¡¹ç›®ï¼Œç”¨äºå¿«é€Ÿé›†æˆSwooleåˆ°Laravelæˆ–Lumenï¼Œç„¶åèµ‹äºˆå®ƒä»¬æ›´å¥½çš„æ€§èƒ½ã€æ›´å¤šå¯èƒ½æ€§ã€‚</p><p>GitHubåœ°å€:<br><a href="https://github.com/hhxsv5/laravel-s" title="hhxsv5/laravel-s" target="_blank" rel="noopener">hhxsv5/laravel-s</a><br>æ–‡æ¡£åœ°å€:<br><a href="https://github.com/hhxsv5/laravel-s/blob/master/README-CN.md" title="laravel-s/README-CN.md" target="_blank" rel="noopener">laravel-s/README-CN.md</a><br>Laravel-Chinaåœ°å€:<br><a href="https://laravel-china.org/articles/8050/laravels-speed-up-laravellumen-through-swoole" title="LaravelS - åŸºäº Swoole åŠ é€Ÿ Laravel/Lumen - å¸¦ä½ é£ ğŸš€" target="_blank" rel="noopener">LaravelS - åŸºäº Swoole åŠ é€Ÿ Laravel/Lumen - å¸¦ä½ é£ ğŸš€</a></p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><h4 id="å®‰è£…è¦æ±‚"><a href="#å®‰è£…è¦æ±‚" class="headerlink" title="å®‰è£…è¦æ±‚"></a>å®‰è£…è¦æ±‚</h4><table><thead><tr><th>ä¾èµ–</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>PHP</td><td>&gt;= 5.5.9 æ¨èPHP7+</td></tr><tr><td>Swoole</td><td>&gt;= 1.7.19 ä»2.0.12å¼€å§‹ä¸å†æ”¯æŒPHP5 æ¨è4.2.3+</td></tr><tr><td>Laravel/Lumen</td><td>&gt;= 5.1 æ¨è5.6+</td></tr></tbody></table><h4 id="å®‰è£…swoole"><a href="#å®‰è£…swoole" class="headerlink" title="å®‰è£…swoole"></a>å®‰è£…swoole</h4><p>è¯¦ç»†è¯·å‚è€ƒ <a href="https://hexo.lilis.xin/2018/07/26/install-swoole/" title="swooleå®‰è£…">swooleå®‰è£…</a></p><h4 id="å®‰è£…laravel"><a href="#å®‰è£…laravel" class="headerlink" title="å®‰è£…laravel"></a>å®‰è£…laravel</h4><p>å¯ä»¥é€šè¿‡composerç›´æ¥å®‰è£…,æˆ–è€…å®‰è£…å®‰è£…å™¨æˆ–è€…ç›´æ¥ä»GitHubæ‹·è´æºä»£ç æ¥å®‰è£…</p><h4 id="å®‰è£…laravelS"><a href="#å®‰è£…laravelS" class="headerlink" title="å®‰è£…laravelS"></a>å®‰è£…laravelS</h4><ol><li><p>é€šè¿‡Composerå®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">composer require "hhxsv5/laravel-s:~3.0" -vvv</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¡®ä¿ä½ çš„composer.lockæ–‡ä»¶æ˜¯åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­</span></span><br></pre></td></tr></table></figure></li><li><p>æ³¨å†Œ<code>Service Provider</code></p><ul><li><p>Laravel: ä¿®æ”¹æ–‡ä»¶<code>config/app.php</code>ï¼ŒLaravel 5.5+æ”¯æŒåŒ…è‡ªåŠ¨å‘ç°ï¼Œä½ åº”è¯¥è·³è¿‡è¿™æ­¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'providers'</span> =&gt; [</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    Hhxsv5\LaravelS\Illuminate\LaravelSServiceProvider::class,</span><br><span class="line">],</span><br></pre></td></tr></table></figure></li><li><p>Lumen: ä¿®æ”¹æ–‡ä»¶<code>bootstrap/app.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$app-&gt;register(Hhxsv5\LaravelS\Illuminate\LaravelSServiceProvider::class);</span><br></pre></td></tr></table></figure></li></ul></li><li><p>å‘å¸ƒé…ç½®æ–‡ä»¶.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan laravels publish</span><br></pre></td></tr></table></figure></li></ol><p>å¦‚æœä½ ç”¨çš„æ˜¯<code>lumen</code>,ä¸éœ€è¦åŠ è½½<code>config/laravels.php</code><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªå¯æœ‰å¯æ— </span></span><br><span class="line">$app-&gt;configure(<span class="string">'laravels'</span>);</span><br></pre></td></tr></table></figure><p></p><ol start="4"><li>ä¿®æ”¹é…ç½®<code>config/laravels.php</code><br>è¯·å‚è€ƒ<code>laravelSé…ç½®é¡¹</code></li></ol><h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan laravels &#123;start|stop|restart|reload|publish&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>start</td><td>å¯åŠ¨<code>LaravelS</code>ã€‚é€‰é¡¹<code>-d</code>æˆ–<code>--daemonize</code>ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œæ­¤é€‰é¡¹å°†è¦†ç›–<code>laravels.php</code>ä¸­<code>swoole.daemonize</code>è®¾ç½®</td></tr><tr><td>stop</td><td>åœæ­¢<code>LaravelS</code></td></tr><tr><td>restart</td><td>é‡å¯<code>LaravelS</code>ï¼Œæ”¯æŒé€‰é¡¹<code>-d</code>æˆ–<code>--daemonize</code></td></tr><tr><td>reload</td><td>å¹³æ»‘é‡å¯æ‰€æœ‰<code>worker</code>è¿›ç¨‹ï¼Œè¿™äº›<code>worker</code>è¿›ç¨‹å†…åŒ…å«ä½ çš„ä¸šåŠ¡ä»£ç å’Œæ¡†æ¶(<code>Laravel/Lumen</code>)ä»£ç ï¼Œä¸ä¼šé‡å¯<code>master/manger</code>è¿›ç¨‹</td></tr><tr><td>publish</td><td>å‘å¸ƒé…ç½®æ–‡ä»¶åˆ°ä½ çš„é¡¹ç›®ä¸­<code>config/laravels.php</code></td></tr></tbody></table><p>ps:å±•ç¤ºå·²ç»å¯åŠ¨çš„é¡¹ç›®:<br><code>ps -ef|grep laravels</code></p><h4 id="é…ç½®nginx"><a href="#é…ç½®nginx" class="headerlink" title="é…ç½®nginx"></a>é…ç½®nginx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">gzip on;</span><br><span class="line">gzip_min_length 1024;</span><br><span class="line">gzip_comp_level 2;</span><br><span class="line">gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml application/x-httpd-php image/jpeg image/gif image/png font/ttf font/otf image/svg+xml;</span><br><span class="line">gzip_vary on;</span><br><span class="line">gzip_disable "msie6";</span><br><span class="line">upstream laravels &#123;</span><br><span class="line">    # By IP:Port</span><br><span class="line">    server 127.0.0.1:9100 weight=5 max_fails=3 fail_timeout=30s; #è¿™é‡Œé…ç½®çš„æ˜¯laravelSç›‘å¬çš„æ¥å£å‚æ•°</span><br><span class="line">    # By UnixSocket Stream file</span><br><span class="line">    #server unix:/xxxpath/laravel-s-test/storage/laravels.sock weight=5 max_fails=3 fail_timeout=30s;</span><br><span class="line">    #server 192.168.1.1:5200 weight=3 max_fails=3 fail_timeout=30s;</span><br><span class="line">    #server 192.168.1.2:5200 backup;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">server_name laravels.com;</span><br><span class="line"><span class="meta">#</span><span class="bash">ä¸ºäº†ç»™nginxå®šä½é™æ€èµ„æº</span></span><br><span class="line">root /xxxpath/laravel-s-test/public;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nginxå¤„ç†é™æ€èµ„æº(å»ºè®®å¼€å¯gzip)ï¼ŒLaravelSå¤„ç†åŠ¨æ€èµ„æºã€‚</span></span><br><span class="line">location / &#123;</span><br><span class="line">try_files $uri @laravels;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location @laravels &#123;</span><br><span class="line">        proxy_connect_timeout 60s;</span><br><span class="line">        proxy_send_timeout 60s;</span><br><span class="line">        proxy_read_timeout 120s;</span><br><span class="line">        proxy_set_header Connection "keep-alive";</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        proxy_set_header Scheme $scheme;</span><br><span class="line">        proxy_set_header Server-Protocol $server_protocol;</span><br><span class="line">        proxy_set_header Server-Name $server_name;</span><br><span class="line">        proxy_set_header Server-Addr $server_addr;</span><br><span class="line">        proxy_set_header Server-Port $server_port;</span><br><span class="line">        proxy_pass http://laravels;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é…ç½®Apache"><a href="#é…ç½®Apache" class="headerlink" title="é…ç½®Apache"></a>é…ç½®Apache</h4><p>ps:æˆ‘ç”¨çš„æ˜¯nginx,æ²¡æœ‰å®é™…é…ç½®è¿‡,å°±ç›´æ¥æŠŠå®˜æ–¹æ–‡æ¡£é‡Œçš„æ‹¿è¿‡æ¥äº†<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">LoadModule proxy_module /yyypath/modules/mod_deflate.so</span><br><span class="line"><span class="tag">&lt;<span class="name">IfModule</span> <span class="attr">deflate_module</span>&gt;</span></span><br><span class="line">    SetOutputFilter DEFLATE</span><br><span class="line">    DeflateCompressionLevel 2</span><br><span class="line">    AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml application/x-httpd-php image/jpeg image/gif image/png font/ttf font/otf image/svg+xml</span><br><span class="line"><span class="tag">&lt;/<span class="name">IfModule</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">VirtualHost</span> *<span class="attr">:80</span>&gt;</span></span><br><span class="line">    # åˆ«å¿˜äº†ç»‘Hostå“Ÿ</span><br><span class="line">    ServerName www.laravels.com</span><br><span class="line">    ServerAdmin hhxsv5@sina.com</span><br><span class="line"></span><br><span class="line">    DocumentRoot /xxxpath/laravel-s-test/public;</span><br><span class="line">    DirectoryIndex index.html index.htm</span><br><span class="line">    <span class="tag">&lt;<span class="name">Directory</span> "/"&gt;</span></span><br><span class="line">        AllowOverride None</span><br><span class="line">        Require all granted</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy_balancer.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_lbmethod_byrequests.so.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy_http.so.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_slotmem_shm.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_rewrite.so</span><br><span class="line"></span><br><span class="line">    ProxyRequests Off</span><br><span class="line">    ProxyPreserveHost On</span><br><span class="line">    <span class="tag">&lt;<span class="name">Proxy</span> <span class="attr">balancer:</span>//<span class="attr">laravels</span>&gt;</span></span><br><span class="line">        BalancerMember http://192.168.1.1:8011 loadfactor=7</span><br><span class="line">        #BalancerMember http://192.168.1.2:8011 loadfactor=3</span><br><span class="line">        #BalancerMember http://192.168.1.3:8011 loadfactor=1 status=+H</span><br><span class="line">        ProxySet lbmethod=byrequests</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Proxy</span>&gt;</span></span><br><span class="line">    #ProxyPass / balancer://laravels/</span><br><span class="line">    #ProxyPassReverse / balancer://laravels/</span><br><span class="line"></span><br><span class="line">    # Apacheå¤„ç†é™æ€èµ„æºï¼ŒLaravelSå¤„ç†åŠ¨æ€èµ„æºã€‚</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteCond %&#123;DOCUMENT_ROOT&#125;%&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">    RewriteCond %&#123;DOCUMENT_ROOT&#125;%&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">    RewriteRule ^/(.*)$ balancer://laravels/%&#123;REQUEST_URI&#125; [P,L]</span><br><span class="line"></span><br><span class="line">    ErrorLog $&#123;APACHE_LOG_DIR&#125;/www.laravels.com.error.log</span><br><span class="line">    CustomLog $&#123;APACHE_LOG_DIR&#125;/www.laravels.com.access.log combined</span><br><span class="line"><span class="tag">&lt;/<span class="name">VirtualHost</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><h4 id="è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡"><a href="#è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡"></a>è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡</h4><p>æ­¤ç‰¹æ€§ä¾èµ–<code>Swoole</code>çš„<code>AsyncTask</code>ï¼Œå¿…é¡»å…ˆè®¾ç½®<code>config/laravels.php</code>çš„<code>swoole.task_worker_num</code>ã€‚<br>å¼‚æ­¥äº‹ä»¶çš„å¤„ç†èƒ½åŠ›å—<code>Task</code>è¿›ç¨‹æ•°å½±å“ï¼Œéœ€åˆç†è®¾ç½®<code>task_worker_num</code>ã€‚<br>ä»»åŠ¡ç»“æ„<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Task</span>\<span class="title">Message</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Traits</span>\<span class="title">Push</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Hhxsv5</span>\<span class="title">LaravelS</span>\<span class="title">Swoole</span>\<span class="title">Task</span>\<span class="title">Task</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reply</span> <span class="keyword">extends</span> <span class="title">Task</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($data)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = $data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡é€»è¾‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="comment">//Do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>ps: ä»»åŠ¡é‡Œæ²¡æœ‰ä¾èµ–æ³¨å…¥è¿™ç§ä¾¿æ·çš„ä¸œè¥¿<br>æŠ•é€’ä»»åŠ¡<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹åŒ–$actionå¹¶é€šè¿‡deliveræŠ•é€’</span></span><br><span class="line"><span class="comment">//æ­¤æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼ŒæŠ•é€’åç«‹å³è¿”å›</span></span><br><span class="line"><span class="comment">//ç”±Taskè¿›ç¨‹ç»§ç»­å¤„ç†$actionä¸­çš„handleé€»è¾‘</span></span><br><span class="line">$task = <span class="keyword">new</span> \App\Task\Message\Reply($dat);</span><br><span class="line"><span class="comment">// $task-&gt;delay(3);// å»¶è¿Ÿ3ç§’æŠ•æ”¾ä»»åŠ¡</span></span><br><span class="line">\Hhxsv5\LaravelS\Swoole\Task\Task::deliver($task);</span><br></pre></td></tr></table></figure><p></p><h4 id="laravelSé…ç½®é¡¹"><a href="#laravelSé…ç½®é¡¹" class="headerlink" title="laravelSé…ç½®é¡¹"></a>laravelSé…ç½®é¡¹</h4><ul><li><p><code>listen_ip</code>ï¼š<code>string</code> ç›‘å¬çš„IPï¼Œç›‘å¬æœ¬æœº<code>127.0.0.1</code>(IPv4) <code>::1</code>(IPv6)ï¼Œç›‘å¬æ‰€æœ‰åœ°å€ <code>0.0.0.0</code>(IPv4) ::(IPv6)ï¼Œ é»˜è®¤<code>127.0.0.1</code>ã€‚</p></li><li><p><code>listen_port</code>ï¼š<code>int</code> ç›‘å¬çš„ç«¯å£ï¼Œå¦‚æœç«¯å£å°äº1024åˆ™éœ€è¦rootæƒé™ï¼Œ<code>default 5200</code>ã€‚</p></li><li><p><code>socket_type</code>ï¼šé»˜è®¤<code>SWOOLE_SOCK_TCP</code>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ— éœ€å…³å¿ƒè¿™ä¸ªé…ç½®ã€‚è‹¥éœ€Nginxä»£ç†è‡³<code>UnixSocket Stream</code>æ–‡ä»¶ï¼Œåˆ™éœ€ä¿®æ”¹ä¸º<code>SWOOLE_SOCK_UNIX_STREAM</code>ï¼Œæ­¤æ—¶<code>listen_ip</code>åˆ™æ˜¯<code>UnixSocket Stream</code>æ–‡ä»¶çš„è·¯å¾„ã€‚</p></li><li><p><code>enable_gzip</code>ï¼šbool å½“é€šè¿‡LaravelSå“åº”æ•°æ®æ—¶ï¼Œæ˜¯å¦å¯ç”¨gzipå‹ç¼©å“åº”çš„å†…å®¹ï¼Œä¾èµ–åº“<code>zlib</code>ï¼Œé€šè¿‡å‘½ä»¤<code>php --ri swoole|grep zlib</code>æ£€æŸ¥<code>gzip</code>æ˜¯å¦å¯ç”¨ã€‚å¦‚æœå¼€å¯åˆ™ä¼šè‡ªåŠ¨åŠ ä¸Šå¤´éƒ¨<code>Content-Encoding</code>ï¼Œé»˜è®¤<code>false</code>ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼ˆä¾‹å¦‚Nginxï¼‰ï¼Œå»ºè®®ä»£ç†æœåŠ¡å™¨å¼€å¯<code>gzip</code>ï¼Œ<code>LaravelS</code>å…³é—­gzipï¼Œé¿å…é‡å¤<code>gzip</code>å‹ç¼©ã€‚</p></li><li><p><code>server</code>ï¼š<code>string</code> å½“é€šè¿‡<code>LaravelS</code>å“åº”æ•°æ®æ—¶ï¼Œè®¾ç½®<code>HTTP</code>å¤´éƒ¨<code>Server</code>çš„å€¼ï¼Œè‹¥ä¸ºç©ºåˆ™ä¸è®¾ç½®ï¼Œ<code>default LaravelS</code>ã€‚</p></li><li><p><code>handle_static</code>ï¼š<code>bool</code> æ˜¯å¦å¼€å¯<code>LaravelS</code>å¤„ç†é™æ€èµ„æº(è¦æ±‚ <code>Swoole &gt;= 1.7.21</code>ï¼Œè‹¥<code>Swoole &gt;= 1.9.17</code>åˆ™ç”±Swooleè‡ªå·±å¤„ç†)ï¼Œé»˜è®¤<code>false</code>ï¼Œå»ºè®®<code>Nginx</code>å¤„ç†é™æ€èµ„æºï¼Œ<code>LaravelS</code>ä»…å¤„ç†åŠ¨æ€èµ„æºã€‚é™æ€èµ„æºçš„é»˜è®¤è·¯å¾„ä¸º<code>base_path(&#39;public&#39;)</code>ï¼Œå¯é€šè¿‡ä¿®æ”¹<code>swoole.document_root</code>å˜æ›´ã€‚</p></li><li><p><code>laravel_base_path</code>ï¼š<code>string</code> <code>Laravel/Lumen</code>çš„åŸºç¡€è·¯å¾„ï¼Œé»˜è®¤<code>base_path()</code>ï¼Œå¯ç”¨äºé…ç½®ç¬¦å·é“¾æ¥ã€‚</p></li><li><p><code>inotify_reload.enable</code>ï¼š<code>bool</code> æ˜¯å¦å¼€å¯<code>Inotify Reload</code>ï¼Œç”¨äºå½“ä¿®æ”¹ä»£ç åå®æ—¶<code>Reload</code>æ‰€æœ‰<code>worker</code>è¿›ç¨‹ï¼Œä¾èµ–åº“<code>inotify</code>ï¼Œé€šè¿‡å‘½ä»¤<code>php --ri inotify</code>æ£€æŸ¥æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤<code>false</code>ï¼Œå»ºè®®ä»…å¼€å‘ç¯å¢ƒå¼€å¯ï¼Œä¿®æ”¹ç›‘å¬æ•°ä¸Šé™ã€‚</p></li><li><p><code>inotify_reload.watch_path</code>ï¼š<code>string</code> <code>Inotify</code> ç›‘æ§çš„æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤æœ‰<code>base_path()</code>ã€‚</p></li><li><p><code>inotify_reload.file_types</code>ï¼š<code>array</code> <code>Inotify</code> ç›‘æ§çš„æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤æœ‰<code>.php</code>ã€‚</p></li><li><p><code>inotify_reload.log</code>ï¼š<code>bool</code> æ˜¯å¦è¾“å‡º<code>Reload</code>çš„æ—¥å¿—ï¼Œé»˜è®¤<code>true</code>ã€‚</p></li><li><p><code>websocket.enable</code>ï¼š<code>bool</code> æ˜¯å¦å¯ç”¨<code>WebSocket</code>æœåŠ¡å™¨ã€‚å¯ç”¨å<code>WebSocket</code>æœåŠ¡å™¨ç›‘å¬çš„<code>IP</code>å’Œç«¯å£ä¸<code>Http</code>æœåŠ¡å™¨ç›¸åŒï¼Œé»˜è®¤<code>false</code>ã€‚</p></li><li><p><code>websocket.handler</code>ï¼š<code>string</code> <code>WebSocket</code>é€»è¾‘å¤„ç†çš„ç±»åï¼Œéœ€å®ç°æ¥å£<code>WebSocketHandlerInterface</code>ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>sockets</code>ï¼š<code>array</code> é…ç½®<code>TCP/UDP</code>å¥—æ¥å­—åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>processes</code>ï¼š<code>array</code> é…ç½®è‡ªå®šä¹‰è¿›ç¨‹åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>events</code>ï¼š<code>array</code> è‡ªå®šä¹‰çš„å¼‚æ­¥äº‹ä»¶å’Œç›‘å¬çš„ç»‘å®šåˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>swoole_tables</code>ï¼š<code>array</code> å®šä¹‰çš„<code>swoole_table</code>åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>register_providers</code>ï¼š<code>array</code> æ¯æ¬¡è¯·æ±‚éœ€è¦é‡æ–°æ³¨å†Œçš„<code>Service Provider</code>åˆ—è¡¨ï¼Œè‹¥å­˜åœ¨<code>boot()</code>æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œã€‚ä¸€èˆ¬ç”¨äºæ¸…ç†æ³¨å†Œäº†å•ä¾‹çš„<code>ServiceProvider</code>ã€‚</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="string">'register_providers'</span> =&gt; [</span><br><span class="line">    <span class="comment">//ä¾‹å¦‚ï¼šé‡æ–°æ³¨å†Œjwtçš„ServiceProvider</span></span><br><span class="line">    \Tymon\JWTAuth\Providers\LaravelServiceProvider::class,</span><br><span class="line">],</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><ul><li>swooleï¼š<code>array</code> <code>Swoole</code>çš„åŸå§‹é…ç½®é¡¹ï¼Œè¯·å‚è€ƒ<a href="https://wiki.swoole.com/wiki/page/274.html" title="Swooleé…ç½®é¡¹" target="_blank" rel="noopener">Swooleé…ç½®é¡¹</a>ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸»è¦è®°å½•äº†ç”±æ™®é€šPHPå¼€å‘è€…åˆæ­¥æ¥è§¦laravelSæ˜¯æ‰€é‡åˆ°çš„ä¸€äº›å°å‘&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="å¼‚æ­¥" scheme="https://hexo.lilis.xin/tags/%E5%BC%82%E6%AD%A5/"/>
    
      <category term="laravel" scheme="https://hexo.lilis.xin/tags/laravel/"/>
    
      <category term="LaravelS" scheme="https://hexo.lilis.xin/tags/LaravelS/"/>
    
      <category term="Lumen" scheme="https://hexo.lilis.xin/tags/Lumen/"/>
    
      <category term="swoole" scheme="https://hexo.lilis.xin/tags/swoole/"/>
    
  </entry>
  
  <entry>
    <title>phpåœ¨linuxä¸‹call to undefined function imagettftext()</title>
    <link href="https://hexo.lilis.xin/posts/d90db6f7/"/>
    <id>https://hexo.lilis.xin/posts/d90db6f7/</id>
    <published>2018-09-19T11:13:43.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨çº¿ä¸Šç¯å¢ƒæµ‹è¯•å›¾ç‰‡ç”Ÿæˆçš„æ—¶å€™æŠ¥é”™:<code>call to undefined function imagettftext()</code><br><a id="more"></a></p><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p>ä¸‹è½½å®‰è£…<a href="https://sourceforge.net/projects/freetype/files/freetype2/2.7.1/freetype-2.7.1.tar.gz/download" title="freetype" target="_blank" rel="noopener">freetype</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/freetype/2.7.1 --without-harfbuzz //ç¼–è¯‘</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>å†é‡æ–°ç¼–è¯‘å®‰è£…gd</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">phpize</span><br><span class="line">make clean</span><br><span class="line">./configure --with-php-config=/usr/local/php/php72/bin/php-config--with-freetype-dir=/usr/local/freetype/2.7.1/ --enable-gd-native-ttf</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨çº¿ä¸Šç¯å¢ƒæµ‹è¯•å›¾ç‰‡ç”Ÿæˆçš„æ—¶å€™æŠ¥é”™:&lt;code&gt;call to undefined function imagettftext()&lt;/code&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="gd" scheme="https://hexo.lilis.xin/tags/gd/"/>
    
      <category term="freetype" scheme="https://hexo.lilis.xin/tags/freetype/"/>
    
  </entry>
  
  <entry>
    <title>phpæ“ä½œredis</title>
    <link href="https://hexo.lilis.xin/posts/a8f30b9a/"/>
    <id>https://hexo.lilis.xin/posts/a8f30b9a/</id>
    <published>2018-09-19T03:32:16.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œä¸»è¦æ˜¯ç”¨çš„predis<br><a id="more"></a><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éªŒè¯æ˜¯å¦å®‰è£…OK:æ‰“å¼€dosçª—å£-&gt;è¾“å…¥redis-server åœ¨æ‰“å¼€ä¸€ä¸ªdosçª—å£--&gt;è¾“å…¥redis-cli æ˜¾ç¤ºï¼š127.0.0.1:6379&gt;åˆ™æˆåŠŸï¼</span></span><br><span class="line">$redis = <span class="keyword">new</span> redis();</span><br><span class="line">$redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="string">'6379'</span>) || <span class="keyword">die</span>(<span class="string">"è¿æ¥å¤±è´¥ï¼"</span>);</span><br><span class="line">$redis-&gt;auth(<span class="string">"admin"</span>); <span class="comment">//æˆæƒ</span></span><br><span class="line"><span class="comment">//******************************stringç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//String æ˜¯æœ€ç®€å•çš„ç±»å‹ï¼Œä¸€ä¸ªKeyå¯¹åº”ä¸€ä¸ªValueï¼ŒStringç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚Redisçš„Stringå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ï¼Œæ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡</span></span><br><span class="line">$redis-&gt;set(<span class="string">'test'</span>, <span class="number">200</span>); <span class="comment">//èµ‹å€¼</span></span><br><span class="line">$redis-&gt;mset(<span class="keyword">array</span>(<span class="string">'key0'</span> =&gt; <span class="string">'value0'</span>, <span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>));<span class="comment">//æ‰¹é‡èµ‹å€¼</span></span><br><span class="line">$redis-&gt;mget(<span class="keyword">array</span>(<span class="string">'key0'</span>, <span class="string">'key1'</span>, <span class="string">'key2'</span>));<span class="comment">//æ‰¹é‡è·å–å€¼</span></span><br><span class="line">$redis-&gt;setnx(<span class="string">'key'</span>,value);<span class="comment">//è®¾ç½®keyå¯¹åº”çš„å€¼ä¸ºstringç±»å‹çš„value,å¦‚æœkeyå·²ç»å­˜åœ¨ï¼Œè¿”å›0,nxæ˜¯not existçš„æ„æ€</span></span><br><span class="line">$redis-&gt;msetnx(<span class="keyword">array</span>(<span class="string">'key0'</span> =&gt; <span class="string">'value0'</span>, <span class="string">'key1'</span> =&gt; <span class="string">'value1'</span>));<span class="comment">//å…¨éƒ¨æˆåŠŸè¿”å›1ï¼Œå¦åˆ™å¤±è´¥ä¸€ä¸ªä¹Ÿè¿”å›0</span></span><br><span class="line">$redis-&gt;getset(<span class="string">"key"</span>,<span class="string">'newvalue'</span>);<span class="comment">//getsetè®¾ç½®keyçš„å€¼ï¼Œå¹¶è¿”å›keyçš„æ—§å€¼</span></span><br><span class="line">$redis-&gt;setex(<span class="string">'key'</span>,<span class="number">10</span>,<span class="string">'value10'</span>);<span class="comment">//å¸¦ç”Ÿå­˜æ—¶é—´çš„å†™å…¥å€¼å•ä½s</span></span><br><span class="line">$redis-&gt;setrange(<span class="string">'key'</span>,<span class="number">0</span>,<span class="string">'hello'</span>);<span class="comment">//è®¾ç½®å­å­—ç¬¦ä¸²æ›¿æ¢ï¼Œkeyï¼Œå¼€å§‹ä½ç½®ï¼Œæ›¿æ¢å€¼</span></span><br><span class="line">$redis-&gt;getrange(<span class="string">"key"</span>,<span class="number">0</span>,<span class="number">2</span>);<span class="comment">//getrangeè·å–å­å­—ç¬¦ä¸²ï¼Œgetrange key start end</span></span><br><span class="line">$redis-&gt;ttl(<span class="string">'key'</span>);<span class="comment">//è·å–keyçš„ç”Ÿå­˜æ—¶é—´,æ²¡è®¾ç½®çš„ä¸º-1</span></span><br><span class="line">$redis-&gt;keys(<span class="string">"*a*"</span>);<span class="comment">//è·å–æ‰€æœ‰keyï¼Œä¹Ÿå¯è·å–å…·ä½“keyï¼Œæ¨¡ç³ŠåŒ¹é…key</span></span><br><span class="line">$redis-&gt;get(<span class="string">"test"</span>); <span class="comment">//æ ¹æ®keyè·å–value</span></span><br><span class="line">$redis-&gt;getMultiple(<span class="keyword">array</span>(<span class="string">'key1'</span>, <span class="string">'key2'</span>, <span class="string">'key3'</span>));</span><br><span class="line">$exits = $redis-&gt;exists(<span class="string">'test'</span>); <span class="comment">//åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ã€‚å­˜åœ¨ true ä¸å­˜åœ¨ false</span></span><br><span class="line"><span class="keyword">echo</span> $exists?$res2:<span class="string">"null"</span>;</span><br><span class="line"><span class="keyword">echo</span> $res1?$res2:<span class="string">"null"</span>;<span class="keyword">die</span>;</span><br><span class="line">$redis-&gt;delete(<span class="string">'key1'</span>, <span class="string">'key2'</span>); <span class="comment">//åˆ é™¤,å¯åˆ é™¤å¤šä¸ª</span></span><br><span class="line">$redis-&gt;delete(<span class="keyword">array</span>(<span class="string">'key3'</span>, <span class="string">'key4'</span>, <span class="string">'key5'</span>));<span class="comment">//åˆ é™¤,å¯åˆ é™¤å¤šä¸ª</span></span><br><span class="line">$redis-&gt;delete( $redis-&gt;keys(<span class="string">"*"</span>));<span class="comment">//ä¼ æ•°ç»„ï¼Œåˆ é™¤æ‰€æœ‰key</span></span><br><span class="line">$redis-&gt;incr(<span class="string">"key"</span>,<span class="number">1</span>);<span class="comment">//è‡ªå¢ï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">$redis-&gt;incrBy(<span class="string">'key'</span>,<span class="number">10</span>);<span class="comment">//å¿…é¡»ç»™å®šå‚æ•°å€¼</span></span><br><span class="line">$redis-&gt;decr(<span class="string">"key"</span>,<span class="number">10</span>);<span class="comment">//è‡ªå‡ï¼Œé»˜è®¤å€¼1</span></span><br><span class="line">$redis-&gt;decrBy(<span class="string">'key'</span>,<span class="number">10</span>);<span class="comment">//å¿…é¡»ç»™å®šå‚æ•°å€¼</span></span><br><span class="line">$redis-&gt;append(<span class="string">"key"</span>,<span class="string">"appendvalue"</span>);<span class="comment">//ç»™æŒ‡å®šçš„keyçš„å­—ç¬¦ä¸²è¿½åŠ value,è¿”å›æ–°å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line">$redis-&gt;strlen(<span class="string">'key'</span>);<span class="comment">//è·å–æŒ‡å®škeyçš„å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line"><span class="comment">//******************************stringç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//******************************hashç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">// Redis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ã€‚å®ƒçš„æ·»åŠ åˆ é™¤éƒ½æ˜¯0(1)</span></span><br><span class="line"><span class="comment">// hashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚ç›¸å¯¹äºå°†å¯¹è±¡çš„æ¯ä¸ªå­—æ®µå­˜æˆå•ä¸ªstringç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">//å°†ä¸€ä¸ªå¯¹è±¡å­˜å‚¨åœ¨hashç±»å‹ä¸­ä¼šå ç”¨æ›´å°‘çš„å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥æ›´æ–¹ä¾¿çš„å­˜å–æ•´ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line">$redis-&gt;flushall();<span class="keyword">die</span>;<span class="comment">//æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line"> $redis-&gt;flushdb();<span class="keyword">die</span>;<span class="comment">//æ¸…ç©ºå½“å‰æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$redis-&gt;hset(<span class="string">"test"</span>,<span class="string">"username"</span>,<span class="string">"admin"</span>);<span class="comment">//å•ä¸ªè®¾ç½®</span></span><br><span class="line">$redis-&gt;hget(<span class="string">"test"</span>,<span class="string">"username"</span>);<span class="comment">//å•ä¸ªè·å–</span></span><br><span class="line">$redis-&gt;hsetnx(<span class="string">"test"</span>,<span class="string">"username"</span>,<span class="string">"admin@qq.com"</span>);<span class="comment">//è®¾ç½®hash field ä¸ºæŒ‡å®šçš„å€¼value,å¦‚æœfeildå·²ç»å­˜åœ¨ï¼Œè¿”å›0,nxæ˜¯not existçš„æ„æ€  </span></span><br><span class="line">$redis-&gt;hmset(<span class="string">"testabc"</span>,<span class="keyword">array</span>(<span class="string">"a"</span>=&gt;<span class="number">1</span>,<span class="string">"b"</span>=&gt;<span class="number">2</span>,<span class="string">"c"</span>=&gt;<span class="number">3</span>,<span class="string">'d'</span>=&gt;<span class="number">4</span>));<span class="comment">//æ‰¹é‡è®¾ç½®</span></span><br><span class="line">$redis-&gt;hmget(<span class="string">"testabc"</span>,<span class="keyword">array</span>(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>));<span class="comment">//æ‰¹é‡è·å–</span></span><br><span class="line">$redis-&gt;hincrBy(<span class="string">"test"</span>,<span class="string">"password"</span>,<span class="string">"123456"</span>);<span class="comment">//è®¾ç½®hash field æ·»åŠ keyå’Œvalue</span></span><br><span class="line">$redis-&gt;hexists(<span class="string">"test"</span>,<span class="string">"usernames"</span>);<span class="comment">//æµ‹è¯•hash field  å­˜åœ¨1ï¼Œä¸å­˜åœ¨0</span></span><br><span class="line">$redis-&gt;hlen(<span class="string">"test"</span>); <span class="comment">//è¿”å›hash é‡Œæ‰€æœ‰çš„ field çš„æ•°é‡</span></span><br><span class="line">$redis-&gt;hdel(<span class="string">"test"</span>,<span class="string">"key"</span>);<span class="comment">//åˆ é™¤æŒ‡å®šhashçš„field</span></span><br><span class="line">$redis-&gt;hkeys(<span class="string">"test"</span>); <span class="comment">//è¿”å›hash æ‰€æœ‰ field</span></span><br><span class="line">$redis-&gt;hvals(<span class="string">"test"</span>);<span class="comment">//è¿”å›hash æ‰€æœ‰ field values</span></span><br><span class="line">$redis-&gt;hgetall(<span class="string">"test"</span>);<span class="comment">//è·å–hashä¸­å…¨éƒ¨çš„fieldå’Œvalue</span></span><br><span class="line"><span class="comment">//******************************hashç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//******************************listé“¾è¡¨**********************************************************</span></span><br><span class="line"><span class="comment">//æ ˆå…ˆè¿›åå‡ºï¼›é˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºï¼›</span></span><br><span class="line"><span class="comment">//List æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œä¸»è¦åŠŸèƒ½æ˜¯push,pop,è·å–ä¸€ä¸ªèŒƒå›´çš„æ‰€æœ‰å€¼ç­‰ç­‰ï¼Œæ“ä½œä¸­keyç†è§£ä¸ºé“¾è¡¨çš„åå­—ã€‚</span></span><br><span class="line"><span class="comment">//Redisçš„listç±»å‹å…¶å®å°±æ˜¯ä¸€ä¸ªæ¯ä¸ªå­å…ƒç´ éƒ½æ˜¯stringç±»å‹çš„åŒå‘é“¾è¡¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡push,popæ“ä½œä»é“¾è¡¨çš„å¤´éƒ¨æˆ–è€…å°¾éƒ¨æ·»åŠ åˆ é™¤å…ƒç´ ï¼Œè¿™æ ·LISTæ—¢å¯ä»¥ä½œä¸ºæ ˆï¼Œåˆå¯ä»¥ä½œä¸ºé˜Ÿåˆ—ã€‚</span></span><br><span class="line">$redis-&gt;lrange(<span class="string">"list"</span>,<span class="number">0</span>,<span class="number">-1</span>);<span class="comment">//å–é“¾è¡¨list ä»0ä½å¼€å§‹å–åˆ°æœ€åä½ç½®ï¼›0ä»£è¡¨å¤´  -1ä»£è¡¨å°¾</span></span><br><span class="line">$redis-&gt;lpush(<span class="string">"list"</span>,<span class="string">"1"</span>); <span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å¤´éƒ¨æ·»åŠ å­—ç¬¦ä¸²å…ƒç´ </span></span><br><span class="line">$redis-&gt;rpush(<span class="string">"list"</span>,<span class="string">"test"</span>); <span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å°¾éƒ¨æ·»åŠ å­—ç¬¦ä¸²å…ƒç´ </span></span><br><span class="line">$redis-&gt;lpop(<span class="string">"list"</span>);<span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å¤´éƒ¨åˆ é™¤å­—ç¬¦ä¸²å…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤å­—ç¬¦</span></span><br><span class="line">$redis-&gt;rpop(<span class="string">"list"</span>);<span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å°¾éƒ¨åˆ é™¤å­—ç¬¦ä¸²å…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤å­—ç¬¦</span></span><br><span class="line"><span class="keyword">echo</span>  $redis-&gt;lrem(<span class="string">"list"</span>,<span class="number">2</span>,<span class="string">'key'</span>);<span class="comment">//åœ¨listä¸­åˆ é™¤Nä¸ªå’Œvalueç›¸åŒçš„å…ƒç´ (n&lt;0ä»å°¾åˆ é™¤,n=0å…¨éƒ¨åˆ é™¤),è¿”å›çš„å€¼ä¸ºåˆ é™¤çš„ä¸ªæ•°</span></span><br><span class="line">$redis-&gt;lset(<span class="string">"list"</span>,<span class="number">-1</span>,<span class="string">"å•Š"</span>);<span class="comment">//è®¾ç½®listä¸­æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ å€¼ lset(list,ä½ç½®ï¼Œå€¼)ï¼Œä½ç½®å¯ä»¥ä»å¤´æˆ–è€…ä»å°¾</span></span><br><span class="line">$redis-&gt;lindex(<span class="string">"list"</span>,<span class="number">0</span>);<span class="comment">//è¿”å›listä¸­indexä½ç½®çš„å…ƒç´ </span></span><br><span class="line">$redis-&gt;llen(<span class="string">"list"</span>);<span class="comment">//è¿”å›listçš„é•¿åº¦</span></span><br><span class="line">$redis-&gt;ltrim(<span class="string">"list"</span>,<span class="number">0</span>,<span class="number">1</span>);<span class="comment">//ä¿ç•™æŒ‡å®škeyçš„å€¼çš„èŒƒå›´å†…çš„æ•°æ® 0ä¸ºå¤´  -1ä¸ºå°¾</span></span><br><span class="line">$redis-&gt;linsert(<span class="string">"list"</span>);<span class="comment">//********</span></span><br><span class="line">$redis-&gt;rpoplpush(<span class="string">"list"</span>,<span class="string">"listt"</span>);<span class="comment">//ä»ç¬¬ä¸€ä¸ªLISTçš„å°¾éƒ¨ç§»é™¤å…ƒç´ å¹¶æ·»åŠ åˆ°ç¬¬äºŒä¸ªLISTçš„å¤´éƒ¨</span></span><br><span class="line"><span class="comment">//******************************listé“¾è¡¨**********************************************************</span></span><br><span class="line"><span class="comment">//******************************seté›†åˆ**********************************************************</span></span><br><span class="line"><span class="comment">//  Setæ˜¯é›†åˆï¼Œå®ƒæ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚setæ˜¯é€šè¿‡hash tableå®ç°çš„ï¼Œæ·»åŠ ï¼Œåˆ é™¤å’ŒæŸ¥æ‰¾çš„å¤æ‚ç¨‹åº¦éƒ½æ˜¯0(1)</span></span><br><span class="line"><span class="comment">//   å¯¹é›†åˆæˆ‘ä»¬å¯ä»¥å–å¹¶é›†ï¼Œäº¤é›†ï¼Œå·®é›†ã€‚é€šè¿‡è¿™äº›æ“ä½œæˆ‘ä»¬å¯ä»¥å®ç°SNSä¸­çš„å¥½å‹æ¨èå’Œblogçš„tagåŠŸèƒ½</span></span><br><span class="line">$redis-&gt;sadd(<span class="string">"col"</span>,<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>);<span class="comment">//å‘é›†åˆä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line">$redis-&gt;smembers(<span class="string">"col"</span>);<span class="comment">//é›†åˆå…ƒç´ åˆ—è¡¨</span></span><br><span class="line">$redis-&gt;srem(<span class="string">"col"</span>,<span class="string">'d'</span>);<span class="comment">//é›†åˆç§»é™¤å…ƒç´ </span></span><br><span class="line">$redis-&gt;spop(<span class="string">"col"</span>);<span class="comment">//éšæœºåˆ é™¤é›†åˆå…ƒç´ å¹¶è¿”å›åˆ é™¤çš„å…ƒç´ ã€‚åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ æ—¶ï¼Œåˆ™é›†åˆä¹Ÿè¢«åˆ é™¤</span></span><br><span class="line">$redis-&gt;sdiff(<span class="string">"set1"</span>,<span class="string">"set2"</span>);<span class="comment">//å–å¤šä¸ªé›†åˆçš„å·®é›†ï¼Œè°åœ¨å‰é¢å·²è°ä¸ºæ ‡å‡†ï¼ˆå·®é›†å°±æ˜¯å‰é¢ç¬¬ä¸€ä¸ªé›†åˆæœ‰è€Œåé¢æ‰€æœ‰é›†åˆéƒ½æ²¡æœ‰ï¼‰</span></span><br><span class="line">$redis-&gt;sdiffstore(<span class="string">"dif"</span>,<span class="string">"set1"</span>,<span class="string">"set2"</span>);<span class="comment">//è¿”å›å¤šä¸ªé›†åˆçš„å·®é›†ï¼Œå­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line">$redis-&gt;sinter(<span class="string">"set"</span>,<span class="string">"set1"</span>,<span class="string">'set2'</span>);<span class="comment">//äº¤é›†ï¼ˆæ‰€æœ‰é›†åˆéƒ½æœ‰çš„å…ƒç´ ï¼‰</span></span><br><span class="line">$res = $redis-&gt;sinterstore(<span class="string">"inter"</span>,<span class="string">"set"</span>,<span class="string">"set1"</span>);<span class="comment">///å–å¤šä¸ªé›†åˆçš„äº¤é›†,å­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line">$redis-&gt;sunion(<span class="string">"set"</span>,<span class="string">"set1"</span>,<span class="string">'set2'</span>);<span class="comment">//å¹¶é›†ï¼ˆæ‰€æœ‰é›†åˆåˆå¹¶å»é‡çš„å…ƒç´ ï¼‰</span></span><br><span class="line">$redis-&gt;sunionstore(<span class="string">"union"</span>,<span class="string">"set"</span>,<span class="string">"set1"</span>);<span class="comment">///å–å¤šä¸ªé›†åˆçš„å¹¶é›†,å­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line">$redis-&gt;smove(<span class="string">"set1"</span>,<span class="string">"set2"</span>,<span class="string">"value"</span>);<span class="comment">///ç¬¬ä¸€ä¸ªé›†åˆå…ƒç´ å‰ªåˆ‡åˆ°ç¬¬äºŒä¸ªé›†åˆé‡Œé¢ã€‚</span></span><br><span class="line">$redis-&gt;scard(<span class="string">"set"</span>);<span class="comment">//è¿”å›é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</span></span><br><span class="line">$redis-&gt;sismember(<span class="string">"set"</span>,<span class="string">"value"</span>);<span class="comment">//åˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦ä¸ºé›†åˆçš„å…ƒç´ </span></span><br><span class="line">$redis-&gt;srandmember(<span class="string">"set"</span>);<span class="comment">//éšæœºè¿”å›é›†åˆå†…çš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸ä¼šåˆ é™¤å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">$redis-&gt;keys(<span class="string">"*"</span>);   <span class="comment">//è¿”å›æ‰€æœ‰key</span></span><br><span class="line">$redis-&gt;keys(<span class="string">"*t"</span>);   <span class="comment">//è¿”å›æ‰€æœ‰så¼€å¤´çš„key</span></span><br><span class="line">$res = $redis-&gt;keys(<span class="string">"*"</span>);</span><br><span class="line"><span class="keyword">foreach</span> ($res <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line"><span class="keyword">echo</span> $v.<span class="string">"=&gt;"</span>.$redis-&gt;get($v).<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$redis-&gt;exists(<span class="string">"set"</span>);   <span class="comment">//åˆ¤æ–­è¯¥keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">$redis-&gt;del(<span class="string">"inter"</span>);   <span class="comment">//åˆ é™¤è¯¥key</span></span><br><span class="line">$redis-&gt;expire(<span class="string">"set2"</span>,<span class="number">100</span>);   <span class="comment">//è®¾ç½®key è¿‡æœŸæ—¶é—´10s</span></span><br><span class="line">$redis-&gt;ttl(<span class="string">"set3"</span>);<span class="comment">//æŸ¥çœ‹è¿‡æœŸå‰©ä½™æ—¶é—´s</span></span><br><span class="line"></span><br><span class="line">$redis-&gt;select(<span class="string">"1"</span>);<span class="comment">// é€‰æ‹©æ•°æ®åº“</span></span><br><span class="line">$redis-&gt;set(<span class="string">"name"</span>,<span class="string">"test"</span>);<span class="comment">// è®¾ç½®key=&gt;value</span></span><br><span class="line">$redis-&gt;get(<span class="string">"name"</span>);<span class="comment">// æ ¹æ®keyè·å–value</span></span><br><span class="line">$redis-&gt;move(<span class="string">"get"</span>,<span class="number">1</span>);<span class="comment">// æŠŠkeyç§»åˆ°å¦ä¸€ä¸ªæ•°æ®åº“</span></span><br><span class="line">$redis-&gt;persist(<span class="string">"set2"</span>);<span class="comment">// ç§»é™¤è¿‡æœŸæ—¶é—´</span></span><br><span class="line">$redis-&gt;randomkey();<span class="comment">//éšæœºè¿”å›ä¸€ä¸ªkey</span></span><br><span class="line">$redis-&gt;rename(<span class="string">"names"</span>,<span class="string">"newname"</span>);<span class="comment">//é‡å‘½åkey</span></span><br><span class="line">$redis-&gt;type(<span class="string">"zset"</span>);<span class="comment">//è·å–keyç±»å‹</span></span><br><span class="line">$redis-&gt;dbsize();<span class="comment">//è·å–æ•°æ®åº“keyä¸ªæ•°</span></span><br><span class="line">$redis-&gt;info();<span class="comment">//è·å–redisæœåŠ¡ä¿¡æ¯</span></span><br><span class="line">$redis-&gt;echo(<span class="string">"helloï¼Œworld"</span>);<span class="comment">//è¾“å‡ºå‡½æ•°</span></span><br><span class="line"><span class="comment">//******************************seté›†åˆ**********************************************************</span></span><br><span class="line"><span class="comment">//redisæœ‰äº”å¤§æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment">//å­—ç¬¦ä¸² string</span></span><br><span class="line"><span class="comment">//hash è¡¨</span></span><br><span class="line"><span class="comment">//é“¾è¡¨ç»“æ„ list</span></span><br><span class="line"><span class="comment">//set é›†åˆ(æ— åº)</span></span><br><span class="line"><span class="comment">//zset æœ‰åºé›†åˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//stringæ¥å­˜å‚¨ç”¨æˆ·çš„æœ€å¤§id,ç”¨æ¥idçš„è‡ªå¢</span></span><br><span class="line"><span class="comment">//hash è¡¨æ¥å­˜å‚¨ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="comment">//listé“¾è¡¨ç»“æ„æ¥å­˜å‚¨ç”¨æˆ·çš„idå·</span></span><br><span class="line">$uid = $redis-&gt;incr(<span class="string">"blog:id"</span>);  <span class="comment">//è‡ªå¢é•¿</span></span><br><span class="line">$res = $redis-&gt;hmset(<span class="string">'blog:user:'</span> . $uid, <span class="keyword">array</span>(<span class="string">'id'</span> =&gt; $uid, <span class="string">'username'</span> =&gt;<span class="string">'admin'</span>.time() . time(), <span class="string">'password'</span> =&gt; md5(time()))); <span class="comment">//hashè¡¨æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line">$redis-&gt;rpush(<span class="string">"blog:uid"</span>, $uid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$res = $redis-&gt;hgetall(<span class="string">"blog:user:"</span>.$uid);</span><br><span class="line">$redis-&gt;del(<span class="string">"blog:user:"</span>.$uid);<span class="comment">//åˆ é™¤ç”¨æˆ·</span></span><br><span class="line">$redis-&gt;lrem(<span class="string">"blog:uid"</span>,$uid);<span class="comment">//åˆ é™¤é“¾è¡¨ä¸­çš„id</span></span><br><span class="line">print_R($res);<span class="keyword">die</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$count = $redis-&gt;lsize(<span class="string">"blog:uid"</span>); <span class="comment">//listç±»å‹countæ€»æ•° </span></span><br><span class="line">$page_size = <span class="number">3</span>;</span><br><span class="line">$page_num = !<span class="keyword">empty</span>($_GET[<span class="string">'page'</span>]) ? $_GET[<span class="string">'page'</span>] : <span class="number">1</span>;</span><br><span class="line">$page_count = ceil($count / $page_size);</span><br><span class="line">$ids = $redis-&gt;lrange(<span class="string">"blog:uid"</span>, ($page_num - <span class="number">1</span>) * $page_size, (($page_num - <span class="number">1</span>) * $page_size + $page_size - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($ids <span class="keyword">as</span> $v) &#123;</span><br><span class="line">$ress[] = $redis-&gt;hgetall(<span class="string">"blog:user:"</span> . $v); <span class="comment">//è·å–è®°å½•</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span><span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">print_r($ress);</span><br></pre></td></tr></table></figure><p></p><p>åŸæ–‡é“¾æ¥:<br><a href="https://www.jianshu.com/p/c1c798828477" title="phpæ“ä½œredisç¬”è®°ï¼" target="_blank" rel="noopener">phpæ“ä½œredisç¬”è®°ï¼</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é‡Œä¸»è¦æ˜¯ç”¨çš„predis&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="redis" scheme="https://hexo.lilis.xin/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>laravel-adminå®‰è£…</title>
    <link href="https://hexo.lilis.xin/posts/16eb654d/"/>
    <id>https://hexo.lilis.xin/posts/16eb654d/</id>
    <published>2018-09-10T04:13:57.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>1.5ç‰ˆæœ¬éœ€è¦å®‰è£…PHP 7+å’ŒLaravel 5.5</p><p>é¦–å…ˆç¡®ä¿å®‰è£…å¥½äº†laravelï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥è®¾ç½®æ­£ç¡®ã€‚<br><a id="more"></a><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="keyword">require</span> encore/laravel-admin <span class="string">"1.5.*"</span></span><br></pre></td></tr></table></figure><p></p><p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å‘å¸ƒèµ„æºï¼š<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan vendor:publish --provider=<span class="string">"Encore\Admin\AdminServiceProvider"</span></span><br></pre></td></tr></table></figure><p></p><p>åœ¨è¯¥å‘½ä»¤ä¼šç”Ÿæˆé…ç½®æ–‡ä»¶config/admin.phpï¼Œå¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å®‰è£…çš„åœ°å€ã€æ•°æ®åº“è¿æ¥ã€ä»¥åŠè¡¨åï¼Œéƒ½å¯ä»¥ç”¨é»˜è®¤é…ç½®ä¸ä¿®æ”¹ã€‚</p><p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤å®Œæˆå®‰è£…ï¼š<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan admin:install</span><br></pre></td></tr></table></figure><p></p><p>å¯åŠ¨æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost/admin/</code> ,ä½¿ç”¨ç”¨æˆ·å <code>admin</code> å’Œå¯†ç  <code>admin</code>ç™»é™†.<br>ps å¦‚æœæŠ¥ä¸€ä¸‹é”™è¯¯<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Specified key was too long error</span><br></pre></td></tr></table></figure><p></p><p>éœ€è¦åœ¨<code>/app/Providers/AppServiceProvider.php</code>æ–‡ä»¶ä¸­ä¿®æ”¹<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Providers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\&#123;</span><br><span class="line">    <span class="title">ServiceProvider</span>,</span><br><span class="line">    <span class="title">Facades</span>\<span class="title">Schema</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::defaultStringLength(<span class="number">191</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;1.5ç‰ˆæœ¬éœ€è¦å®‰è£…PHP 7+å’ŒLaravel 5.5&lt;/p&gt;&lt;p&gt;é¦–å…ˆç¡®ä¿å®‰è£…å¥½äº†laravelï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥è®¾ç½®æ­£ç¡®ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="laravel" scheme="https://hexo.lilis.xin/tags/laravel/"/>
    
      <category term="laravel-admin" scheme="https://hexo.lilis.xin/tags/laravel-admin/"/>
    
  </entry>
  
  <entry>
    <title>Hashç´¢å¼•å’ŒB-Treeç´¢å¼•</title>
    <link href="https://hexo.lilis.xin/posts/294f33b7/"/>
    <id>https://hexo.lilis.xin/posts/294f33b7/</id>
    <published>2018-08-28T12:03:58.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>ç´¢å¼•æ˜¯å¸®åŠ©mysqlè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚æœ€å¸¸è§çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•å’ŒHashç´¢å¼•ã€‚</p><p>ä¸åŒçš„å¼•æ“å¯¹äºç´¢å¼•æœ‰ä¸åŒçš„æ”¯æŒï¼šInnodbå’ŒMyISAMé»˜è®¤çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•ï¼›è€ŒMermoryé»˜è®¤çš„ç´¢å¼•æ˜¯Hashç´¢å¼•ã€‚<br><a id="more"></a><br>åŸæ–‡é“¾æ¥ï¼š<br><a href="https://blog.csdn.net/u014307117/article/details/47325091" title="Hashç´¢å¼•å’ŒBTreeç´¢å¼•" target="_blank" rel="noopener">Hashç´¢å¼•å’ŒBTreeç´¢å¼•</a></p><h3 id="Hashç´¢å¼•"><a href="#Hashç´¢å¼•" class="headerlink" title="Hashç´¢å¼•"></a>Hashç´¢å¼•</h3><p>æ‰€è°“Hashç´¢å¼•ï¼Œå½“æˆ‘ä»¬è¦ç»™æŸå¼ è¡¨æŸåˆ—å¢åŠ ç´¢å¼•æ—¶ï¼Œå°†è¿™å¼ è¡¨çš„è¿™ä¸€åˆ—è¿›è¡Œå“ˆå¸Œç®—æ³•è®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œæ’åºåœ¨å“ˆå¸Œæ•°ç»„ä¸Šã€‚æ‰€ä»¥Hashç´¢å¼•å¯ä»¥ä¸€æ¬¡å®šä½ï¼Œå…¶æ•ˆç‡å¾ˆé«˜ï¼Œè€ŒBtreeç´¢å¼•éœ€è¦ç»è¿‡å¤šæ¬¡çš„ç£ç›˜IOï¼Œä½†æ˜¯innodbå’Œmyisamä¹‹æ‰€ä»¥æ²¡æœ‰é‡‡ç”¨å®ƒï¼Œæ˜¯å› ä¸ºå®ƒå­˜åœ¨ç€å¥½å¤šç¼ºç‚¹ï¼š<br>å› ä¸ºHashç´¢å¼•æ¯”è¾ƒçš„æ˜¯ç»è¿‡Hashè®¡ç®—çš„å€¼ï¼Œæ‰€ä»¥åªèƒ½è¿›è¡Œç­‰å¼æ¯”è¾ƒï¼Œä¸èƒ½ç”¨äºèŒƒå›´æŸ¥è¯¢</p><ul><li>æ¯æ¬¡éƒ½è¦å…¨è¡¨æ‰«æ</li><li>ç”±äºå“ˆå¸Œå€¼æ˜¯æŒ‰ç…§é¡ºåºæ’åˆ—çš„ï¼Œä½†æ˜¯å“ˆå¸Œå€¼æ˜ å°„çš„çœŸæ­£æ•°æ®åœ¨å“ˆå¸Œè¡¨ä¸­å°±ä¸ä¸€å®šæŒ‰ç…§é¡ºåºæ’åˆ—ï¼Œæ‰€ä»¥æ— æ³•åˆ©ç”¨Hashç´¢å¼•æ¥åŠ é€Ÿä»»ä½•æ’åºæ“ä½œ</li><li>ä¸èƒ½ç”¨éƒ¨åˆ†ç´¢å¼•é”®æ¥æœç´¢ï¼Œå› ä¸ºç»„åˆç´¢å¼•åœ¨è®¡ç®—å“ˆå¸Œå€¼çš„æ—¶å€™æ˜¯ä¸€èµ·è®¡ç®—çš„ã€‚</li><li>å½“å“ˆå¸Œå€¼å¤§é‡é‡å¤ä¸”æ•°æ®é‡éå¸¸å¤§æ—¶ï¼Œå…¶æ£€ç´¢æ•ˆç‡å¹¶æ²¡æœ‰Btreeç´¢å¼•é«˜çš„ã€‚</li></ul><h3 id="B-Treeç´¢å¼•"><a href="#B-Treeç´¢å¼•" class="headerlink" title="B-Treeç´¢å¼•"></a>B-Treeç´¢å¼•</h3><p>è‡³äºBtreeç´¢å¼•ï¼Œå®ƒæ˜¯ä»¥B+æ ‘ä¸ºå­˜å‚¨ç»“æ„å®ç°çš„ã€‚</p><p>ä½†æ˜¯Btreeç´¢å¼•çš„å­˜å‚¨ç»“æ„åœ¨Innodbå’ŒMyISAMä¸­æœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><p>åœ¨MyISAMä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å¯¹æŸå¼ è¡¨çš„æŸåˆ—å»ºç«‹Btreeç´¢å¼•çš„è¯ï¼Œå¦‚å›¾ï¼š<br><img src="https://img-blog.csdn.net/20150806231335315"><br>æ‰€ä»¥æˆ‘ä»¬ç»å¸¸ä¼šè¯´MyISAMä¸­æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶æ˜¯åˆ†å¼€çš„ã€‚</p><p>å› æ­¤MyISAMçš„ç´¢å¼•æ–¹å¼ä¹Ÿç§°ä¸ºéèšé›†ï¼ŒInnodbçš„ç´¢å¼•æ–¹å¼æˆä¸ºèšé›†ç´¢å¼•ã€‚</p><p>è‡³äºè¾…åŠ©ç´¢å¼•ï¼Œç±»ä¼¼äºä¸»ç´¢å¼•ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ä¸»ç´¢å¼•ä¸Šçš„å€¼ä¸èƒ½é‡å¤ï¼Œè€Œè¾…åŠ©ç´¢å¼•å¯ä»¥é‡å¤ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç´¢å¼•æ˜¯å¸®åŠ©mysqlè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚æœ€å¸¸è§çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•å’ŒHashç´¢å¼•ã€‚&lt;/p&gt;&lt;p&gt;ä¸åŒçš„å¼•æ“å¯¹äºç´¢å¼•æœ‰ä¸åŒçš„æ”¯æŒï¼šInnodbå’ŒMyISAMé»˜è®¤çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•ï¼›è€ŒMermoryé»˜è®¤çš„ç´¢å¼•æ˜¯Hashç´¢å¼•ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="https://hexo.lilis.xin/tags/MySQL/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="https://hexo.lilis.xin/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨</title>
    <link href="https://hexo.lilis.xin/posts/3d56cf7f/"/>
    <id>https://hexo.lilis.xin/posts/3d56cf7f/</id>
    <published>2018-08-23T03:33:28.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>saræ˜¯System Activity Reporterï¼ˆç³»ç»Ÿæ´»åŠ¨æƒ…å†µæŠ¥å‘Šï¼‰çš„ç¼©å†™ã€‚sarå·¥å…·å°†å¯¹ç³»ç»Ÿå½“å‰çš„çŠ¶æ€è¿›è¡Œå–æ ·ï¼Œç„¶åé€šè¿‡è®¡ç®—æ•°æ®å’Œæ¯”ä¾‹æ¥è¡¨è¾¾ç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥è¿ç»­å¯¹ç³»ç»Ÿå–æ ·ï¼Œè·å¾—å¤§é‡çš„å–æ ·æ•°æ®ï¼›å–æ ·æ•°æ®å’Œåˆ†æçš„ç»“æœéƒ½å¯ä»¥å­˜å…¥æ–‡ä»¶ï¼Œæ‰€éœ€çš„è´Ÿè½½å¾ˆå°ã€‚saræ˜¯ç›®å‰Linuxä¸Šæœ€ä¸ºå…¨é¢çš„ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥ä»14ä¸ªå¤§æ–¹é¢å¯¹ç³»ç»Ÿçš„æ´»åŠ¨è¿›è¡ŒæŠ¥å‘Šï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„è¯»å†™æƒ…å†µã€ç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µã€ä¸²å£ã€CPUæ•ˆç‡ã€å†…å­˜ä½¿ç”¨çŠ¶å†µã€è¿›ç¨‹æ´»åŠ¨åŠIPCæœ‰å…³çš„æ´»åŠ¨ç­‰ï¼Œä½¿ç”¨ä¹Ÿæ˜¯è¾ƒä¸ºå¤æ‚ã€‚<br><a id="more"></a><br>åŸæ–‡é“¾æ¥:<br><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/sar.html" title="sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨" target="_blank" rel="noopener">sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨</a><br>saræ˜¯æŸ¥çœ‹æ“ä½œç³»ç»ŸæŠ¥å‘ŠæŒ‡æ ‡çš„å„ç§å·¥å…·ä¸­ï¼Œæœ€ä¸ºæ™®éå’Œæ–¹ä¾¿çš„ï¼›å®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼›</p><ol><li>è¿½æº¯è¿‡å»çš„ç»Ÿè®¡æ•°æ®ï¼ˆé»˜è®¤ï¼‰</li><li>å‘¨æœŸæ€§çš„æŸ¥çœ‹å½“å‰æ•°æ®<h3 id="æŸ¥çœ‹CPUä½¿ç”¨ç‡"><a href="#æŸ¥çœ‹CPUä½¿ç”¨ç‡" class="headerlink" title="æŸ¥çœ‹CPUä½¿ç”¨ç‡"></a>æŸ¥çœ‹CPUä½¿ç”¨ç‡</h3><code>sar -u</code> é»˜è®¤æƒ…å†µä¸‹æ˜¾ç¤ºçš„cpuä½¿ç”¨ç‡ç­‰ä¿¡æ¯å°±æ˜¯<code>sar -u</code>;<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -u</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">12:00:01 AM     CPU     %user     %nice   %system   %iowait    %steal     %idle</span><br><span class="line">12:10:01 AM     all      0.85      0.00      0.29      0.04      0.00     98.83</span><br><span class="line">12:20:01 AM     all      1.63      0.00      0.34      0.07      0.00     97.96</span><br><span class="line">12:30:01 AM     all      0.73      0.00      0.25      0.04      0.00     98.98</span><br><span class="line">12:40:01 AM     all      0.28      0.00      0.25      0.01      0.00     99.46</span><br><span class="line">12:50:01 AM     all      0.31      0.00      0.26      0.01      0.00     99.43</span><br><span class="line">01:00:01 AM     all      1.63      0.00      0.34      0.10      0.00     97.94</span><br><span class="line">01:10:01 AM     all      0.66      0.00      0.29      0.03      0.00     99.02</span><br><span class="line">01:20:01 AM     all      1.27      0.00      0.30      0.06      0.00     98.37</span><br><span class="line">01:30:01 AM     all      0.29      0.00      0.27      0.01      0.00     99.44</span><br></pre></td></tr></table></figure></li></ol><ul><li>%user ç”¨æˆ·æ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹ï¼›</li><li>%nice é€šè¿‡niceæ”¹å˜äº†è¿›ç¨‹è°ƒåº¦ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œåœ¨ç”¨æˆ·æ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹</li><li>%system ç³»ç»Ÿæ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹ï¼›</li><li>%iowait CPUç­‰å¾…ç£ç›˜I/Oå¯¼è‡´ç©ºé—²çŠ¶æ€æ¶ˆè€—çš„æ—¶é—´æ¯”ä¾‹ï¼›</li><li>%steal åˆ©ç”¨Xenç­‰æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œç­‰å¾…å…¶å®ƒè™šæ‹ŸCPUè®¡ç®—å ç”¨çš„æ—¶é—´æ¯”ä¾‹ï¼›</li><li><p>%idle CPUç©ºé—²æ—¶é—´æ¯”ä¾‹ï¼›</p><h3 id="æŸ¥çœ‹å¹³å‡è´Ÿè½½"><a href="#æŸ¥çœ‹å¹³å‡è´Ÿè½½" class="headerlink" title="æŸ¥çœ‹å¹³å‡è´Ÿè½½"></a>æŸ¥çœ‹å¹³å‡è´Ÿè½½</h3><p><code>sar -q</code> æŸ¥çœ‹å¹³å‡è´Ÿè½½<br>æŒ‡å®š-qåï¼Œå°±èƒ½æŸ¥çœ‹è¿è¡Œé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹æ•°ã€ç³»ç»Ÿä¸Šçš„è¿›ç¨‹å¤§å°ã€å¹³å‡è´Ÿè½½ç­‰ï¼›ä¸å…¶å®ƒå‘½ä»¤ç›¸æ¯”ï¼Œå®ƒèƒ½æŸ¥çœ‹å„é¡¹æŒ‡æ ‡éšæ—¶é—´å˜åŒ–çš„æƒ…å†µï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -q</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">12:00:01 AM   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15   blocked</span><br><span class="line">12:10:01 AM         3       187      0.00      0.02      0.05         0</span><br><span class="line">12:20:01 AM         4       190      0.06      0.03      0.05         0</span><br><span class="line">12:30:01 AM         4       187      0.00      0.01      0.05         1</span><br><span class="line">12:40:01 AM         3       187      0.00      0.01      0.05         0</span><br><span class="line">12:50:01 AM         3       187      0.07      0.10      0.08         1</span><br><span class="line">01:00:01 AM         2       190      0.24      0.08      0.06         0</span><br><span class="line">01:10:01 AM         2       187      0.08      0.03      0.05         0</span><br><span class="line">01:20:01 AM         1       187      0.00      0.03      0.05         1</span><br><span class="line">01:30:01 AM         3       187      0.00      0.01      0.05         0</span><br><span class="line">01:40:01 AM         2       187      0.01      0.03      0.05         1</span><br><span class="line">01:50:01 AM         3       187      0.00      0.01      0.05         1</span><br><span class="line">02:00:01 AM         2       187      0.00      0.01      0.05         0</span><br><span class="line">02:10:01 AM         3       190      0.00      0.04      0.05         0</span><br></pre></td></tr></table></figure></li><li><p>runq-szï¼šè¿è¡Œé˜Ÿåˆ—çš„é•¿åº¦ï¼ˆç­‰å¾…è¿è¡Œçš„è¿›ç¨‹æ•°ï¼‰</p></li><li>plist-szï¼šè¿›ç¨‹åˆ—è¡¨ä¸­è¿›ç¨‹ï¼ˆprocessesï¼‰å’Œçº¿ç¨‹ï¼ˆthreadsï¼‰çš„æ•°é‡</li><li>ldavg-1ï¼šæœ€å1åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½ ldavg-5ï¼šè¿‡å»5åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½</li><li><p>ldavg-15ï¼šè¿‡å»15åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½</p><h3 id="æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ"><a href="#æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ" class="headerlink" title="æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ"></a>æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ</h3><p><code>sar -W</code> æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ<br>é¡µé¢å‘ç”Ÿäº¤æ¢æ—¶ï¼ŒæœåŠ¡å™¨çš„ååé‡ä¼šå¤§å¹…ä¸‹é™ï¼›æœåŠ¡å™¨çŠ¶å†µä¸è‰¯æ—¶ï¼Œå¦‚æœæ€€ç–‘å› ä¸ºå†…å­˜ä¸è¶³è€Œå¯¼è‡´äº†é¡µé¢äº¤æ¢çš„å‘ç”Ÿï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥ç¡®è®¤æ˜¯å¦å‘ç”Ÿäº†å¤§é‡çš„äº¤æ¢ï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -W 1 10</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">11:43:35 AM  pswpin/s pswpout/s</span><br><span class="line">11:43:36 AM      0.00      0.00</span><br><span class="line">11:43:37 AM      0.00      0.00</span><br><span class="line">11:43:38 AM      0.00      0.00</span><br><span class="line">11:43:39 AM      0.00      0.00</span><br><span class="line">11:43:40 AM      0.00      0.00</span><br><span class="line">11:43:41 AM      0.00      0.00</span><br><span class="line">11:43:42 AM      0.00      0.00</span><br><span class="line">11:43:43 AM      0.00      0.00</span><br><span class="line">11:43:44 AM      0.00      0.00</span><br><span class="line">11:43:45 AM      0.00      0.00</span><br><span class="line">Average:         0.00      0.00</span><br></pre></td></tr></table></figure></li><li><p>pswpin/sï¼šæ¯ç§’ç³»ç»Ÿæ¢å…¥çš„äº¤æ¢é¡µé¢ï¼ˆswap pageï¼‰æ•°é‡</p></li><li><p>pswpout/sï¼šæ¯ç§’ç³»ç»Ÿæ¢å‡ºçš„äº¤æ¢é¡µé¢ï¼ˆswap pageï¼‰æ•°é‡<br>è¦åˆ¤æ–­ç³»ç»Ÿç“¶é¢ˆé—®é¢˜ï¼Œæœ‰æ—¶éœ€å‡ ä¸ª sar å‘½ä»¤é€‰é¡¹ç»“åˆèµ·æ¥ï¼›</p></li><li><p>æ€€ç–‘CPUå­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨ sar -u å’Œ sar -q ç­‰æ¥æŸ¥çœ‹</p></li><li>æ€€ç–‘å†…å­˜å­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨sar -Bã€sar -r å’Œ sar -W ç­‰æ¥æŸ¥çœ‹</li><li>æ€€ç–‘I/Oå­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨ sar -bã€sar -u å’Œ sar -d ç­‰æ¥æŸ¥çœ‹<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3>æœ‰çš„linuxç³»ç»Ÿä¸‹ï¼Œé»˜è®¤å¯èƒ½æ²¡æœ‰å®‰è£…è¿™ä¸ªåŒ…ï¼Œä½¿ç”¨<code>yum install sysstat</code> æ¥å®‰è£…ï¼›<br>å®‰è£…å®Œæ¯•ï¼Œå°†æ€§èƒ½æ”¶é›†å·¥å…·çš„å¼€å…³æ‰“å¼€ï¼š <code>vim /etc/default/sysstat</code><br>è®¾ç½® ENABLED=â€trueâ€<h3 id="sarå‚æ•°è¯´æ˜"><a href="#sarå‚æ•°è¯´æ˜" class="headerlink" title="sarå‚æ•°è¯´æ˜"></a>sarå‚æ•°è¯´æ˜</h3></li><li>-A æ±‡æ€»æ‰€æœ‰çš„æŠ¥å‘Š</li><li>-a æŠ¥å‘Šæ–‡ä»¶è¯»å†™ä½¿ç”¨æƒ…å†µ</li><li>-B æŠ¥å‘Šé™„åŠ çš„ç¼“å­˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-b æŠ¥å‘Šç¼“å­˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-c æŠ¥å‘Šç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µ</li><li>-d æŠ¥å‘Šç£ç›˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-g æŠ¥å‘Šä¸²å£çš„ä½¿ç”¨æƒ…å†µ</li><li>-h æŠ¥å‘Šå…³äºbufferä½¿ç”¨çš„ç»Ÿè®¡æ•°æ®</li><li>-m æŠ¥å‘ŠIPCæ¶ˆæ¯é˜Ÿåˆ—å’Œä¿¡å·é‡çš„ä½¿ç”¨æƒ…å†µ</li><li>-n æŠ¥å‘Šå‘½åcacheçš„ä½¿ç”¨æƒ…å†µ</li><li>-p æŠ¥å‘Šè°ƒé¡µæ´»åŠ¨çš„ä½¿ç”¨æƒ…å†µ</li><li>-q æŠ¥å‘Šè¿è¡Œé˜Ÿåˆ—å’Œäº¤æ¢é˜Ÿåˆ—çš„å¹³å‡é•¿åº¦</li><li>-R æŠ¥å‘Šè¿›ç¨‹çš„æ´»åŠ¨æƒ…å†µ</li><li>-r æŠ¥å‘Šæ²¡æœ‰ä½¿ç”¨çš„å†…å­˜é¡µé¢å’Œç¡¬ç›˜å—</li><li>-u æŠ¥å‘ŠCPUçš„åˆ©ç”¨ç‡</li><li>-v æŠ¥å‘Šè¿›ç¨‹ã€ièŠ‚ç‚¹ã€æ–‡ä»¶å’Œé”è¡¨çŠ¶æ€</li><li>-w æŠ¥å‘Šç³»ç»Ÿäº¤æ¢æ´»åŠ¨çŠ¶å†µ</li><li>-y æŠ¥å‘ŠTTYè®¾å¤‡æ´»åŠ¨çŠ¶å†µ</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;saræ˜¯System Activity Reporterï¼ˆç³»ç»Ÿæ´»åŠ¨æƒ…å†µæŠ¥å‘Šï¼‰çš„ç¼©å†™ã€‚sarå·¥å…·å°†å¯¹ç³»ç»Ÿå½“å‰çš„çŠ¶æ€è¿›è¡Œå–æ ·ï¼Œç„¶åé€šè¿‡è®¡ç®—æ•°æ®å’Œæ¯”ä¾‹æ¥è¡¨è¾¾ç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥è¿ç»­å¯¹ç³»ç»Ÿå–æ ·ï¼Œè·å¾—å¤§é‡çš„å–æ ·æ•°æ®ï¼›å–æ ·æ•°æ®å’Œåˆ†æçš„ç»“æœéƒ½å¯ä»¥å­˜å…¥æ–‡ä»¶ï¼Œæ‰€éœ€çš„è´Ÿè½½å¾ˆå°ã€‚saræ˜¯ç›®å‰Linuxä¸Šæœ€ä¸ºå…¨é¢çš„ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥ä»14ä¸ªå¤§æ–¹é¢å¯¹ç³»ç»Ÿçš„æ´»åŠ¨è¿›è¡ŒæŠ¥å‘Šï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„è¯»å†™æƒ…å†µã€ç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µã€ä¸²å£ã€CPUæ•ˆç‡ã€å†…å­˜ä½¿ç”¨çŠ¶å†µã€è¿›ç¨‹æ´»åŠ¨åŠIPCæœ‰å…³çš„æ´»åŠ¨ç­‰ï¼Œä½¿ç”¨ä¹Ÿæ˜¯è¾ƒä¸ºå¤æ‚ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://hexo.lilis.xin/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>scp è·¨æœºè¿œç¨‹æ‹·è´</title>
    <link href="https://hexo.lilis.xin/posts/e90a0b6e/"/>
    <id>https://hexo.lilis.xin/posts/e90a0b6e/</id>
    <published>2018-08-23T03:19:40.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>scpæ˜¯secure copyçš„ç®€å†™ï¼Œç”¨äºåœ¨Linuxä¸‹è¿›è¡Œè¿œç¨‹æ‹·è´æ–‡ä»¶çš„å‘½ä»¤ï¼Œå’Œå®ƒç±»ä¼¼çš„å‘½ä»¤æœ‰cpï¼Œä¸è¿‡cpåªæ˜¯åœ¨æœ¬æœºè¿›è¡Œæ‹·è´ä¸èƒ½è·¨æœåŠ¡å™¨ï¼Œè€Œä¸”scpä¼ è¾“æ˜¯åŠ å¯†çš„ã€‚å½“ä½ æœåŠ¡å™¨ç¡¬ç›˜å˜ä¸ºåªè¯» read only systemæ—¶ï¼Œç”¨scpå¯ä»¥å¸®ä½ æŠŠæ–‡ä»¶ç§»å‡ºæ¥ã€‚<br><a id="more"></a><br>åŸæ–‡é“¾æ¥:<br><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/scp.html" title="scp è·¨æœºè¿œç¨‹æ‹·è´" target="_blank" rel="noopener">scp è·¨æœºè¿œç¨‹æ‹·è´</a></p><h3 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp [å‚æ•°] [åŸè·¯å¾„] [ç›®æ ‡è·¯å¾„]</span><br></pre></td></tr></table></figure><h3 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h3><ol><li>-1 å¼ºåˆ¶scpå‘½ä»¤ä½¿ç”¨åè®®ssh1</li><li>-2 å¼ºåˆ¶scpå‘½ä»¤ä½¿ç”¨åè®®ssh2</li><li>-4 å¼ºåˆ¶scpå‘½ä»¤åªä½¿ç”¨IPv4å¯»å€</li><li>-6 å¼ºåˆ¶scpå‘½ä»¤åªä½¿ç”¨IPv6å¯»å€</li><li>-B ä½¿ç”¨æ‰¹å¤„ç†æ¨¡å¼ï¼ˆä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¯¢é—®ä¼ è¾“å£ä»¤æˆ–çŸ­è¯­ï¼‰</li><li>-C å…è®¸å‹ç¼©ã€‚ï¼ˆå°†-Cæ ‡å¿—ä¼ é€’ç»™sshï¼Œä»è€Œæ‰“å¼€å‹ç¼©åŠŸèƒ½ï¼‰</li><li>-p ç•™åŸæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ï¼Œè®¿é—®æ—¶é—´å’Œè®¿é—®æƒé™ã€‚</li><li>-q ä¸æ˜¾ç¤ºä¼ è¾“è¿›åº¦æ¡ã€‚</li><li>-r é€’å½’å¤åˆ¶æ•´ä¸ªç›®å½•ã€‚</li><li>-v è¯¦ç»†æ–¹å¼æ˜¾ç¤ºè¾“å‡ºã€‚scpå’Œssh(1)ä¼šæ˜¾ç¤ºå‡ºæ•´ä¸ªè¿‡ç¨‹çš„è°ƒè¯•ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯ç”¨äºè°ƒè¯•è¿æ¥ï¼ŒéªŒè¯å’Œé…ç½®é—®é¢˜ã€‚</li><li>-c cipher ä»¥cipherå°†æ•°æ®ä¼ è¾“è¿›è¡ŒåŠ å¯†ï¼Œè¿™ä¸ªé€‰é¡¹å°†ç›´æ¥ä¼ é€’ç»™sshã€‚</li><li>-F ssh_config æŒ‡å®šä¸€ä¸ªæ›¿ä»£çš„sshé…ç½®æ–‡ä»¶ï¼Œæ­¤å‚æ•°ç›´æ¥ä¼ é€’ç»™sshã€‚</li><li>-i identity_file ä»æŒ‡å®šæ–‡ä»¶ä¸­è¯»å–ä¼ è¾“æ—¶ä½¿ç”¨çš„å¯†é’¥æ–‡ä»¶ï¼Œæ­¤å‚æ•°ç›´æ¥ä¼ é€’ç»™sshã€‚</li><li>-l limit é™å®šç”¨æˆ·æ‰€èƒ½ä½¿ç”¨çš„å¸¦å®½ï¼Œä»¥Kbit/sä¸ºå•ä½ã€‚</li><li>-o ssh_option å¦‚æœä¹ æƒ¯äºä½¿ç”¨ssh_config(5)ä¸­çš„å‚æ•°ä¼ é€’æ–¹å¼ï¼Œ</li><li>-P port æ³¨æ„æ˜¯å¤§å†™çš„P, portæ˜¯æŒ‡å®šæ•°æ®ä¼ è¾“ç”¨åˆ°çš„ç«¯å£å·</li><li>-S program æŒ‡å®šåŠ å¯†ä¼ è¾“æ—¶æ‰€ä½¿ç”¨çš„ç¨‹åºã€‚æ­¤ç¨‹åºå¿…é¡»èƒ½å¤Ÿç†è§£ssh(1)çš„é€‰é¡¹ã€‚<h3 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp local_file remote_username@remote_ip:remote_folder</span><br><span class="line">scp remote_username@remote_ip:remote_folder local_file</span><br><span class="line">scp remote_username@remote_ip:remote_folder remote_username@remote_ip:remote_folder</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;scpæ˜¯secure copyçš„ç®€å†™ï¼Œç”¨äºåœ¨Linuxä¸‹è¿›è¡Œè¿œç¨‹æ‹·è´æ–‡ä»¶çš„å‘½ä»¤ï¼Œå’Œå®ƒç±»ä¼¼çš„å‘½ä»¤æœ‰cpï¼Œä¸è¿‡cpåªæ˜¯åœ¨æœ¬æœºè¿›è¡Œæ‹·è´ä¸èƒ½è·¨æœåŠ¡å™¨ï¼Œè€Œä¸”scpä¼ è¾“æ˜¯åŠ å¯†çš„ã€‚å½“ä½ æœåŠ¡å™¨ç¡¬ç›˜å˜ä¸ºåªè¯» read only systemæ—¶ï¼Œç”¨scpå¯ä»¥å¸®ä½ æŠŠæ–‡ä»¶ç§»å‡ºæ¥ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://hexo.lilis.xin/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>WordPressè·å–æ–‡ç« æ‰€æœ‰ä¿¡æ¯</title>
    <link href="https://hexo.lilis.xin/posts/9cdcaf4d/"/>
    <id>https://hexo.lilis.xin/posts/9cdcaf4d/</id>
    <published>2018-08-20T03:39:24.000Z</published>
    <updated>2019-09-12T06:27:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆå¾—å¾—çŸ¥å½“å‰è¯·æ±‚çš„æ–‡ç« IDï¼š<br><a id="more"></a><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_the_ID();  <span class="comment">//ä¼šè¿”å›å½“å‰æ–‡ç« ID</span></span><br></pre></td></tr></table></figure><p></p><p>é‚£ä¹ˆæˆ‘ä»¬å¾—çŸ¥æ–‡ç« IDåï¼Œå¯ä»¥ä½¿ç”¨wordpresså†…ç½®å‡½æ•°æ¥è·å–æ–‡ç« çš„æ‰€æœ‰ä¿¡æ¯:<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get_post($id); <span class="comment">//ä¼šè¿”å›idæ–‡ç« çš„æ‰€æœ‰ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p></p><p>è·å–åˆ°äº†äº›ä»€ä¹ˆä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹è·å–çš„ç»“æœæ„ä¹‰ï¼Œå¯ä»¥å¾—åˆ°ä½ æƒ³è¦çš„æ–‡ç« ä»»ä½•ä¿¡æ¯ï¼š<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">post_authorï¼šï¼ˆæ•´æ•°ï¼‰æ–‡ç« ä½œè€…çš„ç¼–å·</span><br><span class="line"></span><br><span class="line">post_dateï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« å‘è¡¨çš„æ—¥æœŸå’Œæ—¶é—´ï¼ˆYYYY-MM-DD HH-MM-SSï¼‰</span><br><span class="line"></span><br><span class="line">post_date_gmtï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« å‘è¡¨çš„æ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´ï¼ˆGMTï¼‰ ï¼ˆYYYY-MM-DD HH-MM-SSï¼‰</span><br><span class="line"></span><br><span class="line">post_contentï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« å†…å®¹</span><br><span class="line"></span><br><span class="line">post_titleï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« æ ‡é¢˜</span><br><span class="line"></span><br><span class="line">post_categoryï¼šï¼ˆæ•´æ•°ï¼‰æ–‡ç« ç±»åˆ«çš„ç¼–å·ã€‚æ³¨æ„ï¼šè¯¥å€¼åœ¨WordPress 2.1ä¹‹åçš„ç‰ˆæœ¬æ€»ä¸º0ã€‚å®šä¹‰æ–‡ç« çš„ç±»åˆ«æ—¶å¯ä½¿ç”¨ get_the_categoryï¼ˆï¼‰å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">post_excerptï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« æ‘˜è¦</span><br><span class="line"></span><br><span class="line">post_statusï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« çŠ¶æ€ï¼ˆpublish|pending|draft|private|static|object|attachment|inherit|futureï¼‰</span><br><span class="line"></span><br><span class="line">comment_statusï¼šï¼ˆå­—ç¬¦ï¼‰è¯„è®ºçŠ¶æ€ï¼ˆopen|closed|registered_onlyï¼‰</span><br><span class="line"></span><br><span class="line">ping_statusï¼šï¼ˆå­—ç¬¦ï¼‰pingback/trackbackçŠ¶æ€ï¼ˆopen|closedï¼‰</span><br><span class="line"></span><br><span class="line">post_passwordï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« å¯†ç </span><br><span class="line"></span><br><span class="line">post_nameï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« çš„URLåµŒå¥—</span><br><span class="line"></span><br><span class="line">to_pingï¼šï¼ˆå­—ç¬¦ï¼‰è¦å¼•ç”¨çš„URLé“¾æ¥</span><br><span class="line"></span><br><span class="line">pingedï¼šï¼ˆå­—ç¬¦ï¼‰å¼•ç”¨è¿‡çš„é“¾æ¥</span><br><span class="line"></span><br><span class="line">post_modifiedï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« æœ€åä¿®æ”¹æ—¶é—´ï¼ˆYYYY-MM-DD HH-MM-SSï¼‰</span><br><span class="line"></span><br><span class="line">post_modified_gmtï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« æœ€åä¿®æ”¹GMTæ—¶é—´ï¼ˆYYYY-MM-DD HH-MM-SSï¼‰</span><br><span class="line"></span><br><span class="line">post_parentï¼šï¼ˆæ•´æ•°ï¼‰çˆ¶çº§æ–‡ç« ç¼–å·ï¼ˆä¾›é™„ä»¶ç­‰ï¼‰</span><br><span class="line"></span><br><span class="line">guidï¼šï¼ˆå­—ç¬¦ï¼‰æ–‡ç« çš„ä¸€ä¸ªé“¾æ¥ã€‚æ³¨æ„ï¼šä¸èƒ½å°†GUIDä½œä¸ºæ°¸ä¹…é“¾æ¥ï¼ˆè™½ç„¶åœ¨2.5ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å®ƒçš„ç¡®è¢«å½“ä½œæ°¸ä¹…é“¾æ¥ï¼‰ï¼Œä¹Ÿä¸èƒ½å°†å®ƒä½œä¸ºæ–‡ç« çš„å¯ç”¨é“¾æ¥ã€‚GUIDæ˜¯ä¸€ç§ç‹¬æœ‰çš„æ ‡è¯†ç¬¦ï¼Œåªæ˜¯ç›®å‰æ°å·§æˆä¸ºæ–‡ç« çš„ä¸€ä¸ªé“¾æ¥ã€‚</span><br><span class="line"></span><br><span class="line">post_typeï¼šï¼ˆå­—ç¬¦ï¼‰ï¼ˆæ—¥å¿— | é¡µé¢ | é™„ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line">post_mime_typeï¼šï¼ˆå­—ç¬¦ï¼‰Mimeç±»å‹ï¼ˆä¾›é™„ä»¶ç­‰ï¼‰</span><br><span class="line"></span><br><span class="line">comment_countï¼šï¼ˆæ•´æ•°ï¼‰è¯„è®ºæ€»æ•°</span><br></pre></td></tr></table></figure><p></p><p>åŸæ–‡é“¾æ¥:<br><a href="http://www.cleey.com/blog/single/id/508.html" title="WordPressè·å–æ–‡ç« æ‰€æœ‰ä¿¡æ¯" target="_blank" rel="noopener">WordPressè·å–æ–‡ç« æ‰€æœ‰ä¿¡æ¯</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆå¾—å¾—çŸ¥å½“å‰è¯·æ±‚çš„æ–‡ç« IDï¼š&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="WordPress" scheme="https://hexo.lilis.xin/tags/WordPress/"/>
    
  </entry>
  
  <entry>
    <title>centosä¿®æ”¹Hostname</title>
    <link href="https://hexo.lilis.xin/posts/e0a8795/"/>
    <id>https://hexo.lilis.xin/posts/e0a8795/</id>
    <published>2018-08-20T03:31:34.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<p>hostnameä¸»è¦ç”¨äºåŒºåˆ†è‡ªå·±æ‰€è¿æ¥çš„æœåŠ¡å™¨<br>å½“è‡ªå·±è¿æ¥åœ¨å¤šå°æœåŠ¡å™¨æ˜¯ä¸è‡³äºåªèƒ½çœ‹ipåŒºåˆ†æœåŠ¡å™¨<br><a id="more"></a><br>ä¸´æ—¶ä¿®æ”¹hostname:<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname lilis</span><br></pre></td></tr></table></figure><p></p><p>æ°¸ä¹…ä¿®æ”¹hostname<br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿®æ”¹æˆ–æ·»åŠ </span></span><br><span class="line"> HOSTNAME=lilis</span><br></pre></td></tr></table></figure><p></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hostnameä¸»è¦ç”¨äºåŒºåˆ†è‡ªå·±æ‰€è¿æ¥çš„æœåŠ¡å™¨&lt;br&gt;å½“è‡ªå·±è¿æ¥åœ¨å¤šå°æœåŠ¡å™¨æ˜¯ä¸è‡³äºåªèƒ½çœ‹ipåŒºåˆ†æœåŠ¡å™¨&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://hexo.lilis.xin/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ps è¿›ç¨‹æŸ¥çœ‹å™¨</title>
    <link href="https://hexo.lilis.xin/posts/f1c6d624/"/>
    <id>https://hexo.lilis.xin/posts/f1c6d624/</id>
    <published>2018-08-17T09:15:39.000Z</published>
    <updated>2019-09-12T06:27:03.598Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ps-è¿›ç¨‹æŸ¥çœ‹å™¨"><a href="#ps-è¿›ç¨‹æŸ¥çœ‹å™¨" class="headerlink" title="ps è¿›ç¨‹æŸ¥çœ‹å™¨"></a>ps è¿›ç¨‹æŸ¥çœ‹å™¨</h2><p>Linuxä¸­çš„pså‘½ä»¤æ˜¯Process Statusçš„ç¼©å†™ã€‚pså‘½ä»¤ç”¨æ¥åˆ—å‡ºç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„é‚£äº›è¿›ç¨‹ã€‚pså‘½ä»¤åˆ—å‡ºçš„æ˜¯å½“å‰é‚£äº›è¿›ç¨‹çš„å¿«ç…§ï¼Œå°±æ˜¯æ‰§è¡Œpså‘½ä»¤çš„é‚£ä¸ªæ—¶åˆ»çš„é‚£äº›è¿›ç¨‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€çš„æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ï¼Œå°±å¯ä»¥ä½¿ç”¨topå‘½ä»¤ã€‚</p><p>è¦å¯¹è¿›ç¨‹è¿›è¡Œç›‘æµ‹å’Œæ§åˆ¶ï¼Œé¦–å…ˆå¿…é¡»è¦äº†è§£å½“å‰è¿›ç¨‹çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯éœ€è¦æŸ¥çœ‹å½“å‰è¿›ç¨‹ï¼Œè€Œ ps å‘½ä»¤å°±æ˜¯æœ€åŸºæœ¬åŒæ—¶ä¹Ÿæ˜¯éå¸¸å¼ºå¤§çš„è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ã€‚ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥ç¡®å®šæœ‰å“ªäº›è¿›ç¨‹æ­£åœ¨è¿è¡Œå’Œè¿è¡Œçš„çŠ¶æ€ã€è¿›ç¨‹æ˜¯å¦ç»“æŸã€è¿›ç¨‹æœ‰æ²¡æœ‰åƒµæ­»ã€å“ªäº›è¿›ç¨‹å ç”¨äº†è¿‡å¤šçš„èµ„æºç­‰ç­‰ã€‚æ€»ä¹‹å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½æ˜¯å¯ä»¥é€šè¿‡æ‰§è¡Œè¯¥å‘½ä»¤å¾—åˆ°çš„ã€‚<br><a id="more"></a></p><p>ps ä¸ºæˆ‘ä»¬æä¾›äº†è¿›ç¨‹çš„ä¸€æ¬¡æ€§çš„æŸ¥çœ‹ï¼Œå®ƒæ‰€æä¾›çš„æŸ¥çœ‹ç»“æœå¹¶ä¸åŠ¨æ€è¿ç»­çš„ï¼›å¦‚æœæƒ³å¯¹è¿›ç¨‹æ—¶é—´ç›‘æ§ï¼Œåº”è¯¥ç”¨ top linuxä¸‹çš„ä»»åŠ¡ç®¡ç†å™¨ å·¥å…·ã€‚</p><p>æ³¨ï¼škill -9 å‘½ä»¤ç”¨äºæ€æ­»è¿›ç¨‹ã€‚<br>åŸæ–‡åœ°å€:<br><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/ps.html" title="ps è¿›ç¨‹æŸ¥çœ‹å™¨" target="_blank" rel="noopener">ps è¿›ç¨‹æŸ¥çœ‹å™¨</a></p><h3 id="linuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€"><a href="#linuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€" class="headerlink" title="linuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€:"></a>linuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€:</h3><p>è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)<br>ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)<br>ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)<br>åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)<br>åœæ­¢(è¿›ç¨‹æ”¶åˆ°SIGSTOP, SIGTSTP, SIGTTIN, SIGTTOUä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)<br>pså·¥å…·æ ‡è¯†è¿›ç¨‹çš„5ç§çŠ¶æ€ç :</p><ol><li>D ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)</li><li>R è¿è¡Œ runnable (on run queue)</li><li>S ä¸­æ–­ sleeping</li><li>T åœæ­¢ traced or stopped</li><li>Z åƒµæ­» a defunct (â€zombieâ€) process<h3 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h3></li><li>a æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</li><li>-a æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹çš„æ‰€æœ‰ç¨‹åº</li><li>-A æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</li><li>c æ˜¾ç¤ºè¿›ç¨‹çš„çœŸå®åç§°</li><li>-N åå‘é€‰æ‹©</li><li>-e ç­‰äºâ€œ-Aâ€</li><li>e æ˜¾ç¤ºç¯å¢ƒå˜é‡</li><li>f æ˜¾ç¤ºç¨‹åºé—´çš„å…³ç³»</li><li>-H æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„</li><li>r æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„è¿›ç¨‹</li><li>T æ˜¾ç¤ºå½“å‰ç»ˆç«¯çš„æ‰€æœ‰ç¨‹åº</li><li>u æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹</li><li>-au æ˜¾ç¤ºè¾ƒè¯¦ç»†çš„èµ„è®¯</li><li>-aux æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹</li><li>-C&lt;å‘½ä»¤&gt; åˆ—å‡ºæŒ‡å®šå‘½ä»¤çš„çŠ¶å†µ</li><li>â€“lines&lt;è¡Œæ•°&gt; æ¯é¡µæ˜¾ç¤ºçš„è¡Œæ•°</li><li>â€“width&lt;å­—ç¬¦æ•°&gt; æ¯é¡µæ˜¾ç¤ºçš„å­—ç¬¦æ•°</li><li>â€“help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</li><li>â€“version æ˜¾ç¤ºç‰ˆæœ¬æ˜¾ç¤º<h3 id="è¾“å‡ºåˆ—çš„å«ä¹‰"><a href="#è¾“å‡ºåˆ—çš„å«ä¹‰" class="headerlink" title="è¾“å‡ºåˆ—çš„å«ä¹‰"></a>è¾“å‡ºåˆ—çš„å«ä¹‰</h3></li><li>F ä»£è¡¨è¿™ä¸ªç¨‹åºçš„æ——æ ‡ (flag)ï¼Œ 4 ä»£è¡¨ä½¿ç”¨è€…ä¸º super user</li><li>S ä»£è¡¨è¿™ä¸ªç¨‹åºçš„çŠ¶æ€ (STAT)ï¼Œå…³äºå„ STAT çš„æ„ä¹‰å°†åœ¨å†…æ–‡ä»‹ç»</li><li>UID ç¨‹åºè¢«è¯¥ UID æ‰€æ‹¥æœ‰</li><li>PID è¿›ç¨‹çš„ID</li><li>PPID åˆ™æ˜¯å…¶ä¸Šçº§çˆ¶ç¨‹åºçš„ID</li><li>C CPU ä½¿ç”¨çš„èµ„æºç™¾åˆ†æ¯”</li><li>PRI è¿™ä¸ªæ˜¯ Priority (ä¼˜å…ˆæ‰§è¡Œåº) çš„ç¼©å†™ï¼Œè¯¦ç»†åé¢ä»‹ç»</li><li>NI è¿™ä¸ªæ˜¯ Nice å€¼ï¼Œåœ¨ä¸‹ä¸€å°èŠ‚æˆ‘ä»¬ä¼šæŒç»­ä»‹ç»</li><li>ADDR è¿™ä¸ªæ˜¯ kernel functionï¼ŒæŒ‡å‡ºè¯¥ç¨‹åºåœ¨å†…å­˜çš„é‚£ä¸ªéƒ¨åˆ†ã€‚å¦‚æœæ˜¯ä¸ª runningçš„ç¨‹åºï¼Œä¸€èˆ¬å°±æ˜¯ â€œ-â€œ</li><li>SZ ä½¿ç”¨æ‰çš„å†…å­˜å¤§å°</li><li>WCHAN ç›®å‰è¿™ä¸ªç¨‹åºæ˜¯å¦æ­£åœ¨è¿ä½œå½“ä¸­ï¼Œè‹¥ä¸º - è¡¨ç¤ºæ­£åœ¨è¿ä½œ</li><li>TTY ç™»å…¥è€…çš„ç»ˆç«¯æœºä½ç½®</li><li>TIME ä½¿ç”¨æ‰çš„ CPU æ—¶é—´ã€‚</li><li>CMD æ‰€ä¸‹è¾¾çš„æŒ‡ä»¤ä¸ºä½•<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><h4 id="æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯"><a href="#æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯" class="headerlink" title="æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯"></a>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps -A</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">    1 ?        00:00:02 systemd</span><br><span class="line">    2 ?        00:00:00 kthreadd</span><br><span class="line">    3 ?        00:00:00 ksoftirqd/0</span><br><span class="line">    5 ?        00:00:00 kworker/0:0H</span><br><span class="line">    7 ?        00:00:00 migration/0</span><br><span class="line">    8 ?        00:00:00 rcu_bh</span><br><span class="line">    9 ?        00:00:03 rcu_sched</span><br><span class="line">   10 ?        00:00:00 lru-add-drain</span><br></pre></td></tr></table></figure></li></ol><h4 id="æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·ä¿¡æ¯"><a href="#æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·ä¿¡æ¯" class="headerlink" title="æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·ä¿¡æ¯"></a>æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·ä¿¡æ¯</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps -u root</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line">    1 ?        00:00:02 systemd</span><br><span class="line">    2 ?        00:00:00 kthreadd</span><br><span class="line">    3 ?        00:00:00 ksoftirqd/0</span><br><span class="line">    5 ?        00:00:00 kworker/0:0H</span><br><span class="line">    7 ?        00:00:00 migration/0</span><br><span class="line">    8 ?        00:00:00 rcu_bh</span><br><span class="line">    9 ?        00:00:03 rcu_sched</span><br><span class="line">   10 ?        00:00:00 lru-add-drain</span><br></pre></td></tr></table></figure><h4 id="æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œè¿åŒå‘½ä»¤è¡Œ"><a href="#æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œè¿åŒå‘½ä»¤è¡Œ" class="headerlink" title="æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œè¿åŒå‘½ä»¤è¡Œ"></a>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œè¿åŒå‘½ä»¤è¡Œ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps -ef</span><br><span class="line">UID        PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">root         1     0  0 Aug16 ?        00:00:02 /usr/lib/systemd/systemd --switched-root --system --deserialize 22</span><br><span class="line">root         2     0  0 Aug16 ?        00:00:00 [kthreadd]</span><br><span class="line">root         3     2  0 Aug16 ?        00:00:00 [ksoftirqd/0]</span><br><span class="line">root         5     2  0 Aug16 ?        00:00:00 [kworker/0:0H]</span><br><span class="line">root         7     2  0 Aug16 ?        00:00:00 [migration/0]</span><br><span class="line">root         8     2  0 Aug16 ?        00:00:00 [rcu_bh]</span><br><span class="line">root         9     2  0 Aug16 ?        00:00:03 [rcu_sched]</span><br><span class="line">root        10     2  0 Aug16 ?        00:00:00 [lru-add-drain]</span><br></pre></td></tr></table></figure><h4 id="ps-ä¸grep-ç»„åˆä½¿ç”¨ï¼ŒæŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹"><a href="#ps-ä¸grep-ç»„åˆä½¿ç”¨ï¼ŒæŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹" class="headerlink" title="ps ä¸grep ç»„åˆä½¿ç”¨ï¼ŒæŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹"></a>ps ä¸grep ç»„åˆä½¿ç”¨ï¼ŒæŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps -ef | grep php</span><br><span class="line">root       899     1  0 Aug16 ?        00:00:03 php-fpm: master process (/usr/local/php/php71/etc/php-fpm.conf)</span><br><span class="line">www        900   899  0 Aug16 ?        00:00:00 php-fpm: pool www</span><br><span class="line">www        901   899  0 Aug16 ?        00:00:00 php-fpm: pool www</span><br><span class="line">root       906     1  0 Aug16 ?        00:00:03 php-fpm: master process (/usr/local/php/php56/etc/php-fpm.conf)</span><br><span class="line">www        907   906  0 Aug16 ?        00:00:00 php-fpm: pool www</span><br><span class="line">www        908   906  0 Aug16 ?        00:00:00 php-fpm: pool www</span><br><span class="line">root      3801     1  0 16:59 ?        00:00:00 php-fpm: master process (/usr/local/php/php72/etc/php-fpm.conf)</span><br><span class="line">www       3803  3801  0 16:59 ?        00:00:01 php-fpm: pool www</span><br><span class="line">www       3908  3801  0 17:02 ?        00:00:01 php-fpm: pool www</span><br><span class="line">www       4137  3801  0 17:08 ?        00:00:00 php-fpm: pool www</span><br><span class="line">root      4173 18277  0 17:09 pts/0    00:00:00 grep --color=auto php</span><br></pre></td></tr></table></figure><h4 id="å°†ä¸è¿™æ¬¡ç™»å…¥çš„-PID-ä¸ç›¸å…³ä¿¡æ¯åˆ—ç¤ºå‡ºæ¥"><a href="#å°†ä¸è¿™æ¬¡ç™»å…¥çš„-PID-ä¸ç›¸å…³ä¿¡æ¯åˆ—ç¤ºå‡ºæ¥" class="headerlink" title="å°†ä¸è¿™æ¬¡ç™»å…¥çš„ PID ä¸ç›¸å…³ä¿¡æ¯åˆ—ç¤ºå‡ºæ¥"></a>å°†ä¸è¿™æ¬¡ç™»å…¥çš„ PID ä¸ç›¸å…³ä¿¡æ¯åˆ—ç¤ºå‡ºæ¥</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps -l</span><br><span class="line">F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD</span><br><span class="line">0 R     0  4334 18277  0  80   0 - 38292 -      pts/0    00:00:00 ps</span><br><span class="line">4 S     0 18277 18275  0  80   0 - 28892 do_wai pts/0    00:00:00 bash</span><br></pre></td></tr></table></figure><h4 id="åˆ—å‡ºç›®å‰æ‰€æœ‰çš„æ­£åœ¨å†…å­˜ä¸­çš„ç¨‹åº"><a href="#åˆ—å‡ºç›®å‰æ‰€æœ‰çš„æ­£åœ¨å†…å­˜ä¸­çš„ç¨‹åº" class="headerlink" title="åˆ—å‡ºç›®å‰æ‰€æœ‰çš„æ­£åœ¨å†…å­˜ä¸­çš„ç¨‹åº"></a>åˆ—å‡ºç›®å‰æ‰€æœ‰çš„æ­£åœ¨å†…å­˜ä¸­çš„ç¨‹åº</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# ps aux</span><br><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root         1  0.0  0.2  43416  2500 ?        Ss   Aug16   0:02 /usr/lib/systemd/systemd --switched-root --system --deserialize 22</span><br><span class="line">root         2  0.0  0.0      0     0 ?        S    Aug16   0:00 [kthreadd]</span><br><span class="line">root         3  0.0  0.0      0     0 ?        S    Aug16   0:00 [ksoftirqd/0]</span><br><span class="line">root         5  0.0  0.0      0     0 ?        S&lt;   Aug16   0:00 [kworker/0:0H]</span><br><span class="line">root         7  0.0  0.0      0     0 ?        S    Aug16   0:00 [migration/0]</span><br><span class="line">root         8  0.0  0.0      0     0 ?        S    Aug16   0:00 [rcu_bh]</span><br><span class="line">root         9  0.0  0.0      0     0 ?        R    Aug16   0:03 [rcu_sched]</span><br><span class="line">root        10  0.0  0.0      0     0 ?        S&lt;   Aug16   0:00 [lru-add-drain]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ps-è¿›ç¨‹æŸ¥çœ‹å™¨&quot;&gt;&lt;a href=&quot;#ps-è¿›ç¨‹æŸ¥çœ‹å™¨&quot; class=&quot;headerlink&quot; title=&quot;ps è¿›ç¨‹æŸ¥çœ‹å™¨&quot;&gt;&lt;/a&gt;ps è¿›ç¨‹æŸ¥çœ‹å™¨&lt;/h2&gt;&lt;p&gt;Linuxä¸­çš„pså‘½ä»¤æ˜¯Process Statusçš„ç¼©å†™ã€‚pså‘½ä»¤ç”¨æ¥åˆ—å‡ºç³»ç»Ÿä¸­å½“å‰è¿è¡Œçš„é‚£äº›è¿›ç¨‹ã€‚pså‘½ä»¤åˆ—å‡ºçš„æ˜¯å½“å‰é‚£äº›è¿›ç¨‹çš„å¿«ç…§ï¼Œå°±æ˜¯æ‰§è¡Œpså‘½ä»¤çš„é‚£ä¸ªæ—¶åˆ»çš„é‚£äº›è¿›ç¨‹ï¼Œå¦‚æœæƒ³è¦åŠ¨æ€çš„æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ï¼Œå°±å¯ä»¥ä½¿ç”¨topå‘½ä»¤ã€‚&lt;/p&gt;&lt;p&gt;è¦å¯¹è¿›ç¨‹è¿›è¡Œç›‘æµ‹å’Œæ§åˆ¶ï¼Œé¦–å…ˆå¿…é¡»è¦äº†è§£å½“å‰è¿›ç¨‹çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯éœ€è¦æŸ¥çœ‹å½“å‰è¿›ç¨‹ï¼Œè€Œ ps å‘½ä»¤å°±æ˜¯æœ€åŸºæœ¬åŒæ—¶ä¹Ÿæ˜¯éå¸¸å¼ºå¤§çš„è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ã€‚ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥ç¡®å®šæœ‰å“ªäº›è¿›ç¨‹æ­£åœ¨è¿è¡Œå’Œè¿è¡Œçš„çŠ¶æ€ã€è¿›ç¨‹æ˜¯å¦ç»“æŸã€è¿›ç¨‹æœ‰æ²¡æœ‰åƒµæ­»ã€å“ªäº›è¿›ç¨‹å ç”¨äº†è¿‡å¤šçš„èµ„æºç­‰ç­‰ã€‚æ€»ä¹‹å¤§éƒ¨åˆ†ä¿¡æ¯éƒ½æ˜¯å¯ä»¥é€šè¿‡æ‰§è¡Œè¯¥å‘½ä»¤å¾—åˆ°çš„ã€‚&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
