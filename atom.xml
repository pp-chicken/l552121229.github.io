<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>éª‘åœ¨å¢™ä¸Šã®åšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://hexo.lilis.xin/"/>
  <updated>2021-02-08T09:19:03.305Z</updated>
  <id>https://hexo.lilis.xin/</id>
  
  <author>
    <name>ğŸ£</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HTML-é¡µé¢åµŒå…¥æµ‹è¯•</title>
    <link href="https://hexo.lilis.xin/posts/2649187286/"/>
    <id>https://hexo.lilis.xin/posts/2649187286/</id>
    <published>2021-02-06T00:33:52.000Z</published>
    <updated>2021-02-08T09:19:03.305Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ"><a class="header-anchor" href="#è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ">â¡ï¸</a>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ</h2><a id="more"></a><div class="iframeContentBody" data-iframe-src="./embed_page/" data-iframe-ismobile="true" data-iframe-title="åˆæˆå¤§è¥¿ç“œï¼ˆé­”æ”¹ç‰ˆï¼‰"></div><div class="iframeContentBody" data-iframe-src="https://www.bing.com/" data-iframe-ismobile="false" data-iframe-title="å¿…åº”"></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ&quot;&gt;â¡ï¸&lt;/a&gt;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡µé¢ï¼Œæµ‹è¯•iframeæ ‡ç­¾æ•ˆæœ&lt;/h2&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CentOS 7å®‰è£…TCP BBRæ‹¥å¡ç®—æ³•</title>
    <link href="https://hexo.lilis.xin/posts/907e528c/"/>
    <id>https://hexo.lilis.xin/posts/907e528c/</id>
    <published>2019-09-21T23:27:38.000Z</published>
    <updated>2019-09-24T06:27:49.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h4 id="è®¤è¯†BBRæ‹¥å¡ç®—æ³•"><a class="header-anchor" href="#è®¤è¯†BBRæ‹¥å¡ç®—æ³•">â¡ï¸</a>è®¤è¯†BBRæ‹¥å¡ç®—æ³•</h4><p>ä» 4.9 å¼€å§‹ï¼ŒLinux å†…æ ¸å·²ç»ç”¨ä¸Šäº†è¯¥ç®—æ³•ã€‚æ ¹æ®ä»¥å¾€çš„ä¼ ç»Ÿï¼ŒGoogle æ€»æ˜¯å…ˆåœ¨è‡ªå®¶çš„ç”Ÿäº§ç¯å¢ƒä¸Šçº¿è¿ç”¨åï¼Œæ‰ä¼šå°†ä»£ç å¼€æºï¼Œæ­¤æ¬¡ä¹Ÿä¸ä¾‹å¤–ã€‚<br>æ ¹æ®å®åœ°æµ‹è¯•ï¼Œåœ¨éƒ¨ç½²äº†æœ€æ–°ç‰ˆå†…æ ¸å¹¶å¼€å¯äº† TCP BBR çš„æœºå™¨ä¸Šï¼Œç½‘é€Ÿç”šè‡³å¯ä»¥æå‡å¥½å‡ ä¸ªæ•°é‡çº§ã€‚</p><a id="more"></a><p><code>TCP BBRæ‹¥å¡ç®—æ³•</code>è‡´åŠ›äºè§£å†³ä¸¤ä¸ªé—®é¢˜:</p><ol><li>åœ¨æœ‰ä¸€å®šä¸¢åŒ…ç‡çš„ç½‘ç»œé“¾è·¯ä¸Šå……åˆ†åˆ©ç”¨å¸¦å®½ã€‚</li><li>é™ä½ç½‘ç»œé“¾è·¯ä¸Šçš„ buffer å ç”¨ç‡ï¼Œä»è€Œé™ä½å»¶è¿Ÿã€‚</li></ol><p>åœ¨æ ‡å‡†<code>TCP</code>é€šè®¯çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†å……åˆ†åˆ©ç”¨å¸¦å®½æ‰€é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ï¼šä¸æ–­å¢åŠ å‘é€çª—å£ï¼Œç›´åˆ°å¼€å§‹ä¸¢åŒ…ï¼Œç„¶åè¾ƒå¿«åœ°å‡å°å‘é€çª—å£ã€‚<br>è¿™ç§åšæ³•åœ¨ä¸€èˆ¬æƒ…å†µä¸‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨å­˜åœ¨ä¼ è¾“é”™è¯¯å¯¼è‡´çš„ä¸¢åŒ…åœ°æƒ…å†µä¸‹å°±æ²¡é‚£ä¹ˆå¥½ä½¿äº†ã€‚<br>åœ¨æœ‰ä¸€å®šçš„ä¸¢åŒ…ç‡çš„å»¶è¿Ÿé«˜ã€å®½å¸¦å¤§çš„é“¾è·¯ä¸Šæ ‡å‡†çš„<code>TCPæ‹¥å¡æ§åˆ¶</code>å°±ä¼šæŠŠå‘é€çª—å£æ”¶æ•›åˆ°å¾ˆå°ã€‚<br>åŒæ—¶åœ¨ç½‘ç»œä¸­ä¹Ÿæœ‰å¾ˆå¤šç¼“å­˜ç©ºé—´ç”¨æ¥å¸æ”¶ç½‘ç»œä¸­çš„æµé‡æ³¢åŠ¨ã€‚ç”±äºæ ‡å‡†çš„<code>TCPæ‹¥å¡æ§åˆ¶</code>æ˜¯é€šè¿‡çŒæ»¡å¸¦å®½çš„æ–¹å¼æ¥ä¼°ç®—éœ€è¦çš„å‘é€çª—å£çš„ï¼Œåœ¨è¿æ¥çš„å¼€å§‹é˜¶æ®µï¼Œç½‘ç»œä¸­çš„ç¼“å­˜ç©ºé—´å°±å€¾å‘äºè¢«å æ»¡ã€‚åç»­ç¼“å­˜ç©ºé—´ä¼šè¢«é€æ¸é‡Šæ”¾ï¼Œä½†å¹¶ä¸ä¼šæ¶ˆå¤±ã€‚å®¢æˆ·ç«¯ä¼°è®¡çš„æ°´ç®¡å®¹ç§¯æ€»æ˜¯ç•¥å¤§äºç½‘ç»œä¸­é™¤å»ç¼“å­˜ç©ºé—´çš„å®é™…å®¹é‡ã€‚è¿™ä¸ªé—®é¢˜åˆè¢«ç§°ä¹‹ä¸º<code>ç¼“å­˜åŒºè†¨èƒ€</code>ã€‚<br><code>ç¼“å­˜åŒºè†¨èƒ€</code>ä¸»è¦å¸¦æ¥äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¢åŠ ç½‘ç»œå»¶è¿Ÿã€‚</li><li>åœ¨è¿æ¥æ•°è¾ƒå¤šæ—¶å®¹æ˜“å¯¼è‡´ç¼“å­˜åŒºè¢«å¡«æ»¡å¯¼è‡´ä¸¢åŒ…ã€‚</li></ol><p><code>TCP BBR</code>æ˜¯ç”¨ä»¥ä¸‹æ–¹æ³•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„ï¼š</p><ol><li>æ—¢ç„¶åˆ†ä¸æ¸…æ‹¥å¡ä¸¢åŒ…å’Œé”™è¯¯ä¸¢åŒ…é‚£å°±ä¸è€ƒè™‘ä¸¢åŒ…é—®é¢˜ã€‚</li><li>æ—¢ç„¶ç®¡æ»¡æ°´ç®¡ä¼šå¯¼è‡´ç¼“å­˜åŒºè†¨èƒ€é‚£å°±ä¼°è®¡å¸¦å®½å’Œå»¶è¿Ÿï¼Œä¸ç›´æ¥ä¼°è®¡æ°´ç®¡ä½“ç§¯ã€‚</li></ol><p>å¸¦å®½å’Œå»¶è¿Ÿæœ¬èº«æ˜¯æ²¡æ³•åŒæ—¶æµ‹é‡çš„ï¼Œæµ‹é‡æœ€å¤§å¸¦å®½å°±éœ€è¦æŠŠç¼“å­˜åŒºå¡«æ»¡ï¼Œæµ‹é‡æœ€ä½å»¶è¿Ÿå°±éœ€è¦æŠŠç¼“å­˜åŒºæ¸…ç©ºã€‚<code>TCP BBR</code>æ‰€é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯äº¤æ›¿æµ‹é‡ï¼Œç”¨ä¸€æ®µæ—¶é—´å†…çš„æœ€å¤§å¸¦å®½å’Œå¦ä¸€æ®µæ—¶é—´å†…çš„æœ€ä½å»¶è¿Ÿä½œä¸ºä¼°è®¡å€¼ã€‚<br>åœ¨è¿æ¥åˆšå¼€å§‹å»ºç«‹æ—¶ï¼Œå®ƒé‡‡ç”¨äº†å’Œæ ‡å‡†<code>TCP</code>ç±»ä¼¼çš„æ…¢å¯åŠ¨ï¼ŒæŒ‡æ•°å¢é•¿å‘é€é€Ÿç‡ã€‚è€Œæ ‡å‡†çš„<code>TCPæ‹¥å¡æ§åˆ¶</code>ä¼šåœ¨é‡åˆ°ä»»ä½•ä¸€ä¸ªä¸¢åŒ…å°±ç«‹åˆ»å¼€å§‹å‡é€Ÿï¼Œå¼€å§‹æ‹¥å¡é¿å…ã€‚è¿™æ—¶ï¼Œæ ‡å‡†<code>TCPæ‹¥å¡æ§åˆ¶</code>æœ¬æ„æ˜¯è¾¾åˆ°å¸¦å®½çš„æœ€å¤§å€¼å¼€å§‹è¿›è¡Œç½‘ç»œæ§åˆ¶ï¼Œä½†æ˜¯åœ¨æœ‰ä¸€å®šçš„ä¸¢åŒ…ç‡çš„æƒ…å†µä¸‹ä¹Ÿæœ‰å¯èƒ½æ˜¯å•çº¯çš„ç½‘ç»œä¸¢åŒ…ï¼Œè¿™æ—¶ç½‘ç»œå¹¶æ²¡æœ‰è¾¾åˆ°å¸¦å®½çš„æœ€å¤§å€¼ï¼›å¦‚æœç½‘ç»œä¸­å­˜åœ¨ç¼“å­˜åŒºï¼Œå®ƒä¹Ÿä¼šä¸€ç›´åˆ°æŠŠç¼“å­˜åŒºå¡«æ»¡æ‰ä¼šæ”¾å¼ƒã€‚<br><code>TCP BBR</code>åˆ™æ˜¯æ ¹æ®æ”¶åˆ°çš„ç¡®è®¤åŒ…ï¼Œå‘ç°æœ‰æ•ˆå¸¦å®½ä¸å†å¢é•¿æ—¶å¼€å§‹æ‹¥å¡é¿å…ã€‚è¿™æ—¶ï¼Œåªè¦é“¾è·¯çš„ä¸¢åŒ…ç‡ä¸ç®—ç‰¹åˆ«é«˜ï¼Œå¯¹<code>BBR</code>å°±å‡ ä¹æ²¡ä»€ä¹ˆå½±å“ï¼›å½“å‘é€é€Ÿç‡å¢é•¿åˆ°å¼€å§‹å ç”¨ç¼“å­˜åŒºæ—¶ï¼ˆè¿™æ—¶å¯ä»¥é€šè¿‡å»¶è¿Ÿçš„å¢åŠ åˆ¤æ–­å‡ºæ¥ï¼‰ï¼Œ<code>BBR</code>å°±åŠæ—¶çš„æ”¾å¼ƒäº†ï¼ˆè¿™æ—¶å ç”¨çš„æ˜¯3å€å¸¦å®½ï¼Œç›¸å½“äºæœ‰2å€åœ¨å ç”¨ç¼“å­˜åŒºï¼Œä½†<code>BBR</code>æœ¬èº«è¿˜æœ‰ä¸€ä¸ªæ’ç©ºé˜¶æ®µï¼Œåœ¨æ’ç©ºé˜¶æ®µä¸‹å®ƒä¼šæŒ‡æ•°é™ä½å‘é€é€Ÿç‡ï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šæŠŠç¼“å­˜åŒºå æ»¡ã€‚<br>æ’ç©ºé˜¶æ®µè¿‡åå°±æ˜¯ç¨³å®šè¿è¡ŒçŠ¶æ€ï¼Œäº¤æ›¿æ¢æµ‹å¸¦å®½å’Œå»¶è¿Ÿï¼Œä»¥æ­¤æ¥ä½œä¸ºåŸºå‡†è¿›è¡Œå‘åŒ…ã€‚</p><a href="#">Post not found: https://www.zhihu.com/question/53559433 Linux Kernel 4.9 ä¸­çš„ BBR ç®—æ³•ä¸ä¹‹å‰çš„ TCP æ‹¥å¡æ§åˆ¶ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</a><h4 id="å®‰è£…TCP-BBRæ‹¥å¡ç®—æ³•"><a class="header-anchor" href="#å®‰è£…TCP-BBRæ‹¥å¡ç®—æ³•">â¡ï¸</a>å®‰è£…TCP BBRæ‹¥å¡ç®—æ³•</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/redhat-release #æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼Œè¾“å‡ºçš„releaseæ•°å€¼å¤§äº7.3å³å¯ã€‚</span><br></pre></td></tr></table></figure><ol><li>è‡ªåŠ¨å®‰è£…ï¼Œä½¿ç”¨ä¸€é”®å®‰è£…è„šæœ¬</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh</span><br></pre></td></tr></table></figure><ol start="2"><li>æ‰‹åŠ¨å®‰è£…</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨ä¸‹é¢å‘½ä»¤å®‰è£…elrepoå¹¶å‡çº§å†…æ ¸</span></span><br><span class="line">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span><br><span class="line">rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</span><br><span class="line">yum --enablerepo=elrepo-kernel install kernel-ml -y</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ›´æ–°grubæ–‡ä»¶å¹¶é‡å¯ï¼ˆrebootåï¼Œsshä¼šæ–­å¼€ï¼Œç¨ç­‰ä¸€ä¼šå„¿é‡æ–°è¿æ¥ï¼‰</span></span><br><span class="line">egrep ^menuentry /etc/grub2.cfg | cut -f 2 -d \&#x27;</span><br><span class="line">grub2-set-default 0</span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br><span class="line">reboot</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€æœºåæŸ¥çœ‹å†…æ ¸æ˜¯å¦å·²ç»å‡çº§</span></span><br><span class="line">uname -r</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨BBR</span></span><br><span class="line">echo &quot;net.core.default_qdisc = fq&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class="line">echo &quot;net.ipv4.tcp_congestion_control = bbr&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class="line">sysctl -p </span><br></pre></td></tr></table></figure><p>éªŒè¯bbræ˜¯å¦å·²ç»å¼€å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.tcp_available_congestion_control #éªŒè¯å½“å‰TCPæ§åˆ¶ç®—æ³•çš„å‘½ä»¤</span><br><span class="line">sysctl net.ipv4.tcp_congestion_control #éªŒè¯BBRæ˜¯å¦å·²ç»å¯åŠ¨</span><br><span class="line">lsmod | grep bbr #è¿”å›å€¼æœ‰ tcp_bbr æ¨¡å—å³è¯´æ˜ bbr å·²å¯åŠ¨ã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;è®¤è¯†BBRæ‹¥å¡ç®—æ³•&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#è®¤è¯†BBRæ‹¥å¡ç®—æ³•&quot;&gt;â¡ï¸&lt;/a&gt;è®¤è¯†BBRæ‹¥å¡ç®—æ³•&lt;/h4&gt;
&lt;p&gt;ä» 4.9 å¼€å§‹ï¼ŒLinux å†…æ ¸å·²ç»ç”¨ä¸Šäº†è¯¥ç®—æ³•ã€‚æ ¹æ®ä»¥å¾€çš„ä¼ ç»Ÿï¼ŒGoogle æ€»æ˜¯å…ˆåœ¨è‡ªå®¶çš„ç”Ÿäº§ç¯å¢ƒä¸Šçº¿è¿ç”¨åï¼Œæ‰ä¼šå°†ä»£ç å¼€æºï¼Œæ­¤æ¬¡ä¹Ÿä¸ä¾‹å¤–ã€‚&lt;br&gt;
æ ¹æ®å®åœ°æµ‹è¯•ï¼Œåœ¨éƒ¨ç½²äº†æœ€æ–°ç‰ˆå†…æ ¸å¹¶å¼€å¯äº† TCP BBR çš„æœºå™¨ä¸Šï¼Œç½‘é€Ÿç”šè‡³å¯ä»¥æå‡å¥½å‡ ä¸ªæ•°é‡çº§ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://hexo.lilis.xin/tags/Linux/"/>
    
      <category term="CentOS" scheme="https://hexo.lilis.xin/tags/CentOS/"/>
    
      <category term="TCP" scheme="https://hexo.lilis.xin/tags/TCP/"/>
    
      <category term="BBR" scheme="https://hexo.lilis.xin/tags/BBR/"/>
    
      <category term="æ‹¥å¡ç®—æ³•" scheme="https://hexo.lilis.xin/tags/%E6%8B%A5%E5%A1%9E%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Dockerå­¦ä¹ ç¬”è®°</title>
    <link href="https://hexo.lilis.xin/posts/6b8adabf/"/>
    <id>https://hexo.lilis.xin/posts/6b8adabf/</id>
    <published>2019-09-20T01:42:31.000Z</published>
    <updated>2019-09-26T03:05:52.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h3 id="äº†è§£-Docker"><a class="header-anchor" href="#äº†è§£-Docker">â¡ï¸</a>äº†è§£ Docker</h3><blockquote><p><code>Docker</code> æœ€åˆæ˜¯ <code>dotCloud</code> å…¬å¸åˆ›å§‹äºº <code>Solomon Hykes</code> åœ¨æ³•å›½æœŸé—´å‘èµ·çš„ä¸€ä¸ªå…¬å¸å†…éƒ¨é¡¹ç›®ï¼Œå®ƒæ˜¯åŸºäº <code>dotCloud</code> å…¬å¸å¤šå¹´äº‘æœåŠ¡æŠ€æœ¯çš„ä¸€æ¬¡é©æ–°ï¼Œå¹¶äº 2013 å¹´ 3 æœˆä»¥ Apache 2.0 æˆæƒåè®®å¼€æºï¼Œä¸»è¦é¡¹ç›®ä»£ç åœ¨ <code>GitHub</code> ä¸Šè¿›è¡Œç»´æŠ¤ã€‚<code>Docker</code> é¡¹ç›®åæ¥è¿˜åŠ å…¥äº† <code>LinuxåŸºé‡‘ä¼š</code>ï¼Œå¹¶æˆç«‹æ¨åŠ¨ å¼€æ”¾å®¹å™¨è”ç›Ÿï¼ˆOCIï¼‰ã€‚</p><a id="more"></a><p><code>Docker</code> è‡ªå¼€æºåå—åˆ°å¹¿æ³›çš„å…³æ³¨å’Œè®¨è®ºï¼Œè‡³ä»Šå…¶ <code>GitHub</code> é¡¹ç›® å·²ç»è¶…è¿‡ 5 ä¸‡ 2 åƒä¸ªæ˜Ÿæ ‡å’Œä¸€ä¸‡å¤šä¸ª <code>fork</code>ã€‚ç”šè‡³ç”±äº <code>Docker</code> é¡¹ç›®çš„ç«çˆ†ï¼Œåœ¨ 2013 å¹´åº•ï¼Œ<code>dotCloud</code> å…¬å¸å†³å®šæ”¹åä¸º <code>Docker</code>ã€‚<code>Docker</code> æœ€åˆæ˜¯åœ¨ <code>Ubuntu 12.04</code> ä¸Šå¼€å‘å®ç°çš„ï¼›<code>Red Hat</code> åˆ™ä» <code>RHEL 6.5</code> å¼€å§‹å¯¹ <code>Docker</code> è¿›è¡Œæ”¯æŒï¼›<code>Google</code> ä¹Ÿåœ¨å…¶ <code>PaaS</code> äº§å“ä¸­å¹¿æ³›åº”ç”¨ <code>Docker</code>ã€‚<br><code>Docker</code> ä½¿ç”¨ <code>Google</code> å…¬å¸æ¨å‡ºçš„ <code>Go</code> è¯­è¨€ è¿›è¡Œå¼€å‘å®ç°ï¼ŒåŸºäº <code>Linux</code> å†…æ ¸çš„ <code>cgroup</code>ï¼Œ<code>namespace</code>ï¼Œä»¥åŠ <code>AUFS</code> ç±»çš„ <code>Union FS</code> ç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±äº æ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ç”±äºéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿›ç¨‹ï¼Œå› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚æœ€åˆå®ç°æ˜¯åŸºäº <code>LXC</code>ï¼Œä» <code>0.7</code> ç‰ˆæœ¬ä»¥åå¼€å§‹å»é™¤ <code>LXC</code>ï¼Œè½¬è€Œä½¿ç”¨è‡ªè¡Œå¼€å‘çš„ <code>libcontainer</code>ï¼Œä» <code>1.11</code> å¼€å§‹ï¼Œåˆ™è¿›ä¸€æ­¥æ¼”è¿›ä¸ºä½¿ç”¨ <code>runC</code> å’Œ <code>containerd</code>ã€‚</p><footer><strong>Docker â€” ä»å…¥é—¨åˆ°å®è·µ</strong><cite><a href="https://yeasy.gitbooks.io/docker_practice/introduction/what.html">ä»€ä¹ˆæ˜¯ Docker</a></cite></footer></blockquote><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/84118f50.png " class="full-image" title="Docker æ¶æ„"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><h3 id="Docker-ç”Ÿå‘½å‘¨æœŸ"><a class="header-anchor" href="#Docker-ç”Ÿå‘½å‘¨æœŸ">â¡ï¸</a>Docker ç”Ÿå‘½å‘¨æœŸ</h3><p>Docker åŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µ</p><ul><li>é•œåƒï¼ˆImageï¼‰</li><li>å®¹å™¨ï¼ˆContainerï¼‰</li><li>ä»“åº“ï¼ˆRepositoryï¼‰</li></ul><p>å®¹å™¨æ˜¯ç”±é•œåƒå®ä¾‹åŒ–è€Œæ¥çš„ï¼Œå¯ä»¥ç†è§£æˆå®¹å™¨æ˜¯é•œåƒçš„åŸºç¡€å¤‡ä»½ï¼Œå½“Dockerå®ä¾‹åŒ–ä¸€ä¸ªå®¹å™¨æ—¶ï¼Œç›¸å½“äºæŠŠè¿™ä¸ªé•œåƒå¤‡ä»½ä¸€ä»½ï¼Œç„¶ååœ¨è¿™ä¸ªå¤‡ä»½çš„åŸºç¡€ä¸Šå¯åŠ¨ï¼Œå¼€å§‹å„ç§æ“ä½œã€‚<br>æˆ‘ä»¬å¯ä»¥æŠŠé•œåƒæƒ³è±¡æˆç±»,æŠŠå®¹å™¨æƒ³è±¡æˆç±»ç»è¿‡å®ä¾‹åŒ–åçš„å¯¹è±¡ã€‚</p><h4 id="Docker-é•œåƒ"><a class="header-anchor" href="#Docker-é•œåƒ">â¡ï¸</a>Docker é•œåƒ</h4><p><code>Docker</code>çš„é•œåƒæ¦‚å¿µç±»ä¼¼äºè™šæ‹Ÿæœºé‡Œçš„é•œåƒï¼Œæ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ï¼Œä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬è¿è¡Œå®¹å™¨æ‰€éœ€çš„æ•°æ®ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„å®¹å™¨ã€‚<br>ä¾‹å¦‚ï¼šä¸€ä¸ªé•œåƒå¯ä»¥åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ ubuntu æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œé‡Œé¢ä»…å®‰è£…äº†Mysqlæˆ–ç”¨æˆ·éœ€è¦çš„å…¶å®ƒåº”ç”¨ç¨‹åºã€‚<br><code>Docker</code>çš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸ºUnionFSã€‚é•œåƒå¯ä»¥åŸºäº<code>Dockerfile</code>æ„å»ºï¼Œ<code>Dockerfile</code>æ˜¯ä¸€ä¸ªæè¿°æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«è‹¥å¹²æ¡å‘½ä»¤ï¼Œæ¯æ¡å‘½ä»¤éƒ½ä¼šå¯¹åŸºç¡€æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºæ–°çš„å±‚æ¬¡ç»“æ„ã€‚<br><code>Docker</code>æä¾›äº†ä¸€ä¸ªå¾ˆç®€å•çš„æœºåˆ¶æ¥åˆ›å»ºé•œåƒæˆ–è€…æ›´æ–°ç°æœ‰çš„é•œåƒï¼Œç”¨æˆ·ç”šè‡³å¯ä»¥ç›´æ¥ä»å…¶ä»–äººé‚£é‡Œä¸‹è½½ä¸€ä¸ªå·²ç»åšå¥½çš„é•œåƒæ¥ç›´æ¥ä½¿ç”¨ã€‚</p><div class="note info"><p>æ³¨ï¼šé•œåƒæ˜¯åªè¯»çš„ï¼Œå¯ä»¥ç†è§£ä¸ºé™æ€æ–‡ä»¶ã€‚</p></div><p>é•œåƒæ˜¯ä¸€å †<code>åªè¯»å±‚ï¼ˆread-only layerï¼‰</code>çš„ç»Ÿä¸€è§†è§’ï¼Œé‚£äº›<code>åªè¯»å±‚</code>é‡å åœ¨ä¸€èµ·ã€‚é™¤äº†æœ€ä¸‹é¢ä¸€å±‚ï¼Œå…¶å®ƒå±‚éƒ½ä¼šæœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€å±‚ã€‚è¿™äº›å±‚æ˜¯<code>Docker</code>å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨ä¸»æœºï¼ˆè¿è¡Œ<code>Docker</code>çš„æœºå™¨ï¼‰çš„æ–‡ä»¶ç³»ç»Ÿä¸Šè®¿é—®åˆ°ã€‚<code>ç»Ÿä¸€æ–‡ä»¶ç³»ç»Ÿï¼ˆunion file systemï¼‰</code>æŠ€æœ¯èƒ½å¤Ÿå°†ä¸åŒçš„å±‚æ•´åˆæˆä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä¸ºè¿™äº›å±‚æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è§†è§’ï¼Œè¿™æ ·å°±éšè—äº†å¤šå±‚çš„å­˜åœ¨ï¼Œåœ¨ç”¨æˆ·çš„è§’åº¦çœ‹æ¥ï¼Œåªå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚</p><div class="note info"><p>æ³¨ï¼š<code>Docker</code>åœ¨linuxä¸Šå…±äº«å†…æ ¸ï¼Œæ— éœ€è™šæ‹ŸåŒ–ï¼Œå®Œå…¨æ”¯æŒnativeåŠŸèƒ½ã€‚<br><code>Docker</code>åœ¨windowsä¸Šï¼Œå¯ç”¨<code>Hyper-V</code>æˆ–è€…<code>è™šæ‹ŸåŒ–æŠ€æœ¯</code>ï¼Œé€šè¿‡è™šæ‹Ÿæœºæ¥å®ç°ï¼Œä¸å…±äº«windowså†…æ ¸ã€‚<br><code>Docker</code>åœ¨macOSä¸Šï¼ŒåŒæ ·ç”¨è™šæ‹ŸåŒ–æŠ€æœ¯<code>xhyve</code>æˆ–è€…<code>virtualbox</code>æ¥å®ç°ï¼Œä¸å…±äº«macOSå†…æ ¸ã€‚<br>æ‰€ä»¥ï¼Œåœ¨macOSå’ŒWindowsä¸‹æ˜¯æ— æ³•ç›´æ¥è®¿é—®åˆ°é•œåƒçš„æ–‡ä»¶çš„ã€‚</p></div><h4 id="Docker-å®¹å™¨"><a class="header-anchor" href="#Docker-å®¹å™¨">â¡ï¸</a>Docker å®¹å™¨</h4><p><code>Docker</code>åˆ©ç”¨å®¹å™¨æ¥è¿è¡Œåº”ç”¨ã€‚<br><code>å®¹å™¨ï¼ˆcontainerï¼‰</code>å’Œ<code>é•œåƒï¼ˆimageï¼‰</code>çš„å‡ ä¹ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯<code>å®¹å™¨</code>çš„æœ€ä¸Šé¢ä¸€å±‚æ˜¯å¯è¯»å†™çš„</p><div class="note info"><p>æ³¨ï¼šç›¸å¯¹äºé•œåƒæ¥è¯´å®¹å™¨æ˜¯åŠ¨æ€çš„ï¼Œå®¹å™¨åœ¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºä¸€å±‚å¯å†™å±‚ä½œä¸ºæœ€ä¸Šå±‚ã€‚<br>å®¹å™¨çš„å®šä¹‰å¹¶æ²¡æœ‰æåŠå®¹å™¨æ˜¯å¦åœ¨è¿è¡Œã€‚</p></div><h5 id="Running-Container-Definition"><a class="header-anchor" href="#Running-Container-Definition">â¡ï¸</a>Running Container Definition</h5><p>ä¸€ä¸ª<code>è¿è¡Œæ€å®¹å™¨ï¼ˆrunning containerï¼‰</code>è¢«å®šä¹‰ä¸ºä¸€ä¸ªå¯è¯»å†™çš„ç»Ÿä¸€æ–‡ä»¶ç³»ç»ŸåŠ ä¸Šéš”ç¦»çš„è¿›ç¨‹ç©ºé—´å’ŒåŒ…å«å…¶ä¸­çš„è¿›ç¨‹ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/1ccc2aa9e11e25e5ed2efd18cf1052c4.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p>ä¸€ä¸ªå®¹å™¨ä¸­çš„è¿›ç¨‹å¯¹ç€ä¸ªå®¹å™¨é‡Œçš„æ–‡ä»¶è¿›è¡Œå¢åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹æ“ä½œéƒ½å°†ä½œç”¨äºå®¹å™¨ä¸­æœ€ä¸Šé¢çš„é‚£ä¸€å±‚å¯è¯»å†™å±‚ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/a20b70e3e4ca61faa2c3436e1bb2d93a.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><h5 id="Image-Layer-Definition"><a class="header-anchor" href="#Image-Layer-Definition">â¡ï¸</a>Image Layer Definition</h5><p><code>é•œåƒå±‚ï¼ˆimage layerï¼‰</code>è¡¨ç¤ºä¸€å±‚ä¸­çš„å„ç§é›¶é›¶æ˜Ÿæ˜Ÿçš„æ•°æ®ï¼Œå®ƒå¹¶ä¸ä»…ä»…åŒ…å«æ–‡ä»¶ç³»ç»Ÿçš„æ”¹å˜ï¼Œè¿˜èƒ½åŒ…å«äº†å…¶ä»–é‡è¦ä¿¡æ¯ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/39fb0f8e630b338bcca7a29da3acabb7.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>å…ƒæ•°æ®ï¼ˆmetadataï¼‰</code>å°±æ˜¯å…³äºè¿™ä¸ªå±‚çš„é¢å¤–ä¿¡æ¯ï¼Œå®ƒä¸ä»…èƒ½å¤Ÿè®©<code>Docker</code>è·å–è¿è¡Œå’Œæ„å»ºæ—¶çš„ä¿¡æ¯ï¼Œè¿˜åŒ…æ‹¬çˆ¶å±‚çš„å±‚æ¬¡ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„ï¼Œåªè¯»å±‚å’Œè¯»å†™å±‚éƒ½åŒ…å«å…ƒæ•°æ®ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/f3218a8fcdd1fd8bcd5a719ca3c64f59.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p>é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€å±‚éƒ½åŒ…æ‹¬äº†ä¸€ä¸ªæŒ‡å‘çˆ¶å±‚çš„æŒ‡é’ˆã€‚å¦‚æœä¸€ä¸ªå±‚æ²¡æœ‰è¿™ä¸ªæŒ‡é’ˆï¼Œè¯´æ˜å®ƒå¤„äºæœ€åº•å±‚ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/53e377deeeb5f30bf939ed0836f851c9.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><h4 id="Docker-ä»“åº“"><a class="header-anchor" href="#Docker-ä»“åº“">â¡ï¸</a>Docker ä»“åº“</h4><p>å¦‚æœä½ ä½¿ç”¨è¿‡gitå’Œgithubå°±å¾ˆå®¹æ˜“ç†è§£Dockerçš„ä»“åº“æ¦‚å¿µã€‚Docker ä»“åº“çš„æ¦‚å¿µè·ŸGit ç±»ä¼¼ï¼Œæ³¨å†ŒæœåŠ¡å™¨å¯ä»¥ç†è§£ä¸º GitHub è¿™æ ·çš„æ‰˜ç®¡æœåŠ¡ã€‚<br>Docker ä»“åº“æ˜¯ç”¨æ¥åŒ…å«é•œåƒçš„ä½ç½®ï¼ŒDockeræä¾›ä¸€ä¸ªæ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegisterï¼‰æ¥ä¿å­˜å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“åˆå¯ä»¥åŒ…å«å¤šä¸ªå…·å¤‡ä¸åŒtagçš„é•œåƒã€‚Dockerè¿è¡Œä¸­ä½¿ç”¨çš„é»˜è®¤ä»“åº“æ˜¯ Docker Hub å…¬å…±ä»“åº“ã€‚<br>ä»“åº“æ”¯æŒçš„æ“ä½œç±»ä¼¼gitï¼Œå½“ç”¨æˆ·åˆ›å»ºäº†è‡ªå·±çš„é•œåƒä¹‹åå°±å¯ä»¥ä½¿ç”¨ push å‘½ä»¤å°†å®ƒä¸Šä¼ åˆ°å…¬æœ‰æˆ–è€…ç§æœ‰ä»“åº“ï¼Œè¿™æ ·ä¸‹æ¬¡åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šä½¿ç”¨è¿™ä¸ªé•œåƒæ—¶å€™ï¼Œåªéœ€è¦ä»ä»“åº“ä¸Š pull ä¸‹æ¥å°±å¯ä»¥äº†ã€‚</p><h4 id="å…¨å±€ç†è§£ï¼ˆTying-It-All-Togetherï¼‰"><a class="header-anchor" href="#å…¨å±€ç†è§£ï¼ˆTying-It-All-Togetherï¼‰">â¡ï¸</a>å…¨å±€ç†è§£ï¼ˆTying It All Togetherï¼‰</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker create &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/062e7af0929dd205b2ac6efdd937d6f4.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker create</code>å‘½ä»¤ä¸ºæŒ‡å®šçš„<code>é•œåƒï¼ˆimageï¼‰</code>åˆ›å»ºäº†ä¸€ä¸ªå¯è¯»å¯å†™å±‚ï¼Œæ„æˆäº†ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå®¹å™¨å¹¶æ²¡æœ‰è¿è¡Œã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/162f02c6f9dce4ccdaa0c6c676da2196.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/1c38d4735e9760bdca025ff50a1b5386.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>Docker start</code>å‘½ä»¤ä¸ºå®¹å™¨æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºäº†ä¸€ä¸ªè¿›ç¨‹éš”ç¦»ç©ºé—´ã€‚æ³¨æ„ï¼Œæ¯ä¸€ä¸ªå®¹å™¨åªèƒ½å¤Ÿæœ‰ä¸€ä¸ªè¿›ç¨‹éš”ç¦»ç©ºé—´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/01aedf55bd21abbe607b3864d76f0ec0.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker start</code>å’Œ<code>docker run</code>å‘½ä»¤çš„åŒºåˆ«ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/275cc486d4ce7ecbdecf0ecc1de0a34b.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p>ä»å›¾ç‰‡å¯ä»¥çœ‹å‡ºï¼Œ<code>docker run</code>å‘½ä»¤å…ˆæ˜¯åˆ©ç”¨é•œåƒåˆ›å»ºäº†ä¸€ä¸ªå®¹å™¨ï¼Œç„¶åè¿è¡Œè¿™ä¸ªå®¹å™¨ã€‚è¿™ä¸ªå‘½ä»¤éå¸¸çš„æ–¹ä¾¿ï¼Œå¹¶ä¸”éšè—äº†ä¸¤ä¸ªå‘½ä»¤çš„ç»†èŠ‚ï¼Œä½†ä»å¦ä¸€æ–¹é¢æ¥çœ‹ï¼Œè¿™å®¹æ˜“è®©ç”¨æˆ·äº§ç”Ÿè¯¯è§£ã€‚</p><div class="note info"><p>æ³¨ï¼š<code>docker run</code>ç›¸å½“äº<code>docker create</code>å’Œ<code>docker start</code>ä¸¤ä¸ªå‘½ä»¤çš„ç»„åˆã€‚</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/f05a2a8dfc6641d8237306ff575aa283.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker ps</code>å‘½ä»¤ä¼šåˆ—å‡ºæ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨ã€‚è¿™éšè—äº†éè¿è¡Œæ€å®¹å™¨çš„å­˜åœ¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps â€“a</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/d7f7b0ada7fc1c641c90745a959f9c05.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker ps â€“a</code>å‘½ä»¤ä¼šåˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨ï¼Œä¸ç®¡æ˜¯è¿è¡Œçš„ï¼Œè¿˜æ˜¯åœæ­¢çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/d5b0b3e2e7acdcf35e7577d7670a46f7.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker images</code>å‘½ä»¤ä¼šåˆ—å‡ºäº†æ‰€æœ‰<code>é¡¶å±‚ï¼ˆtop-levelï¼‰é•œåƒ</code>ã€‚å®é™…ä¸Šï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•åŒºåˆ†ä¸€ä¸ªé•œåƒå’Œä¸€ä¸ªåªè¯»å±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬æå‡ºäº†<code>top-levelé•œåƒ</code>ã€‚åªæœ‰åˆ›å»ºå®¹å™¨æ—¶ä½¿ç”¨çš„é•œåƒæˆ–è€…æ˜¯ç›´æ¥pullä¸‹æ¥çš„é•œåƒèƒ½è¢«ç§°ä¸º<code>é¡¶å±‚ï¼ˆtop-levelï¼‰é•œåƒ</code>ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé¡¶å±‚é•œåƒä¸‹é¢éƒ½éšè—äº†å¤šä¸ªé•œåƒå±‚ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images â€“a</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/ce083575e95a0e46b105c3596c12ca71.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker images â€“a</code>å‘½ä»¤åˆ—å‡ºäº†æ‰€æœ‰çš„é•œåƒï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯åˆ—å‡ºäº†æ‰€æœ‰çš„å¯è¯»å±‚ã€‚å¦‚æœä½ æƒ³è¦æŸ¥çœ‹æŸä¸€ä¸ª<code>image-id</code>ä¸‹çš„æ‰€æœ‰å±‚ï¼Œå¯ä»¥ä½¿ç”¨<code>docker history</code>æ¥æŸ¥çœ‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/a41de8fe542efe25e3620691ad9238df.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker stop</code>å‘½ä»¤ä¼šå‘è¿è¡Œä¸­çš„å®¹å™¨å‘é€ä¸€ä¸ª<code>SIGTERM</code>çš„ä¿¡å·ï¼Œç„¶ååœæ­¢æ‰€æœ‰çš„è¿›ç¨‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker kill &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/ac1cbc31d4f191e26e05fb1a11f04d26.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker kill</code>å‘½ä»¤å‘æ‰€æœ‰è¿è¡Œåœ¨å®¹å™¨ä¸­çš„è¿›ç¨‹å‘é€äº†ä¸€ä¸ªä¸å‹å¥½çš„<code>SIGKILL</code>ä¿¡å·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pause &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/b701a3c51e7d1915da3bea0bc43efcd1.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker stop</code>å’Œ<code>docker kill</code>å‘½ä»¤ä¼šå‘é€UNIXçš„ä¿¡å·ç»™è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œ<code>docker pause</code>å‘½ä»¤åˆ™ä¸ä¸€æ ·ï¼Œå®ƒåˆ©ç”¨äº†<code>cgroups</code>çš„ç‰¹æ€§å°†è¿è¡Œä¸­çš„è¿›ç¨‹ç©ºé—´æš‚åœã€‚ä½†æ˜¯è¿™ç§æ–¹å¼çš„ä¸è¶³ä¹‹å¤„åœ¨äºå‘é€ä¸€ä¸ª<code>SIGTSTP</code>ä¿¡å·å¯¹äºè¿›ç¨‹æ¥è¯´ä¸å¤Ÿç®€å•æ˜“æ‡‚ï¼Œä»¥è‡³äºä¸èƒ½å¤Ÿè®©æ‰€æœ‰è¿›ç¨‹æš‚åœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/8fa2d6e19c29f18548624efd64eb6dfa.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker rm</code>å‘½ä»¤ä¼šç§»é™¤æ„æˆå®¹å™¨çš„å¯è¯»å†™å±‚ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå‘½ä»¤åªèƒ½å¯¹éè¿è¡Œæ€å®¹å™¨æ‰§è¡Œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/32a7f413a5f8ff936dd0f4a31d25fdcc.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker rmi</code>å‘½ä»¤ä¼šç§»é™¤æ„æˆé•œåƒçš„ä¸€ä¸ªåªè¯»å±‚ã€‚ä½ åªèƒ½å¤Ÿä½¿ç”¨<code>docker rmi</code>æ¥ç§»é™¤<code>æœ€é¡¶å±‚ï¼ˆtop level layerï¼‰</code>ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯é•œåƒï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>-f</code>å‚æ•°æ¥å¼ºåˆ¶åˆ é™¤ä¸­é—´çš„åªè¯»å±‚ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/3c02ccf4e7a2a353af065d93b26ae89e.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker commit</code>å‘½ä»¤å°†å®¹å™¨çš„å¯è¯»å†™å±‚è½¬æ¢ä¸ºä¸€ä¸ªåªè¯»å±‚ï¼Œè¿™æ ·å°±æŠŠä¸€ä¸ªå®¹å™¨è½¬æ¢æˆäº†ä¸å¯å˜çš„é•œåƒã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/28059b3a499faba896263c0ff077fe3a.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/b22cd304f28c715ae3ae6812476b222d.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker build</code>å‘½ä»¤ä¼šåå¤çš„æ‰§è¡Œå¤šä¸ªå‘½ä»¤ã€‚</p><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/100712263ecf4544dd11602adc39ee3e.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>build</code>å‘½ä»¤æ ¹æ®<code>Dockerfile</code>æ–‡ä»¶ä¸­çš„<code>FROM</code>æŒ‡ä»¤è·å–åˆ°é•œåƒï¼Œç„¶åé‡å¤åœ°</p><ol><li><code>runï¼ˆcreateå’Œstartï¼‰</code></li><li>ä¿®æ”¹</li><li>commit</li></ol><p>åœ¨å¾ªç¯ä¸­çš„æ¯ä¸€æ­¥éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å±‚ï¼Œå› æ­¤è®¸å¤šæ–°çš„å±‚ä¼šè¢«åˆ›å»ºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec &lt;running-container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/db64b3b38aff136d42e9ffeb81675bda.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker exec</code>å‘½ä»¤ä¼šåœ¨è¿è¡Œä¸­çš„å®¹å™¨æ‰§è¡Œä¸€ä¸ªæ–°è¿›ç¨‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect &lt;container-id&gt; or &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/184f9d55770ca036cb5b1e6d96ce4a12.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker inspect</code>å‘½ä»¤ä¼šæå–å‡ºå®¹å™¨æˆ–è€…é•œåƒæœ€é¡¶å±‚çš„å…ƒæ•°æ®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/70cdbaf975c88bc83423d88be85476b5.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker save</code>å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªé•œåƒçš„å‹ç¼©æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶èƒ½å¤Ÿåœ¨å¦å¤–ä¸€ä¸ªä¸»æœºçš„<code>Docker</code>ä¸Šä½¿ç”¨ã€‚å’Œ<code>export</code>å‘½ä»¤ä¸åŒï¼Œè¿™ä¸ªå‘½ä»¤ä¸ºæ¯ä¸€ä¸ªå±‚éƒ½ä¿å­˜äº†å®ƒä»¬çš„å…ƒæ•°æ®ã€‚è¿™ä¸ªå‘½ä»¤åªèƒ½å¯¹é•œåƒç”Ÿæ•ˆã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker export &lt;container-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/1714c3dd524c807bf9c9b4d0fbe4d056.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker export</code>å‘½ä»¤åˆ›å»ºä¸€ä¸ªtaræ–‡ä»¶ï¼Œå¹¶ä¸”ç§»é™¤äº†å…ƒæ•°æ®å’Œä¸å¿…è¦çš„å±‚ï¼Œå°†å¤šä¸ªå±‚æ•´åˆæˆäº†ä¸€ä¸ªå±‚ï¼Œåªä¿å­˜äº†å½“å‰ç»Ÿä¸€è§†è§’çœ‹åˆ°çš„å†…å®¹ã€‚</p><div class="note info"><p>æ³¨ï¼š<code>expoxt</code>åçš„å®¹å™¨å†<code>import</code>åˆ°<code>Docker</code>ä¸­ï¼Œé€šè¿‡<code>docker images â€“tree</code>å‘½ä»¤åªèƒ½çœ‹åˆ°ä¸€ä¸ªé•œåƒï¼›è€Œ<code>save</code>åçš„é•œåƒåˆ™ä¸åŒï¼Œå®ƒèƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªé•œåƒçš„å†å²é•œåƒã€‚</p></div><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker history &lt;image-id&gt;</span><br></pre></td></tr></table></figure><span itemprop="image" itemscope itemtype="http://schema.org/ImageObject"><img itemprop="url image" src="images/b513dd5467f23fdd23523f60242d5dcb.png" class="full-image"><meta itemprop="width" content="auto"><meta itemprop="height" content="auto"></span><p><code>docker history</code>å‘½ä»¤é€’å½’åœ°è¾“å‡ºæŒ‡å®šé•œåƒçš„å†å²é•œåƒã€‚</p><div class="note info"><p>å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="https://merrigrove.blogspot.com/2015/10/visualizing-docker-containers-and-images.html" title="Visualizing Docker Containers and Images" target>Visualizing Docker Containers and Images</a></li><li><a href="http://dockone.io/article/783" title="10å¼ å›¾å¸¦ä½ æ·±å…¥ç†è§£Dockerå®¹å™¨å’Œé•œåƒ" target>10å¼ å›¾å¸¦ä½ æ·±å…¥ç†è§£Dockerå®¹å™¨å’Œé•œåƒ</a></li></ul></div><h3 id="Docker-å‘½ä»¤"><a class="header-anchor" href="#Docker-å‘½ä»¤">â¡ï¸</a>Docker å‘½ä»¤</h3><a href="https://www.runoob.com/docker/docker-command-manual.html" title="Docker å‘½ä»¤å¤§å…¨" target>å‚è€ƒé“¾æ¥</a><h4 id="Docker-run"><a class="header-anchor" href="#Docker-run">â¡ï¸</a>Docker run</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><p>OPTIONSè¯´æ˜ï¼š</p><ul><li>-a stdin: æŒ‡å®šæ ‡å‡†è¾“å…¥è¾“å‡ºå†…å®¹ç±»å‹ï¼Œå¯é€‰ STDIN/STDOUT/STDERR ä¸‰é¡¹ï¼›</li><li>-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼›</li><li>-i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</li><li>-P: éšæœºç«¯å£æ˜ å°„ï¼Œå®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„é«˜ç«¯å£</li><li>-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£</li><li>-t: ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</li><li>â€“name=â€œnginx-lbâ€: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</li><li>â€“dns 8.8.8.8: æŒ‡å®šå®¹å™¨ä½¿ç”¨çš„DNSæœåŠ¡å™¨ï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</li><li>â€“dns-search <a href="http://example.com">example.com</a>: æŒ‡å®šå®¹å™¨DNSæœç´¢åŸŸåï¼Œé»˜è®¤å’Œå®¿ä¸»ä¸€è‡´ï¼›</li><li>-h â€œmarsâ€: æŒ‡å®šå®¹å™¨çš„hostnameï¼›</li><li>-e username=â€œritchieâ€: è®¾ç½®ç¯å¢ƒå˜é‡ï¼›</li><li>â€“env-file=[]: ä»æŒ‡å®šæ–‡ä»¶è¯»å…¥ç¯å¢ƒå˜é‡ï¼›</li><li>â€“cpuset=â€œ0-2â€ or --cpuset=â€œ0,1,2â€: ç»‘å®šå®¹å™¨åˆ°æŒ‡å®šCPUè¿è¡Œï¼›</li><li>-m :è®¾ç½®å®¹å™¨ä½¿ç”¨å†…å­˜æœ€å¤§å€¼ï¼›</li><li>â€“net=â€œbridgeâ€: æŒ‡å®šå®¹å™¨çš„ç½‘ç»œè¿æ¥ç±»å‹ï¼Œæ”¯æŒ bridge/host/none/container: å››ç§ç±»å‹ï¼›</li><li>â€“link=[]: æ·»åŠ é“¾æ¥åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼›</li><li>â€“expose=[]: å¼€æ”¾ä¸€ä¸ªç«¯å£æˆ–ä¸€ç»„ç«¯å£ï¼›</li><li>â€“volume , -v: ç»‘å®šä¸€ä¸ªå·</li></ul><p>å®ä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨dockeré•œåƒnginx:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨å‘½åä¸ºmynginxã€‚</span></span><br><span class="line">docker run --name mynginx -d nginx:latest</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨é•œåƒnginx:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å¹¶å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºéšæœºç«¯å£ã€‚</span></span><br><span class="line">docker run -P -d nginx:latest</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨é•œåƒ nginx:latestï¼Œä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,å°†å®¹å™¨çš„ 80 ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„ 80 ç«¯å£,ä¸»æœºçš„ç›®å½• /data æ˜ å°„åˆ°å®¹å™¨çš„ /dataã€‚</span></span><br><span class="line">docker run -p 80:80 -v /data:/data -d nginx:latest</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ç»‘å®šå®¹å™¨çš„ 8080 ç«¯å£ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœº 127.0.0.1 çš„ 80 ç«¯å£ä¸Šã€‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> docker run -p 127.0.0.1:80:8080/tcp ubuntu bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä½¿ç”¨é•œåƒnginx:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ã€‚</span></span><br><span class="line">runoob@runoob:~$ docker run -it nginx:latest /bin/bash</span><br><span class="line">root@b85456f75:/# </span><br></pre></td></tr></table></figure><h4 id="Docker-start-stop-restart-å‘½ä»¤"><a class="header-anchor" href="#Docker-start-stop-restart-å‘½ä»¤">â¡ï¸</a>Docker start/stop/restart å‘½ä»¤</h4><p><code>docker start</code> :å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»è¢«åœæ­¢çš„å®¹å™¨<br><code>docker stop</code> :åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨<br><code>docker restart</code> :é‡å¯å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker start [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">docker stop [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">docker restart [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> å¯åŠ¨å·²è¢«åœæ­¢çš„å®¹å™¨myrunoob</span></span><br><span class="line">docker start myrunoob</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨myrunoob</span></span><br><span class="line">docker stop myrunoob</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é‡å¯å®¹å™¨myrunoob</span></span><br><span class="line">docker restart myrunoob</span><br></pre></td></tr></table></figure><h4 id="Docker-attach-å‘½ä»¤"><a class="header-anchor" href="#Docker-attach-å‘½ä»¤">â¡ï¸</a>Docker attach å‘½ä»¤</h4><p><code>docker attach</code>:è¿æ¥åˆ°æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><p>è¦attachä¸Šå»çš„å®¹å™¨å¿…é¡»æ­£åœ¨è¿è¡Œï¼Œå¯ä»¥åŒæ—¶è¿æ¥ä¸ŠåŒä¸€ä¸ªcontaineræ¥å…±äº«å±å¹•ï¼ˆä¸screenå‘½ä»¤çš„attachç±»ä¼¼ï¼‰ã€‚<br>å®˜æ–¹æ–‡æ¡£ä¸­è¯´attachåå¯ä»¥é€šè¿‡CTRL-Cæ¥detachï¼Œä½†å®é™…ä¸Šç»è¿‡æˆ‘çš„æµ‹è¯•ï¼Œå¦‚æœcontainerå½“å‰åœ¨è¿è¡Œbashï¼ŒCTRL-Cè‡ªç„¶æ˜¯å½“å‰è¡Œçš„è¾“å…¥ï¼Œæ²¡æœ‰é€€å‡ºï¼›å¦‚æœcontainerå½“å‰æ­£åœ¨å‰å°è¿è¡Œè¿›ç¨‹ï¼Œå¦‚è¾“å‡ºnginxçš„access.logæ—¥å¿—ï¼ŒCTRL-Cä¸ä»…ä¼šå¯¼è‡´é€€å‡ºå®¹å™¨ï¼Œè€Œä¸”è¿˜stopäº†ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œdetachçš„æ„æ€æŒ‰ç†åº”è¯¥æ˜¯è„±ç¦»å®¹å™¨ç»ˆç«¯ï¼Œä½†å®¹å™¨ä¾ç„¶è¿è¡Œã€‚å¥½åœ¨attachæ˜¯å¯ä»¥å¸¦ä¸Šâ€“sig-proxy=falseæ¥ç¡®ä¿CTRL-Dæˆ–CTRL-Cä¸ä¼šå…³é—­å®¹å™¨ã€‚</p><h4 id="Docker-create-å‘½ä»¤"><a class="header-anchor" href="#Docker-create-å‘½ä»¤">â¡ï¸</a>Docker create å‘½ä»¤</h4><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker create [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><h5 id="Options"><a class="header-anchor" href="#Options">â¡ï¸</a>Options</h5><table><thead><tr><th>Name,shorthand</th><th style="text-align:center">Default</th><th>Description</th></tr></thead><tbody><tr><td>â€“add-host</td><td style="text-align:center"></td><td>Add a custom host-to-IP mapping (host:ip)</td></tr><tr><td>â€“attach , -a</td><td style="text-align:center"></td><td>Attach to STDIN, STDOUT or STDERR</td></tr><tr><td>â€“blkio-weight</td><td style="text-align:center"></td><td>Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)</td></tr><tr><td>â€“blkio-weight-device</td><td style="text-align:center"></td><td>Block IO weight (relative device weight)</td></tr><tr><td>â€“cap-add</td><td style="text-align:center"></td><td>Add Linux capabilities</td></tr><tr><td>â€“cap-drop</td><td style="text-align:center"></td><td>Drop Linux capabilities</td></tr><tr><td>â€“cgroup-parent</td><td style="text-align:center"></td><td>Optional parent cgroup for the container</td></tr><tr><td>â€“cidfile</td><td style="text-align:center"></td><td>Write the container ID to the file</td></tr><tr><td>â€“cpu-count</td><td style="text-align:center"></td><td>CPU count (Windows only)</td></tr><tr><td>â€“cpu-percent</td><td style="text-align:center"></td><td>CPU percent (Windows only)</td></tr><tr><td>â€“cpu-period</td><td style="text-align:center"></td><td>Limit CPU CFS (Completely Fair Scheduler) period</td></tr><tr><td>â€“cpu-quota</td><td style="text-align:center"></td><td>Limit CPU CFS (Completely Fair Scheduler) quota</td></tr><tr><td>â€“cpu-rt-period</td><td style="text-align:center"></td><td><code>API 1.25+</code><br>Limit CPU real-time period in microseconds</td></tr><tr><td>â€“cpu-rt-runtime</td><td style="text-align:center"></td><td><code>API 1.25+</code><br>Limit CPU real-time runtime in microseconds</td></tr><tr><td>â€“cpu-shares , -c</td><td style="text-align:center"></td><td>CPU shares (relative weight)</td></tr><tr><td>â€“cpus</td><td style="text-align:center"></td><td><code>API 1.25+</code><br>Number of CPUs</td></tr><tr><td>â€“cpuset-cpus</td><td style="text-align:center"></td><td>CPUs in which to allow execution (0-3, 0,1)</td></tr><tr><td>â€“cpuset-mems</td><td style="text-align:center"></td><td>MEMs in which to allow execution (0-3, 0,1)</td></tr><tr><td>â€“device</td><td style="text-align:center"></td><td>Add a host device to the container</td></tr><tr><td>â€“device-cgroup-rule</td><td style="text-align:center"></td><td>Add a rule to the cgroup allowed devices list</td></tr><tr><td>â€“device-read-bps</td><td style="text-align:center"></td><td>Limit read rate (bytes per second) from a device</td></tr><tr><td>â€“device-read-iops</td><td style="text-align:center"></td><td>Limit read rate (IO per second) from a device</td></tr><tr><td>â€“device-write-bps</td><td style="text-align:center"></td><td>Limit write rate (bytes per second) to a device</td></tr><tr><td>â€“device-write-iops</td><td style="text-align:center"></td><td>Limit write rate (IO per second) to a device</td></tr><tr><td>â€“disable-content-trust</td><td style="text-align:center">true</td><td>Skip image verification</td></tr><tr><td>â€“dns</td><td style="text-align:center"></td><td>Set custom DNS servers</td></tr><tr><td>â€“dns-opt</td><td style="text-align:center"></td><td>Set DNS options</td></tr><tr><td>â€“dns-option</td><td style="text-align:center"></td><td>Set DNS options</td></tr><tr><td>â€“dns-search</td><td style="text-align:center"></td><td>Set custom DNS search domains</td></tr><tr><td>â€“domainname</td><td style="text-align:center"></td><td>Container NIS domain name</td></tr><tr><td>â€“entrypoint</td><td style="text-align:center"></td><td>Overwrite the default ENTRYPOINT of the image</td></tr><tr><td>â€“env , -e</td><td style="text-align:center"></td><td>Set environment variables</td></tr><tr><td>â€“env-file</td><td style="text-align:center"></td><td>Read in a file of environment variables</td></tr><tr><td>â€“expose</td><td style="text-align:center"></td><td>Expose a port or a range of ports</td></tr><tr><td>â€“gpus</td><td style="text-align:center"></td><td><code>API 1.40+</code><br>GPU devices to add to the container (â€˜allâ€™ to pass all GPUs)</td></tr><tr><td>â€“group-add</td><td style="text-align:center"></td><td>Add additional groups to join</td></tr><tr><td>â€“health-cmd</td><td style="text-align:center"></td><td>Command to run to check health</td></tr><tr><td>â€“health-interval</td><td style="text-align:center"></td><td>Time between running the check (msä¸¨sä¸¨mä¸¨h) (default 0s)</td></tr><tr><td>â€“health-retries</td><td style="text-align:center"></td><td>Consecutive failures needed to report unhealthy</td></tr><tr><td>â€“health-start-period</td><td style="text-align:center"></td><td><code>API 1.29+</code><br>Start period for the container to initialize before starting health-retries countdown (msä¸¨s&amp;ä¸¨mä¸¨h) (default 0s)</td></tr><tr><td>â€“health-timeout</td><td style="text-align:center"></td><td>Maximum time to allow one check to run (msä¸¨sä¸¨mä¸¨h) (default 0s)</td></tr><tr><td>â€“help</td><td style="text-align:center"></td><td>Print usage</td></tr><tr><td>â€“hostname , -h</td><td style="text-align:center"></td><td>Container host name</td></tr><tr><td>â€“init</td><td style="text-align:center"></td><td><code>API 1.25+</code><br>Run an init inside the container that forwards signals and reaps processes</td></tr><tr><td>â€“interactive , -i</td><td style="text-align:center"></td><td>Keep STDIN open even if not attached</td></tr><tr><td>â€“io-maxbandwidth</td><td style="text-align:center"></td><td>Maximum IO bandwidth limit for the system drive (Windows only)</td></tr><tr><td>â€“io-maxiops</td><td style="text-align:center"></td><td>Maximum IOps limit for the system drive (Windows only)</td></tr><tr><td>â€“ip</td><td style="text-align:center"></td><td>IPv4 address (e.g., 172.30.100.104)</td></tr><tr><td>â€“ip6</td><td style="text-align:center"></td><td>IPv6 address (e.g., 2001:db8::33)</td></tr><tr><td>â€“ipc</td><td style="text-align:center"></td><td>IPC mode to use</td></tr><tr><td>â€“isolation</td><td style="text-align:center"></td><td>Container isolation technology</td></tr><tr><td>â€“kernel-memory</td><td style="text-align:center"></td><td>Kernel memory limit</td></tr><tr><td>â€“label , -l</td><td style="text-align:center"></td><td>Set meta data on a container</td></tr><tr><td>â€“label-file</td><td style="text-align:center"></td><td>Read in a line delimited file of labels</td></tr><tr><td>â€“link</td><td style="text-align:center"></td><td>Add link to another container</td></tr><tr><td>â€“link-local-ip</td><td style="text-align:center"></td><td>Container IPv4/IPv6 link-local addresses</td></tr><tr><td>â€“log-driver</td><td style="text-align:center"></td><td>Logging driver for the container</td></tr><tr><td>â€“log-opt</td><td style="text-align:center"></td><td>Log driver options</td></tr><tr><td>â€“mac-address</td><td style="text-align:center"></td><td>Container MAC address (e.g., 92:d0:c6:0a:29:33)</td></tr><tr><td>â€“memory , -m</td><td style="text-align:center"></td><td>Memory limit</td></tr><tr><td>â€“memory-reservation</td><td style="text-align:center"></td><td>Memory soft limit</td></tr><tr><td>â€“memory-swap</td><td style="text-align:center"></td><td>Swap limit equal to memory plus swap: â€˜-1â€™ to enable unlimited swap</td></tr><tr><td>â€“memory-swappiness</td><td style="text-align:center">-1</td><td>Tune container memory swappiness (0 to 100)</td></tr><tr><td>â€“mount</td><td style="text-align:center"></td><td>Attach a filesystem mount to the container</td></tr><tr><td>â€“name</td><td style="text-align:center"></td><td>Assign a name to the container</td></tr><tr><td>â€“net</td><td style="text-align:center"></td><td>Connect a container to a network</td></tr><tr><td>â€“net-alias</td><td style="text-align:center"></td><td>Add network-scoped alias for the container</td></tr><tr><td>â€“network</td><td style="text-align:center"></td><td>Connect a container to a network</td></tr><tr><td>â€“network-alias</td><td style="text-align:center"></td><td>Add network-scoped alias for the container</td></tr><tr><td>â€“no-healthcheck</td><td style="text-align:center"></td><td>Disable any container-specified HEALTHCHECK</td></tr><tr><td>â€“oom-kill-disable</td><td style="text-align:center"></td><td>Disable OOM Killer</td></tr><tr><td>â€“oom-score-adj</td><td style="text-align:center"></td><td>Tune hostâ€™s OOM preferences (-1000 to 1000)</td></tr><tr><td>â€“pid</td><td style="text-align:center"></td><td>PID namespace to use</td></tr><tr><td>â€“pids-limit</td><td style="text-align:center"></td><td>Tune container pids limit (set -1 for unlimited)</td></tr><tr><td>â€“platform</td><td style="text-align:center"></td><td><code>experimental (daemon)API 1.32+</code><br>Set platform if server is multi-platform capable</td></tr><tr><td>â€“privileged</td><td style="text-align:center"></td><td>Give extended privileges to this container</td></tr><tr><td>â€“publish , -p</td><td style="text-align:center"></td><td>Publish a containerâ€™s port(s) to the host</td></tr><tr><td>â€“publish-all , -P</td><td style="text-align:center"></td><td>Publish all exposed ports to random ports</td></tr><tr><td>â€“read-only</td><td style="text-align:center"></td><td>Mount the containerâ€™s root filesystem as read only</td></tr><tr><td>â€“restart</td><td style="text-align:center">no</td><td>Restart policy to apply when a container exits</td></tr><tr><td>â€“rm</td><td style="text-align:center"></td><td>Automatically remove the container when it exits</td></tr><tr><td>â€“runtime</td><td style="text-align:center"></td><td>Runtime to use for this container</td></tr><tr><td>â€“security-opt</td><td style="text-align:center"></td><td>Security Options</td></tr><tr><td>â€“shm-size</td><td style="text-align:center"></td><td>Size of /dev/shm</td></tr><tr><td>â€“stop-signal</td><td style="text-align:center">SIGTERM</td><td>Signal to stop a container</td></tr><tr><td>â€“stop-timeout</td><td style="text-align:center"></td><td><code>API 1.25+</code><br>Timeout (in seconds) to stop a container</td></tr><tr><td>â€“storage-opt</td><td style="text-align:center"></td><td>Storage driver options for the container</td></tr><tr><td>â€“sysctl</td><td style="text-align:center"></td><td>Sysctl options</td></tr><tr><td>â€“tmpfs</td><td style="text-align:center"></td><td>Mount a tmpfs directory</td></tr><tr><td>â€“tty , -t</td><td style="text-align:center"></td><td>Allocate a pseudo-TTY</td></tr><tr><td>â€“ulimit</td><td style="text-align:center"></td><td>Ulimit options</td></tr><tr><td>â€“user , -u</td><td style="text-align:center"></td><td>Username or UID (format: &lt;nameä¸¨uid&gt;[:&lt;groupä¸¨gid&gt;])</td></tr><tr><td>â€“userns</td><td style="text-align:center"></td><td>User namespace to use</td></tr><tr><td>â€“uts</td><td style="text-align:center"></td><td>UTS namespace to use</td></tr><tr><td>â€“volume , -v</td><td style="text-align:center"></td><td>Bind mount a volume</td></tr><tr><td>â€“volume-driver</td><td style="text-align:center"></td><td>Optional volume driver for the container</td></tr><tr><td>â€“volumes-from</td><td style="text-align:center"></td><td>Mount volumes from the specified container(s)</td></tr><tr><td>â€“workdir , -w</td><td style="text-align:center"></td><td>Working directory inside the container</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;äº†è§£-Docker&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#äº†è§£-Docker&quot;&gt;â¡ï¸&lt;/a&gt;äº†è§£ Docker&lt;/h3&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;code&gt;Docker&lt;/code&gt; æœ€åˆæ˜¯ &lt;code&gt;dotCloud&lt;/code&gt; å…¬å¸åˆ›å§‹äºº &lt;code&gt;Solomon Hykes&lt;/code&gt; åœ¨æ³•å›½æœŸé—´å‘èµ·çš„ä¸€ä¸ªå…¬å¸å†…éƒ¨é¡¹ç›®ï¼Œå®ƒæ˜¯åŸºäº &lt;code&gt;dotCloud&lt;/code&gt; å…¬å¸å¤šå¹´äº‘æœåŠ¡æŠ€æœ¯çš„ä¸€æ¬¡é©æ–°ï¼Œå¹¶äº 2013 å¹´ 3 æœˆä»¥ Apache 2.0 æˆæƒåè®®å¼€æºï¼Œä¸»è¦é¡¹ç›®ä»£ç åœ¨ &lt;code&gt;GitHub&lt;/code&gt; ä¸Šè¿›è¡Œç»´æŠ¤ã€‚&lt;code&gt;Docker&lt;/code&gt; é¡¹ç›®åæ¥è¿˜åŠ å…¥äº† &lt;code&gt;LinuxåŸºé‡‘ä¼š&lt;/code&gt;ï¼Œå¹¶æˆç«‹æ¨åŠ¨ å¼€æ”¾å®¹å™¨è”ç›Ÿï¼ˆOCIï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="linux" scheme="https://hexo.lilis.xin/tags/linux/"/>
    
      <category term="docker" scheme="https://hexo.lilis.xin/tags/docker/"/>
    
      <category term="è™šæ‹ŸåŒ–" scheme="https://hexo.lilis.xin/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>hexo é…ç½®gitalk</title>
    <link href="https://hexo.lilis.xin/posts/44125ab6/"/>
    <id>https://hexo.lilis.xin/posts/44125ab6/</id>
    <published>2019-09-13T05:33:39.000Z</published>
    <updated>2019-09-13T07:37:02.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æˆ‘ç°åœ¨ç”¨çš„åšå®¢æ˜¯é™æ€ç½‘é¡µï¼Œæ²¡æœ‰ç‹¬ç«‹çš„åç«¯æœåŠ¡å™¨æ¥æ”¯æ’‘ï¼Œä¸ºäº†å®ç°è¯„è®ºåŠŸèƒ½ï¼Œéœ€è¦å¯¹æ¥ç¬¬ä¸‰æ–¹çš„è¯„è®ºæ’ä»¶ï¼Œç»è¿‡å„ç§è€ƒè™‘ï¼Œå†³å®šä½¿ç”¨<code>gitalk</code>ã€‚<br>è¿™æ˜¯ä¸€ä¸ªåŸºäº<code>GitHub</code>çš„<code>issues</code>æ¥å®ç°çš„è¯„è®ºå·¥å…·ã€‚</p><a id="more"></a><p>è¿™ä¸ªåŠŸèƒ½ä½¿ç”¨åˆ°äº†ä»¥ä¸‹æ’ä»¶</p><div style="text-align: center">  <div class="github-card" data-user="gitalk" data-repo="gitalk" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><div style="text-align: center">  <div class="github-card" data-user="blueimp" data-repo="JavaScript-MD5" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><h4 id="GitHub"><a class="header-anchor" href="#GitHub">â¡ï¸</a>GitHub</h4><p>é¦–å…ˆå¾—æœ‰ä¸€ä¸ª<code>GitHub</code>è´¦å·ï¼Œç„¶åæ‰“å¼€é“¾æ¥â†™ï¸<br><a href="https://github.com/settings/applications/new">New OAuth application</a><br>æ³¨å†Œä¸€ä¸ª<code>OAuth App</code><br>å…·ä½“å¡«å†™å‚è€ƒå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Application name &#x2F;&#x2F;åº”ç”¨åç§°</span><br><span class="line">Homepage URL &#x2F;&#x2F;å¡«è‡ªå·±çš„åšå®¢åœ°å€å°±å¯ä»¥äº†</span><br><span class="line">Application description &#x2F;&#x2F;åº”ç”¨æè¿°</span><br><span class="line">Authorization callback URL &#x2F;&#x2F;å¡«å†™è‡ªå·±è¦ç”¨ gitalk çš„åšå®¢åœ°å€</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œå¡«å†™å®Œæˆä¹‹åä½ å°±ä¼šå¾—åˆ°<code>Client ID</code>å’Œ<code>Client Secret</code>ã€‚</p><h4 id="æ–‡ä»¶ä¿®æ”¹"><a class="header-anchor" href="#æ–‡ä»¶ä¿®æ”¹">â¡ï¸</a>æ–‡ä»¶ä¿®æ”¹</h4><p>åœ¨ä¸»é¢˜ç›®å½•ä¸‹å»ºç«‹<code>/layout/_third-party/gitalk.swig</code>æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if page.comments &amp;&amp; theme.gitalk.enable %&#125;</span><br><span class="line"></span><br><span class="line">  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;gitalk&#x2F;dist&#x2F;gitalk.css&quot;&gt;</span><br><span class="line">  &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;gitalk&#x2F;dist&#x2F;gitalk.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">  &lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;blueimp-md5&#x2F;2.12.0&#x2F;js&#x2F;md5.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">   &lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">        var gitalk &#x3D; new Gitalk(&#123;</span><br><span class="line">          clientID: &#39;&#123;&#123; theme.gitalk.ClientID &#125;&#125;&#39;,</span><br><span class="line">          clientSecret: &#39;&#123;&#123; theme.gitalk.ClientSecret &#125;&#125;&#39;,</span><br><span class="line">          repo: &#39;&#123;&#123; theme.gitalk.repo &#125;&#125;&#39;,</span><br><span class="line">          owner: &#39;&#123;&#123; theme.gitalk.owner &#125;&#125;&#39;,</span><br><span class="line">          admin: &#39;&#123;&#123; theme.gitalk.adminUser &#125;&#125;&#39;,</span><br><span class="line">          id: md5(&#123;&#123; theme.gitalk.ID &#125;&#125;),</span><br><span class="line">          labels: &#123;&#123; theme.gitalk.labels &#125;&#125;,</span><br><span class="line">          perPage: &#123;&#123; theme.gitalk.perPage &#125;&#125;,</span><br><span class="line">          pagerDirection: &#39;&#123;&#123; theme.gitalk.pagerDirection &#125;&#125;&#39;,</span><br><span class="line">          createIssueManually: &#123;&#123; theme.gitalk.createIssueManually &#125;&#125;,</span><br><span class="line">          distractionFreeMode: &#123;&#123; theme.gitalk.distractionFreeMode &#125;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        gitalk.render(&#39;gitalk-container&#39;)</span><br><span class="line">       &lt;&#x2F;script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»é¢˜çš„<code>/layout/_scripts/commons.swig</code>ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include &#39;..&#x2F;_third-party&#x2F;comments&#x2F;gitalk.swig&#39; %&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œåœ¨ä¸»é¢˜çš„<code>/layout/_partials/comments.swig</code>ä¸­æ‰¾åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elseif theme.valine.appid and theme.valine.appkey %&#125;</span><br><span class="line">  &lt;div class&#x3D;&quot;comments&quot; id&#x3D;&quot;comments&quot;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.gitalk.enable %&#125;</span><br><span class="line">      &lt;div id&#x3D;&quot;gitalk-container&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿›è¡Œé…ç½®"><a class="header-anchor" href="#è¿›è¡Œé…ç½®">â¡ï¸</a>è¿›è¡Œé…ç½®</h4><p>åœ¨ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸‹å†…å®¹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># æ˜¯å¦å¯åŠ¨</span></span><br><span class="line">  <span class="attr">ClientID:</span> <span class="string">xxxxxx</span> <span class="comment"># ä¹‹å‰çš„Client ID</span></span><br><span class="line">  <span class="attr">ClientSecret:</span> <span class="string">xxxxxxxxxxxx</span> <span class="comment"># ä¹‹å‰çš„Client Secret</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">gitalk</span> <span class="comment"># ç•™è¨€æ¿å†…å®¹éœ€è¦å­˜æ”¾çš„ä»“åº“åç§°</span></span><br><span class="line">  <span class="attr">owner:</span> <span class="string">l552121229</span> <span class="comment"># ä½  github çš„å¸å· eg: www.github.com/zhongxia245 ,å¸å·å°±æ˜¯245</span></span><br><span class="line">  <span class="attr">adminUser:</span> [<span class="string">&#x27;l552121229&#x27;</span>] <span class="comment"># ç®¡ç†å‘˜ç”¨æˆ·</span></span><br><span class="line">  <span class="attr">ID:</span> <span class="string">location.pathname</span></span><br><span class="line">  <span class="attr">labels:</span> <span class="string">&#x27;[&quot;gitalk&quot;]&#x27;</span> <span class="comment"># issue çš„æ ‡ç­¾</span></span><br><span class="line">  <span class="attr">perPage:</span> <span class="number">15</span> <span class="comment"># æ¯é¡µå±•ç¤ºæ¡æ•°</span></span><br><span class="line">  <span class="attr">pagerDirection:</span> <span class="string">last</span> <span class="comment"># æ’åºæ–¹å¼æ˜¯ä»æ—§åˆ°æ–°ï¼ˆfirstï¼‰è¿˜æ˜¯ä»æ–°åˆ°æ—§ï¼ˆlastï¼‰</span></span><br><span class="line">  <span class="attr">createIssueManually:</span> <span class="literal">true</span> <span class="comment">#å¦‚æœå½“å‰é¡µé¢æ²¡æœ‰ç›¸åº”çš„ isssue ï¼Œä¸”ç™»å½•çš„ç”¨æˆ·å±äº adminï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»º issueã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™æ˜¾ç¤ºä¸€ä¸ªåˆå§‹åŒ–é¡µé¢ï¼Œåˆ›å»º issue éœ€è¦ç‚¹å‡» init æŒ‰é’®ã€‚</span></span><br><span class="line">  <span class="attr">distractionFreeMode:</span> <span class="literal">true</span> <span class="comment">#æ˜¯å¦å¯ç”¨å¿«æ·é”®(cmd|ctrl + enter) æäº¤è¯„è®º.</span></span><br></pre></td></tr></table></figure><ul><li>å› ä¸ºæˆ‘ä»¬ä¸Šé¢é…ç½®çš„<code>gitalk</code>æ˜¯ç”¨<code>location.pathname</code>æ¥ä½œä¸ºé¡¹ç›®æ ‡ç­¾åŒºåˆ†çš„ï¼Œå¦‚æœè¿™ä¸ªæ–‡ç« åè¶…è¿‡50ä¸ªå­—å°±ä¼šæŠ¥é”™ï¼Œä¸ºäº†ä¿é™©èµ·è§ï¼Œæˆ‘ä»¬é€šè¿‡å¼•å…¥<code>md5.min.js</code>æ¥é˜²æ­¢<code>lables</code>è¿‡é•¿ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ç°åœ¨ç”¨çš„åšå®¢æ˜¯é™æ€ç½‘é¡µï¼Œæ²¡æœ‰ç‹¬ç«‹çš„åç«¯æœåŠ¡å™¨æ¥æ”¯æ’‘ï¼Œä¸ºäº†å®ç°è¯„è®ºåŠŸèƒ½ï¼Œéœ€è¦å¯¹æ¥ç¬¬ä¸‰æ–¹çš„è¯„è®ºæ’ä»¶ï¼Œç»è¿‡å„ç§è€ƒè™‘ï¼Œå†³å®šä½¿ç”¨&lt;code&gt;gitalk&lt;/code&gt;ã€‚&lt;br&gt;
è¿™æ˜¯ä¸€ä¸ªåŸºäº&lt;code&gt;GitHub&lt;/code&gt;çš„&lt;code&gt;issues&lt;/code&gt;æ¥å®ç°çš„è¯„è®ºå·¥å…·ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="hexo" scheme="https://hexo.lilis.xin/tags/hexo/"/>
    
      <category term="gitalk" scheme="https://hexo.lilis.xin/tags/gitalk/"/>
    
      <category term="è¯„è®º" scheme="https://hexo.lilis.xin/tags/%E8%AF%84%E8%AE%BA/"/>
    
      <category term="node" scheme="https://hexo.lilis.xin/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>hexo æ’ä»¶</title>
    <link href="https://hexo.lilis.xin/posts/54690ca6/"/>
    <id>https://hexo.lilis.xin/posts/54690ca6/</id>
    <published>2019-09-12T07:45:38.000Z</published>
    <updated>2019-10-10T09:15:19.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœé›†æ•´ç†å¸¸ç”¨çš„<code>hexo</code>æ’ä»¶</p><a id="more"></a><h4 id="hexo-helper-live2d"><a class="header-anchor" href="#hexo-helper-live2d">â¡ï¸</a>hexo-helper-live2d</h4><p>åœ¨hexoåšå®¢é‡Œå¢åŠ çº¸ç‰‡äºº</p><div style="text-align: center">  <div class="github-card" data-user="EYHN" data-repo="hexo-helper-live2d" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><h4 id="hexo-tag-aplayer"><a class="header-anchor" href="#hexo-tag-aplayer">â¡ï¸</a>hexo-tag-aplayer</h4><p><code>APlayer</code>æ’­æ”¾å™¨çš„<code>Hexo</code>æ ‡ç­¾æ’ä»¶</p><div style="text-align: center">  <div class="github-card" data-user="MoePlayer" data-repo="hexo-tag-aplayer" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>æ•ˆæœï¼š</p><div id="aplayer0" class="aplayer" style="margin-bottom: 20px;"></div><script>var options = {"narrow":false,"autoplay":false,"showlrc":3,"mode":"random","mutex":true,"theme":"#e6d0b2","preload":"metadata","listmaxheight":"100%","music":[{"title":"ãƒˆãƒªã‚«ã‚´","author":"XX:me","url":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/darling.mp3","pic":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/darling.jpg","lrc":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/darling.lrc"},{"title":"å‰å‰å‰ä¸–","author":"RADWIMPS","url":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/yourname.mp3","pic":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/yourname.jpg","lrc":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/yourname.lrc"},{"title":"å…‰ã‚‹ãªã‚‰","author":"Goose house","url":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/hikarunara.mp3","pic":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/hikarunara.jpg","lrc":"https://cn-south-17-aplayer-46154810.oss.dogecdn.com/hikarunara.lrc"}]};options.element = document.getElementById("aplayer0");new APlayer(options);</script><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#å®‰è£…</span><br><span class="line">yarn add hexo-tag-aplayer</span><br><span class="line">#ä½¿ç”¨</span><br><span class="line">&#123;% aplayer title author url [picture_url, narrow, autoplay, width:xxx, lrc:xxx] %&#125;</span><br></pre></td></tr></table></figure><p>æ ‡ç­¾å‚æ•°</p><ul><li><code>title</code> : æ›²ç›®æ ‡é¢˜</li><li><code>author</code>: æ›²ç›®ä½œè€…</li><li><code>url</code>: éŸ³ä¹æ–‡ä»¶ URL åœ°å€</li><li><code>picture_url</code>: (å¯é€‰) éŸ³ä¹å¯¹åº”çš„å›¾ç‰‡åœ°å€</li><li><code>narrow</code>: ï¼ˆå¯é€‰ï¼‰æ’­æ”¾å™¨è¢–çé£æ ¼</li><li><code>autoplay</code>: (å¯é€‰) è‡ªåŠ¨æ’­æ”¾ï¼Œç§»åŠ¨ç«¯æµè§ˆå™¨æš‚æ—¶ä¸æ”¯æŒæ­¤åŠŸèƒ½</li><li><code>width</code>:xxx: (å¯é€‰) æ’­æ”¾å™¨å®½åº¦ (é»˜è®¤: 100%)</li><li><code>lrc</code>:xxx: ï¼ˆå¯é€‰ï¼‰æ­Œè¯æ–‡ä»¶ URL åœ°å€</li></ul><h4 id="hexo-github-card"><a class="header-anchor" href="#hexo-github-card">â¡ï¸</a>hexo-github-card</h4><div style="text-align: center">  <div class="github-card" data-user="Gisonrg" data-repo="hexo-github-card" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>ä½¿ç”¨è¿™ä¸ªæ’ä»¶å¯ä»¥åƒä¸Šé¢è¿™æ ·ğŸ‘†æ˜¾ç¤ºé€¼æ ¼è¾ƒé«˜çš„GitHubé“¾æ¥<br>ä½¿ç”¨æ—¶åªéœ€è¦æ’å…¥ä¸‹é¢ğŸ‘‡è¿™ä¸ªğŸ·ï¸å°±å¯ä»¥äº†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% githubCard user:your_user [repo:your_repo] [width:400] [height:200] [theme:default] [client_id:your_client_id] [client_secret:your_client_secret] [align:text-align_position] %&#125;</span><br><span class="line">//è¿™æ˜¯ä¸Šé¢é‚£ä¸ªå¡ç‰‡ğŸ·ï¸</span><br><span class="line">&#123;% githubCard user:Gisonrg repo:hexo-github-card %&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ’ä»¶çš„é»˜è®¤å®½åº¦æ„Ÿè§‰æœ‰ç‚¹ä¸å¤Ÿç¾è§‚ï¼Œæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦è‡ªå®šä¹‰å®½åº¦ä¹Ÿæœ‰ç‚¹è´¹äº‹ï¼Œè€Œä¸”é»˜è®¤æ‰“å¼€æ–¹å¼æ˜¯åœ¨å½“å‰é¡µé¢é¡µæ‰“å¼€å¾ˆä¸äººæ€§åŒ–ï¼Œå—ä¸äº†çš„è¯å¯ä»¥é€‰æ‹©ä¿®æ”¹æ–‡ä»¶</p><figure class="highlight javascript"><figcaption><span>node_modules/hexo-github-card/index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = argsObj.user,</span><br><span class="line">  repo = argsObj.repo,</span><br><span class="line">  width = argsObj.width || <span class="string">&#x27;100%&#x27;</span>,<span class="comment">//å®½åº¦è‡ªé€‚åº”</span></span><br><span class="line">  height = argsObj.height || <span class="string">&#x27;200&#x27;</span>,</span><br><span class="line">  theme = argsObj.theme || <span class="string">&#x27;default&#x27;</span>,</span><br><span class="line">  client_id = argsObj.client_id || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  client_secret = argsObj.client_secret || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  align = argsObj.align || <span class="string">&#x27;center&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> payload = &#123;</span><br><span class="line">  user,</span><br><span class="line">  repo,</span><br><span class="line">  height,</span><br><span class="line">  width,</span><br><span class="line">  theme,</span><br><span class="line">  client_id,</span><br><span class="line">  client_secret,</span><br><span class="line">  style: <span class="string">`text-align: <span class="subst">$&#123;align&#125;</span>`</span>,</span><br><span class="line">  target: <span class="string">&#x27;blank&#x27;</span>,<span class="comment">//åŠ ä¸Šè¿™ä¸ªå¯ä»¥åœ¨å…¶ä»–æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç”±äºç›´æ¥åœ¨åŸæ–‡ä»¶ä¸Šä¿®æ”¹ï¼Œåé¢å†è¿›è¡Œ<code>yarn</code>çš„ä¸€äº›ç›¸å…³æ“ä½œæ—¶<code>yarn</code>æ€»æ˜¯ä¼šè‡ªåŠ¨æŠŠä»£ç è¿˜åŸå›å»ï¼Œ<code>yarn</code>è¿˜ä¸æ”¯æŒ<code>ignore</code>åå•åŠŸèƒ½ï¼Œæˆ‘å°±åœ¨åŸæ¥çš„æ’ä»¶åŸºç¡€ä¸Šè¿›è¡Œäº†å°çš„ä¿®æ”¹ï¼Œä½¿å®ƒçš„é»˜è®¤å€¼é…ç½®æ›´åŠ äººæ€§åŒ–ä¸€ç‚¹ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´å¯ä»¥ç›´æ¥çœ‹çœ‹è¿™ä¸ªğŸ‘‡</p><div style="text-align: center">  <div class="github-card" data-user="l552121229" data-repo="hexo-github-card-customize" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>è¿™ä¸ªä¿®æ”¹è¿‡çš„æ’ä»¶å¯ä»¥é…ç½®é»˜è®¤è®¾ç½®</p><figure class="highlight yaml"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">github_card:</span></span><br><span class="line">  <span class="attr">width:</span> <span class="number">100</span><span class="string">%</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">200px</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">align:</span> <span class="string">center</span></span><br><span class="line">  <span class="attr">target:</span> <span class="string">blank</span></span><br></pre></td></tr></table></figure><h4 id="åŸºäºnextçš„æ’ä»¶"><a class="header-anchor" href="#åŸºäºnextçš„æ’ä»¶">â¡ï¸</a>åŸºäº<code>next</code>çš„æ’ä»¶</h4><div class="note warning"><p>æˆ‘ç°åœ¨ä½¿ç”¨çš„<code>next</code>æ˜¯<code>7.4.0</code>ç‰ˆæœ¬çš„ï¼Œä¸‹é¢çš„å‡ ä¸ªæ’ä»¶éƒ½æ˜¯åŸºäºè¿™ä¸ªç‰ˆæœ¬ç¡®è®¤å¯ç”¨çš„ï¼Œå…¶ä»–ç‰ˆæœ¬éœ€è¦å…·ä½“çœ‹ç›¸åº”çš„<code>GitHub</code>é“¾æ¥çš„è¯´æ˜</p></div><h5 id="theme-next-canvas-nest"><a class="header-anchor" href="#theme-next-canvas-nest">â¡ï¸</a>theme-next-canvas-nest</h5><div style="text-align: center">  <div class="github-card" data-user="theme-next" data-repo="theme-next-canvas-nest" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>è¿›å…¥ä¸»é¢˜ç›®å½•å¹¶cloneä»£ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd themes/next</span><br><span class="line">git clone https://github.com/theme-next/theme-next-canvas-nest source/lib/canvas-nest</span><br></pre></td></tr></table></figure><p>é…ç½®</p><figure class="highlight yaml"><figcaption><span>themes/next/_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span> <span class="comment"># display on mobile or not</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&#x27;0,0,255&#x27;</span> <span class="comment"># RGB values, use &#x27;,&#x27; to separate</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span> <span class="comment"># the opacity of line: 0~1</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">99</span> <span class="comment"># the number of lines</span></span><br></pre></td></tr></table></figure><p>æ›´æ–°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd themes/next/source/lib/canvas-nest</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><h5 id="theme-next-pjax"><a class="header-anchor" href="#theme-next-pjax">â¡ï¸</a>theme-next-pjax</h5><p>åœ¨<code>hexo</code>ä¸Šä½¿ç”¨<code>pjax</code>ï¼Œä¼˜åŒ–è®¿é—®é€Ÿåº¦ï¼Œè¿™ä¸ªæ’ä»¶åŸºäºä¸»é¢˜<code>next</code>å®ç°</p><div style="text-align: center">  <div class="github-card" data-user="theme-next" data-repo="theme-next-pjax" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>ä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd themes/next</span><br><span class="line">git clone https://github.com/theme-next/theme-next-pjax source/lib/pjax</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ–‡ä»¶</p><figure class="highlight yaml"><figcaption><span>themes/next/_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pjax:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">vendors:</span></span><br><span class="line">  <span class="string">...</span></span><br><span class="line">  <span class="attr">pjax:</span> <span class="string">//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js</span></span><br></pre></td></tr></table></figure><h4 id="æ¯”è¾ƒæœ‰æ„æ€çš„gitåº“"><a class="header-anchor" href="#æ¯”è¾ƒæœ‰æ„æ€çš„gitåº“">â¡ï¸</a>æ¯”è¾ƒæœ‰æ„æ€çš„gitåº“</h4><h5 id="91porn-php"><a class="header-anchor" href="#91porn-php">â¡ï¸</a>91porn_php</h5><div style="text-align: center">  <div class="github-card" data-user="zzjzz9266a" data-repo="91porn_php" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœé›†æ•´ç†å¸¸ç”¨çš„&lt;code&gt;hexo&lt;/code&gt;æ’ä»¶&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>gitæœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“</title>
    <link href="https://hexo.lilis.xin/posts/ac107f22/"/>
    <id>https://hexo.lilis.xin/posts/ac107f22/</id>
    <published>2019-09-11T09:50:25.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h4 id="git-åˆå§‹åŒ–"><a class="header-anchor" href="#git-åˆå§‹åŒ–">â¡ï¸</a>git åˆå§‹åŒ–</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git init #gitç›®å½•åˆå§‹åŒ–</span><br><span class="line">git init &lt;repo&gt; #æœ¬åœ°åˆå§‹åŒ–ï¼Œå¹¶ä¸”å»ºç«‹ä¸€ä¸ªåä¸ºrepoçš„ç©ºä»“åº“</span><br><span class="line">git init --bare #gitè£¸ä»“åº“åˆå§‹åŒ–</span><br><span class="line">git init --bare &lt;repo&gt; #æŒ‡å®šæŸä¸ªç›®å½•æˆä¸ºä¸­å¿ƒä»“åº“ï¼ˆè£¸ä»“åº“ï¼‰</span><br></pre></td></tr></table></figure><p><code>git init</code>è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª .git çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥è¿½è¸ªä»“åº“çš„æ‰€æœ‰å˜æ›´ã€‚<br><code>--bare</code>: ä½¿ç”¨ --bare å‚æ•°åˆå§‹åŒ–çš„ä»“åº“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºè£¸ä»“åº“ï¼Œ å› ä¸ºè¿™æ ·åˆ›å»ºçš„ä»“åº“å¹¶ä¸åŒ…å« å·¥ä½œåŒº ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„ Git å‘½ä»¤ã€‚</p><a id="more"></a><h5 id="å¯¹æ¯”"><a class="header-anchor" href="#å¯¹æ¯”">â¡ï¸</a>å¯¹æ¯”</h5><ul><li>ç›´æ¥ git init åˆ›å»ºçš„ä»“åº“:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">repositoryformatversion = 0</span><br><span class="line">filemode = true</span><br><span class="line">bare = false</span><br><span class="line">logallrefupdates = true</span><br><span class="line">ignorecase = true</span><br><span class="line">precomposeunicode = true</span><br></pre></td></tr></table></figure><ul><li>åŠ äº†<code>--bare</code>åˆ›å»ºçš„è£¸ä»“åº“:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[core]</span><br><span class="line">repositoryformatversion = 0</span><br><span class="line">filemode = true</span><br><span class="line">bare = true</span><br><span class="line">ignorecase = true</span><br><span class="line">precomposeunicode = true</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€ç›´è§‚çš„å·®å¼‚åœ¨äº<code>bare</code>é…ç½®é¡¹æ˜¯å¦ä¸º<code>true</code>ï¼Œ æ­¤å¤–ä¸åŠ <code>--bare</code>åˆ›å»ºçš„æœ¬åœ°ä»“åº“é…ç½®ä¸­æœ‰ä¸€é¡¹<code>logallrefupdates = true</code>, ä½œç”¨æ ¹æ®åå­—å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œ è®°å½•æ‰€æœ‰çš„<code>ref</code>(å¼•ç”¨) æ›´æ–°ï¼Œ å…³äº<code>ref</code>çš„éƒ¨åˆ†ä¹‹åæœ‰æ—¶é—´å¯ä»¥å†å†™ï¼Œè¿™ä¸ªé…ç½®å¯ä»¥ç†è§£ä¸ºæ˜¯ Git çš„ä¸€é“é˜²çº¿ã€‚</p><h4 id="åŠŸèƒ½å·®å¼‚"><a class="header-anchor" href="#åŠŸèƒ½å·®å¼‚">â¡ï¸</a>åŠŸèƒ½å·®å¼‚</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ä¾‹å­æ¼”ç¤ºä¸€ä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ç›´æ¥åˆ›å»ºæœ¬åœ°ä»“åº“</span></span><br><span class="line">git â¤ git init repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ›å»ºè£¸ä»“åº“</span></span><br><span class="line">git â¤  git init --bare repo.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ†åˆ« <span class="built_in">clone</span> ä¸¤ä¸ªä»“åº“</span></span><br><span class="line">git â¤ git clone repo test1</span><br><span class="line">æ­£å…‹éš†åˆ° &#x27;test1&#x27;...</span><br><span class="line">warning: æ‚¨ä¼¼ä¹å…‹éš†äº†ä¸€ä¸ªç©ºç‰ˆæœ¬åº“ã€‚</span><br><span class="line">å®Œæˆã€‚</span><br><span class="line">git â¤ git clone repo.git test2</span><br><span class="line">æ­£å…‹éš†åˆ° &#x27;test2&#x27;...</span><br><span class="line">warning: æ‚¨ä¼¼ä¹å…‹éš†äº†ä¸€ä¸ªç©ºç‰ˆæœ¬åº“ã€‚</span><br><span class="line">å®Œæˆã€‚</span><br><span class="line">git â¤</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ test1 ä»“åº“</span></span><br><span class="line">git â¤ cd test1</span><br><span class="line">test1 â¤ touch test                                                                                                                                                                                   git:master</span><br><span class="line">test1 â¤ git add .                                                                                                                                                                                   git:master*</span><br><span class="line">test1 â¤ git commit -m &#x27;æµ‹è¯•æäº¤&#x27;                                                                                                                                                                    git:master*</span><br><span class="line">[masterï¼ˆæ ¹æäº¤ï¼‰ 456cf23] æµ‹è¯•æäº¤</span><br><span class="line"> 1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 test</span><br><span class="line">test1 â¤ git push origin master                                                                                                                                                                       git:master</span><br><span class="line">Counting objects: 3, done.</span><br><span class="line">Writing objects: 100% (3/3), 217 bytes | 0 bytes/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">remote: error: refusing to update checked out branch: refs/heads/master</span><br><span class="line">remote: error: By default, updating the current branch in a non-bare repository</span><br><span class="line">remote: error: is denied, because it will make the index and work tree inconsistent</span><br><span class="line">remote: error: with what you pushed, and will require &#x27;git reset --hard&#x27; to match</span><br><span class="line">remote: error: the work tree to HEAD.</span><br><span class="line">remote: error:</span><br><span class="line">remote: error: You can set &#x27;receive.denyCurrentBranch&#x27; configuration variable to</span><br><span class="line">remote: error: &#x27;ignore&#x27; or &#x27;warn&#x27; in the remote repository to allow pushing into</span><br><span class="line">remote: error: its current branch; however, this is not recommended unless you</span><br><span class="line">remote: error: arranged to update its work tree to match what you pushed in some</span><br><span class="line">remote: error: other way.</span><br><span class="line">remote: error:</span><br><span class="line">remote: error: To squelch this message and still keep the default behaviour, set</span><br><span class="line">remote: error: &#x27;receive.denyCurrentBranch&#x27; configuration variable to &#x27;refuse&#x27;.</span><br><span class="line">To /home/git/repo</span><br><span class="line"> ! [remote rejected] master -&gt; master (branch is currently checked out)</span><br><span class="line">error: æ— æ³•æ¨é€ä¸€äº›å¼•ç”¨åˆ° &#x27;/home/git/repo&#x27;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿›å…¥ test2 ä»“åº“é‡å¤æ‰§è¡Œ</span></span><br><span class="line">test1 â¤ cd ../test2                                                                                                                                                                                  git:master</span><br><span class="line">test2 â¤ touch test                                                                                                                                                                                   git:master</span><br><span class="line">test2 â¤ git add .                                                                                                                                                                                   git:master*</span><br><span class="line">test2 â¤ git commit -m &#x27;å†æ¬¡æµ‹è¯•æäº¤&#x27;                                                                                                                                                                git:master*</span><br><span class="line">[masterï¼ˆæ ¹æäº¤ï¼‰ c56efe8] å†æ¬¡æµ‹è¯•æäº¤</span><br><span class="line"> 1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 test</span><br><span class="line">test2 â¤ git push origin master                                                                                                                                                                       git:master</span><br><span class="line">Counting objects: 3, done.</span><br><span class="line">Writing objects: 100% (3/3), 223 bytes | 0 bytes/s, done.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To /home/git/repo.git</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">test2 â¤</span><br></pre></td></tr></table></figure><p>ä»è£¸ä»“åº“ä¸­<code>clone</code>ä¸‹æ¥çš„æœ¬åœ°ä»“åº“å¯ä»¥æ­£å¸¸çš„<code>push</code>æ“ä½œï¼Œè¿™ä¹Ÿæ­£æ˜¯è£¸ä»“åº“çš„å­˜åœ¨æ„ä¹‰</p><p>åŸæ–‡é“¾æ¥ï¼š<br><a href="https://moelove.info/2016/12/04/Git-%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E5%92%8C%E8%A3%B8%E4%BB%93%E5%BA%93/" title="Git æœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“">Git æœ¬åœ°ä»“åº“å’Œè£¸ä»“åº“</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;git-åˆå§‹åŒ–&quot;&gt;&lt;a class=&quot;header-anchor&quot; href=&quot;#git-åˆå§‹åŒ–&quot;&gt;â¡ï¸&lt;/a&gt;git åˆå§‹åŒ–&lt;/h4&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git init #gitç›®å½•åˆå§‹åŒ–&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init &amp;lt;repo&amp;gt; #æœ¬åœ°åˆå§‹åŒ–ï¼Œå¹¶ä¸”å»ºç«‹ä¸€ä¸ªåä¸ºrepoçš„ç©ºä»“åº“&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init --bare #gitè£¸ä»“åº“åˆå§‹åŒ–&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git init --bare &amp;lt;repo&amp;gt; #æŒ‡å®šæŸä¸ªç›®å½•æˆä¸ºä¸­å¿ƒä»“åº“ï¼ˆè£¸ä»“åº“ï¼‰&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;git init&lt;/code&gt;è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåä¼šåœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ª .git çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥è¿½è¸ªä»“åº“çš„æ‰€æœ‰å˜æ›´ã€‚&lt;br&gt;
&lt;code&gt;--bare&lt;/code&gt;: ä½¿ç”¨ --bare å‚æ•°åˆå§‹åŒ–çš„ä»“åº“ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºè£¸ä»“åº“ï¼Œ å› ä¸ºè¿™æ ·åˆ›å»ºçš„ä»“åº“å¹¶ä¸åŒ…å« å·¥ä½œåŒº ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„ Git å‘½ä»¤ã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>git æ“ä½œ</title>
    <link href="https://hexo.lilis.xin/posts/150d1834/"/>
    <id>https://hexo.lilis.xin/posts/150d1834/</id>
    <published>2019-09-11T07:36:04.000Z</published>
    <updated>2019-09-19T09:52:52.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æ”¶é›†ä¸€äº›ä¸æ€ä¹ˆå¸¸ç”¨çš„<code>git</code>æ“ä½œï¼Œä»¥åšè®°å½•</p><a id="more"></a><h3 id="git-åˆå¹¶æ“ä½œ"><a class="header-anchor" href="#git-åˆå¹¶æ“ä½œ">â¡ï¸</a>git åˆå¹¶æ“ä½œ</h3><p>é€šè¿‡<code>git log</code>æŸ¥çœ‹æäº¤è®°å½•åŠå…¶commitId<br>å†é€šè¿‡<code>git reset --soft commitId</code>æ¥å›é€€ç‰ˆæœ¬(â€“soft å’Œ --hardçš„åŒºåˆ«å°±æ˜¯ --softæ˜¯è½¯å›é€€ï¼Œä¼šå°†ä½ è¿™æ¬¡commitIdä¹‹åçš„æäº¤å…¨éƒ¨å›é€€åˆ°æš‚å­˜åŒºä¸­ï¼Œâ€“hardä¼šå°†ä½ <br>è¿™æ¬¡commitIdä¹‹åçš„æäº¤å…¨éƒ¨æ¸…é™¤æ‰)<br>æ­¤æ—¶ä½ è¿™æ¬¡commitIdä¹‹åçš„æäº¤éƒ½ä¼šå›åˆ°æš‚å­˜åŒºä¸­<br>git commit -m éšä¾¿å†™æ³¨é‡Š</p><h3 id="git-å¿½ç•¥æ–‡ä»¶æ“ä½œ"><a class="header-anchor" href="#git-å¿½ç•¥æ–‡ä»¶æ“ä½œ">â¡ï¸</a>git å¿½ç•¥æ–‡ä»¶æ“ä½œ</h3><p><code>git</code>å¿½ç•¥æ–‡ä»¶æ–‡ä»¶å¯ä»¥ç”¨<code>.gitignore</code>æ–‡ä»¶æ¥å®ç°ï¼Œä½†å¦‚æœä¸€ä¸ªæ–‡ä»¶å·²ç»è¢«è·Ÿè¸ªï¼Œå†åŠ å…¥<code>.gitignore</code>æ–‡ä»¶å°±æ— æ•ˆäº†ã€‚<br>è¿™æ—¶å¯ä»¥<code>git rm --cached</code>ï¼Œå†æ›´æ–°<code>.gitignore</code>ï¼Œå¿½ç•¥æ‰ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åå†æäº¤ã€‚<br>ä½¿ç”¨å‘½ä»¤<code>git update-index --assume-unchanged æ–‡ä»¶</code>æ¥æ ‡è®°æ–‡ä»¶ï¼Œä½¿<code>git</code>åœæ­¢å…³æ³¨è¿™ä¸ªéœ€è¦è¢«å¿½ç•¥çš„æ–‡ä»¶ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è¾¾æˆæ•ˆæœï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ç§ä¸åˆç†ä¸è§„èŒƒçš„åšæ³•ã€‚<br>åŸå› å¦‚ä¸‹ï¼š<br>é¦–å…ˆï¼Œ<code>git update-index</code>çš„å®šä¹‰æ˜¯ï¼š</p><div class="note primary"><p>Register file contents in the working tree to the indexï¼ˆæŠŠå·¥ä½œåŒºä¸‹çš„æ–‡ä»¶å†…å®¹æ³¨å†Œåˆ°ç´¢å¼•åŒºï¼‰</p></div><p>ä¹Ÿå°±æ˜¯è¯´<code>update-index</code>é’ˆå¯¹çš„æ˜¯<code>git</code>æ•°æ®åº“é‡Œè¢«è®°å½•çš„æ–‡ä»¶ï¼Œè€Œä¸æ˜¯é‚£äº›éœ€è¦å¿½ç•¥çš„æ–‡ä»¶ã€‚<br>æ¥ç€çœ‹å…³äº<code>--assume-unchanged</code>çš„æè¿°ï¼š</p><div class="note primary"><p>When the â€œassume unchangedâ€ bit is on, Git stops checking the working tree files for possible modifications, so you need to manually unset the bit to tell Git when you change the working tree file. This is sometimes helpful when working with a big project on a filesystem that has very slow lstat(2) system call (e.g. cifs).<br>åº”ç”¨äº†è¯¥æ ‡è¯†ä¹‹åï¼ŒGit åœæ­¢æŸ¥çœ‹å·¥ä½œåŒºæ–‡ä»¶å¯èƒ½å‘ç”Ÿçš„æ”¹å˜ï¼Œæ‰€ä»¥ä½ å¿…é¡» æ‰‹åŠ¨ é‡ç½®è¯¥æ ‡è¯†ä»¥ä¾¿ Git çŸ¥é“ä½ æƒ³è¦æ¢å¤å¯¹æ–‡ä»¶æ”¹å˜çš„è¿½è¸ªã€‚å½“ä½ å·¥ä½œåœ¨ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™åœ¨æ–‡ä»¶ç³»ç»Ÿçš„<code>lstat</code>ç³»ç»Ÿè°ƒç”¨éå¸¸è¿Ÿé’çš„æ—¶å€™ä¼šå¾ˆæœ‰ç”¨ã€‚</p></div><p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå‘½ä»¤æœ¬èº«åªæ˜¯ä¸€ç§è®©<code>git</code>æš‚æ—¶å¿½ç•¥æ–‡ä»¶å˜åŠ¨çš„æ“ä½œã€‚<br>ä¸»è¦æ˜¯åœ¨ä¿®æ”¹ä¸€äº›å¤§å‹æ–‡ä»¶æ—¶ï¼Œé˜²æ­¢<code>git</code>æ¥å›è®¡ç®—æ–‡ä»¶å˜åŒ–å¹¶æ›´æ–°å·¥ä½œåŒºé€ æˆå¡é¡¿ã€‚<br><code>git update-index --assume-unchanged</code>çš„å®˜æ–¹æ¨èç”¨æ³•æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>ä½ æ­£åœ¨ä¿®æ”¹ä¸€ä¸ªå·¨å¤§çš„æ–‡ä»¶ï¼Œä½ å…ˆå¯¹å…¶<code>git update-index --assume-unchanged</code>ï¼Œè¿™æ ·<code>Git</code>æš‚æ—¶ä¸ä¼šç†ç¬ä½ å¯¹æ–‡ä»¶åšçš„ä¿®æ”¹ï¼›</li><li>å½“ä½ çš„å·¥ä½œå‘Šä¸€æ®µè½å†³å®šå¯ä»¥æäº¤çš„æ—¶å€™ï¼Œé‡ç½®æ”¹æ ‡è¯†ï¼š<code>git update-index --no-assume-unchanged</code>ï¼Œäºæ˜¯<code>Git</code>åªéœ€è¦åšä¸€æ¬¡æ›´æ–°ï¼Œè¿™æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„äº†ï¼›</li><li>æäº¤æ¨é€ã€‚</li></ol><p>å¦å¤–ï¼Œæ ¹æ®æ–‡æ¡£çš„è¿›ä¸€æ­¥æè¿°ï¼š</p><div class="note primary"><p>This option can be also used as a coarse file-level mechanism to ignore uncommitted changes in tracked files (akin to what .gitignore does for untracked files).</p></div><p>ä¹Ÿå°±æ˜¯è¯´å®˜æ–¹å¹¶ä¸æ¨èè¿™ç§åšæ³•ï¼Œæ ·çš„äº‹æƒ…æ›´åº”è¯¥ç”¨<code>.gitignore</code>æ–‡ä»¶æ¥å®ç°ï¼ˆé’ˆå¯¹æœªè¿½è¸ªçš„æ–‡ä»¶ï¼‰ã€‚<br>éšä¹‹è€Œæ¥çš„æ–°é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆå·²ç»è¢«è·Ÿè¸ªçš„æ–‡ä»¶<code>.gitignore</code>ä¼šå¤±å»æ•ˆæœï¼Ÿ<br>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¯¯è§£äº†<code>.gitignore</code>æ–‡ä»¶çš„ç”¨é€”ï¼Œè¯¥æ–‡ä»¶åªèƒ½ä½œç”¨äº<code>Untracked Files</code>ï¼Œä¹Ÿå°±æ˜¯é‚£äº›ä»æ¥æ²¡æœ‰è¢«<code>git</code>è®°å½•è¿‡çš„æ–‡ä»¶ï¼ˆè‡ªæ·»åŠ ä»¥åï¼Œä»æœª add åŠ commit è¿‡çš„æ–‡ä»¶ï¼‰ã€‚<br>ä¹‹æ‰€ä»¥ä½ çš„è§„åˆ™ä¸ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºé‚£äº›æ–‡ä»¶æ›¾ç»è¢«<code>git</code>è®°å½•è¿‡ï¼Œå› æ­¤<code>.gitignore</code>å¯¹å®ƒä»¬å®Œå…¨æ— æ•ˆã€‚<br>å› æ­¤ï¼Œæ­£ç¡®çš„åšæ³•åº”è¯¥å…ˆæ˜¯<code>git rm --cached</code>ï¼Œå†æ›´æ–°<code>.gitignore</code>ï¼Œå¿½ç•¥æ‰ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åå†æäº¤ã€‚</p><h3 id="git-æ’¤å›åˆå¹¶"><a class="header-anchor" href="#git-æ’¤å›åˆå¹¶">â¡ï¸</a>git æ’¤å›åˆå¹¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge --abort</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ”¶é›†ä¸€äº›ä¸æ€ä¹ˆå¸¸ç”¨çš„&lt;code&gt;git&lt;/code&gt;æ“ä½œï¼Œä»¥åšè®°å½•&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>åŸºäºRedisçš„GeoHashåœ¨PHPä¸Šçš„åº”ç”¨</title>
    <link href="https://hexo.lilis.xin/posts/3dd74411/"/>
    <id>https://hexo.lilis.xin/posts/3dd74411/</id>
    <published>2018-11-29T07:26:08.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>GeoHashæœ‰ç€ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹</p><ol><li>GeoHashç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºç»åº¦å’Œçº¬åº¦ä¸¤ä¸ªåæ ‡,ä¾¿äºåŠ ä¸Šç´¢å¼•.</li><li>GeoHashè¡¨ç¤ºçš„å¹¶ä¸æ˜¯ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸ.</li><li>ç¼–ç çš„å‰ç¼€å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„åŒºåŸŸ, å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡ŒåŒºåŸŸæ£€ç´¢, èšåˆç­‰ç›¸å…³æ“ä½œ.</li></ol><p>ç»¼ä¸Šæ‰€è¿°, GeoHashæ¯”ç›´æ¥ç”¨ç»çº¬åº¦çš„é«˜æ•ˆå¾ˆå¤š.</p><a id="more"></a><h3 id="GeoHashç®—æ³•"><a class="header-anchor" href="#GeoHashç®—æ³•">â¡ï¸</a>GeoHashç®—æ³•</h3><p>ç¼–ç </p><ul><li><p>GeoHashé¦–å…ˆå°†ç²¾åº¦èŒƒå›´è®¾å®šä¸ºåˆ’åˆ†æˆä¸¤ä¸ªåŒºé—´(-180, 0), (0, 180), å¦‚æœç»åº¦åæ ‡è½åˆ°äº†å‰ä¸€ä¸ªåŒºé—´åˆ™æ ‡è®°ä¸º0, åä¹‹åˆ™æ ‡è®°ä¸º1.</p></li><li><p>ç„¶åå†å°†ä¸Šä¸€æ­¥è·å¾—åˆ°çš„åŒºé—´åˆ’åˆ†æˆä¸¤ä¸ªåŒºé—´, é‡å¤ä¸Šä¸€æ­¥.</p></li><li><p>é‡å¤å‰å‰ä¸¤æ­¥ç›´åˆ°å¾—åˆ°è‡ªå·±æ‰€éœ€è¦çš„ç²¾åº¦</p></li><li><p>ä»¥æ­¤ç±»æ¨æ¥å¾—åˆ°çº¬åº¦çš„HashBin (å…³äºçº¬åº¦çš„åˆå§‹åˆ’åˆ†åŒºé—´, ä¸€èˆ¬çš„å…±ç”¨ç®—æ³•é‡Œéƒ½æ˜¯Â±90, è€Œredisé‡Œç”¨çš„å´æ˜¯Â±85.05112878)<br>å¦‚ (23.17015353059966287, 113.46623629331588745) é€šè¿‡åŒºé—´åˆ’åˆ†å¯ä»¥å¾—åˆ°:<br>(1101000010101111111001011110, 101000101101111011011100011)</p></li><li><p>æ¥ä¸‹æ¥æ˜¯å¯¹åˆ’åˆ†ç»“æœçš„åˆå¹¶, æŒ‰ç…§<code>å¥‡æ•°ä½æ˜¯çº¬åº¦, å¶æ•°ä½ä¸ºç»åº¦</code>çš„åŸåˆ™æ¥è¿›è¡Œåˆå¹¶.<br>ä¸Šé¢çš„ä¾‹å­åˆå¹¶å¯å¾—:<br>1110011000000100110110011111111011111001011100101011110</p></li><li><p>ä¹‹åå†æŒ‰ç…§éæ ‡å‡†çš„base32ç®—æ³•è¿›è¡Œå­—ç¬¦ä¸²çš„è½¬åŒ–, ä¸‹é¢æ˜¯å¯¹ç…§è¡¨æ ¼</p></li></ul><table><thead><tr><th>åè¿›åˆ¶</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td>äºŒè¿›åˆ¶</td><td>00000</td><td>00001</td><td>00010</td><td>00011</td><td>00100</td><td>00101</td><td>00110</td><td>00111</td><td>01000</td><td>01001</td><td>01010</td><td>01011</td><td>01100</td><td>01101</td><td>01110</td><td>01111</td></tr><tr><td>base32</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td></tr><tr><td>åè¿›åˆ¶</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td></tr><tr><td>äºŒè¿›åˆ¶</td><td>10000</td><td>10001</td><td>10010</td><td>10011</td><td>10100</td><td>10101</td><td>10110</td><td>10111</td><td>11000</td><td>11001</td><td>11010</td><td>11011</td><td>11100</td><td>11101</td><td>11110</td><td>11111</td></tr><tr><td>base32</td><td>h</td><td>j</td><td>k</td><td>m</td><td>n</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>u</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td></tr></tbody></table><p>æœ€ç»ˆ(23.17015353059966287, 113.46623629331588745)è¢«è½¬åŒ–æˆâ€™ws2emzrtfbyâ€™.</p><p>è§£ç åˆ™å’Œç¼–ç æ­£å¥½ç›¸åå³å¯.</p><h3 id="PHPçš„å®ç°"><a class="header-anchor" href="#PHPçš„å®ç°">â¡ï¸</a>PHPçš„å®ç°</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geohash</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$coding</span>    = <span class="string">&#x27;0123456789bcdefghjkmnpqrstuvwxyz&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$codingMap</span> = [</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span> =&gt; <span class="string">&#x27;00000&#x27;</span>, <span class="string">&#x27;1&#x27;</span> =&gt; <span class="string">&#x27;00001&#x27;</span>, <span class="string">&#x27;2&#x27;</span> =&gt; <span class="string">&#x27;00010&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;3&#x27;</span> =&gt; <span class="string">&#x27;00011&#x27;</span>, <span class="string">&#x27;4&#x27;</span> =&gt; <span class="string">&#x27;00100&#x27;</span>, <span class="string">&#x27;5&#x27;</span> =&gt; <span class="string">&#x27;00101&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;6&#x27;</span> =&gt; <span class="string">&#x27;00110&#x27;</span>, <span class="string">&#x27;7&#x27;</span> =&gt; <span class="string">&#x27;00111&#x27;</span>, <span class="string">&#x27;8&#x27;</span> =&gt; <span class="string">&#x27;01000&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;9&#x27;</span> =&gt; <span class="string">&#x27;01001&#x27;</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="string">&#x27;01010&#x27;</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="string">&#x27;01011&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;d&#x27;</span> =&gt; <span class="string">&#x27;01100&#x27;</span>, <span class="string">&#x27;e&#x27;</span> =&gt; <span class="string">&#x27;01101&#x27;</span>, <span class="string">&#x27;f&#x27;</span> =&gt; <span class="string">&#x27;01110&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;g&#x27;</span> =&gt; <span class="string">&#x27;01111&#x27;</span>, <span class="string">&#x27;h&#x27;</span> =&gt; <span class="string">&#x27;10000&#x27;</span>, <span class="string">&#x27;j&#x27;</span> =&gt; <span class="string">&#x27;10001&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;k&#x27;</span> =&gt; <span class="string">&#x27;10010&#x27;</span>, <span class="string">&#x27;m&#x27;</span> =&gt; <span class="string">&#x27;10011&#x27;</span>, <span class="string">&#x27;n&#x27;</span> =&gt; <span class="string">&#x27;10100&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;p&#x27;</span> =&gt; <span class="string">&#x27;10101&#x27;</span>, <span class="string">&#x27;q&#x27;</span> =&gt; <span class="string">&#x27;10110&#x27;</span>, <span class="string">&#x27;r&#x27;</span> =&gt; <span class="string">&#x27;10111&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;s&#x27;</span> =&gt; <span class="string">&#x27;11000&#x27;</span>, <span class="string">&#x27;t&#x27;</span> =&gt; <span class="string">&#x27;11001&#x27;</span>, <span class="string">&#x27;u&#x27;</span> =&gt; <span class="string">&#x27;11010&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;v&#x27;</span> =&gt; <span class="string">&#x27;11011&#x27;</span>, <span class="string">&#x27;w&#x27;</span> =&gt; <span class="string">&#x27;11100&#x27;</span>, <span class="string">&#x27;x&#x27;</span> =&gt; <span class="string">&#x27;11101&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;y&#x27;</span> =&gt; <span class="string">&#x27;11110&#x27;</span>, <span class="string">&#x27;z&#x27;</span> =&gt; <span class="string">&#x27;11111&#x27;</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$hash</span>, <span class="variable">$number</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$number</span>) &#123;</span><br><span class="line">            <span class="variable">$binary</span> = base_convert(<span class="variable">$hash</span>, <span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$binary</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$hl</span>     = strlen(<span class="variable">$hash</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$hl</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">                <span class="variable">$binary</span> .= <span class="built_in">self</span>::<span class="variable">$codingMap</span>[substr(<span class="variable">$hash</span>,<span class="variable">$i</span>,<span class="number">1</span>)];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$bl</span>    = strlen(<span class="variable">$binary</span>);</span><br><span class="line">        <span class="variable">$blat</span>  = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$blong</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–å‡ºç»çº¬åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$bl</span>; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$i</span>%<span class="number">2</span>)</span><br><span class="line">                <span class="variable">$blat</span>  = <span class="variable">$blat</span>.substr(<span class="variable">$binary</span>,<span class="variable">$i</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="variable">$blong</span> = <span class="variable">$blong</span>.substr(<span class="variable">$binary</span>,<span class="variable">$i</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¿»è¯‘ç»çº¬åº¦</span></span><br><span class="line">        <span class="keyword">list</span>(</span><br><span class="line">            <span class="variable">$lat</span>,</span><br><span class="line">            <span class="variable">$latErr</span></span><br><span class="line">            ) = <span class="built_in">self</span>::binDecode(<span class="variable">$blat</span>,<span class="number">-85.05112878</span>,<span class="number">85.05112878</span>);</span><br><span class="line">        <span class="keyword">list</span>(</span><br><span class="line">            <span class="variable">$long</span>,</span><br><span class="line">            <span class="variable">$longErr</span></span><br><span class="line">            ) = <span class="built_in">self</span>::binDecode(<span class="variable">$blong</span>,<span class="number">-180</span>,<span class="number">180</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç²¾åº¦å¤„ç†</span></span><br><span class="line">        <span class="variable">$latPlaces</span>  = max(<span class="number">1</span>, -round(log10(<span class="variable">$latErr</span>))) - <span class="number">1</span>;</span><br><span class="line">        <span class="variable">$longPlaces</span> = max(<span class="number">1</span>, -round(log10(<span class="variable">$longErr</span>))) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$lat</span>        = round(<span class="variable">$lat</span>, <span class="variable">$latPlaces</span>);</span><br><span class="line">        <span class="variable">$long</span>       = round(<span class="variable">$long</span>, <span class="variable">$longPlaces</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$lat</span>, <span class="variable">$long</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">hash2num</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$hash</span>, <span class="variable">$bin</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$binary</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$hl</span>     = strlen(<span class="variable">$hash</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$hl</span>; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$binary</span> .= <span class="built_in">self</span>::<span class="variable">$codingMap</span>[substr(<span class="variable">$hash</span>,<span class="variable">$i</span>,<span class="number">1</span>)];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$bin</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$binary</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> base_convert(substr(<span class="variable">$binary</span>, <span class="number">0</span>, <span class="number">52</span>), <span class="number">2</span>, <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åæ ‡è½¬åŒ–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $lat</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $long</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$lat</span>, <span class="variable">$long</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">bool</span> <span class="variable">$number</span> = <span class="literal">false</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) :<span class="title">string</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è®¡ç®—latç²¾åº¦</span></span><br><span class="line">        <span class="variable">$latbits</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="variable">$err</span>     = <span class="number">45</span>;</span><br><span class="line">        <span class="variable">$plat</span>    = <span class="built_in">self</span>::precision(<span class="variable">$lat</span>);</span><br><span class="line">        <span class="comment">//è®¡ç®—è®¡ç®—æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$err</span> &gt; <span class="variable">$plat</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$err</span>     /= <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$latbits</span> ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$longbits</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="variable">$err</span>      = <span class="number">90</span>;</span><br><span class="line">        <span class="variable">$plong</span>    = <span class="built_in">self</span>::precision(<span class="variable">$long</span>);</span><br><span class="line">        <span class="keyword">while</span>(<span class="variable">$err</span> &gt; <span class="variable">$plong</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$err</span>      /= <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$longbits</span> ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$bits</span>     = max(<span class="variable">$latbits</span>, <span class="variable">$longbits</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$longbits</span> = <span class="variable">$bits</span>;</span><br><span class="line">        <span class="variable">$latbits</span>  = <span class="variable">$bits</span>;</span><br><span class="line">        <span class="variable">$addlong</span>  = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸ºäº†å¯ä»¥è¿›è¡Œåˆå¹¶å¡«å……æ•°ä½ 2^5 = 32</span></span><br><span class="line">        <span class="keyword">while</span> ((<span class="variable">$longbits</span>+<span class="variable">$latbits</span>)%<span class="number">5</span> != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$longbits</span> += <span class="variable">$addlong</span>;</span><br><span class="line">            <span class="variable">$latbits</span>  += !<span class="variable">$addlong</span>;</span><br><span class="line">            <span class="variable">$addlong</span>  = !<span class="variable">$addlong</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$blat</span>     = <span class="built_in">self</span>::binEncode(<span class="variable">$lat</span>,<span class="number">90</span>, <span class="number">90</span>, <span class="variable">$latbits</span>);</span><br><span class="line">        <span class="variable">$blong</span>    = <span class="built_in">self</span>::binEncode(<span class="variable">$long</span>, <span class="number">-180</span>, <span class="number">180</span>, <span class="variable">$longbits</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$binary</span>  = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$uselong</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="variable">$strlen</span>  = strlen(<span class="variable">$blat</span>) + strlen(<span class="variable">$blong</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆå¹¶ä½æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$strlen</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$uselong</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$binary</span> .= substr(<span class="variable">$blong</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                <span class="variable">$blong</span>  = substr(<span class="variable">$blong</span>,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$binary</span> .= substr(<span class="variable">$blat</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                <span class="variable">$blat</span>   = substr(<span class="variable">$blat</span>,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$uselong</span> = !<span class="variable">$uselong</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$number</span>)</span><br><span class="line">            <span class="keyword">return</span> bindec(substr(<span class="variable">$binary</span>, <span class="number">0</span>, <span class="number">52</span>));</span><br><span class="line"></span><br><span class="line">        <span class="variable">$hash</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$leng</span> = strlen(<span class="variable">$binary</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="variable">$leng</span>; <span class="variable">$i</span>+=<span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$n</span>    = bindec(substr(<span class="variable">$binary</span>,<span class="variable">$i</span>,<span class="number">5</span>));</span><br><span class="line">            <span class="variable">$hash</span> = <span class="variable">$hash</span>. <span class="built_in">self</span>::<span class="variable">$coding</span>[<span class="variable">$n</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$hash</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¡ç®—ç²¾åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> float $number</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> float|int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">precision</span>(<span class="params"><span class="keyword">float</span> <span class="variable">$number</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$precision</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$pt</span>        = strpos(<span class="variable">$number</span>,<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pt</span> !== <span class="literal">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$precision</span> = - (strlen(<span class="variable">$number</span>) - <span class="variable">$pt</span> - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pow(<span class="number">10</span>, <span class="variable">$precision</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">binEncode</span>(<span class="params"><span class="variable">$number</span>, <span class="variable">$min</span>, <span class="variable">$max</span>, <span class="variable">$bitcount</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$bitcount</span> == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable">$mid</span> = bcdiv(bcadd(<span class="variable">$min</span>, <span class="variable">$max</span>, <span class="number">52</span>), <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">        <span class="keyword">if</span> (bccomp(<span class="variable">$number</span>, <span class="variable">$mid</span>, <span class="number">52</span>) == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span>. <span class="built_in">self</span>::binEncode(</span><br><span class="line">                <span class="variable">$number</span>, <span class="variable">$mid</span>,</span><br><span class="line">                <span class="variable">$max</span>,<span class="variable">$bitcount</span><span class="number">-1</span></span><br><span class="line">            );</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span>. <span class="built_in">self</span>::binEncode(</span><br><span class="line">                <span class="variable">$number</span>, <span class="variable">$min</span>,</span><br><span class="line">                <span class="variable">$mid</span>,<span class="variable">$bitcount</span><span class="number">-1</span></span><br><span class="line">            );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">binDecode</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$binary</span>, <span class="variable">$min</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$max</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">        <span class="variable">$binlen</span> = strlen(<span class="variable">$binary</span>);</span><br><span class="line">        <span class="variable">$err</span>    = bcsub(<span class="variable">$max</span>, <span class="variable">$min</span>, <span class="number">52</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$binlen</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$bit</span> = substr(<span class="variable">$binary</span>,<span class="variable">$i</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="variable">$mid</span> = bcdiv(bcadd(<span class="variable">$min</span>, <span class="variable">$max</span>, <span class="number">52</span>), <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">            <span class="variable">$err</span> = bcdiv(<span class="variable">$err</span>, <span class="number">2</span>, <span class="number">52</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$bit</span> == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="variable">$min</span> = <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$max</span> = <span class="variable">$mid</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$mid</span>, <span class="variable">$err</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Redisä¸Šçš„åº”ç”¨"><a class="header-anchor" href="#Redisä¸Šçš„åº”ç”¨">â¡ï¸</a>Redisä¸Šçš„åº”ç”¨</h3><p>Redisçš„GEOç‰¹æ€§åœ¨<code>Redis 3.2</code>ç‰ˆæœ¬é‡Šå‡º,è¿™ä¸ªåŠŸèƒ½å¯ä»¥å°†ç”¨æˆ·ç»™å®šçš„åœ°ç†ä½ç½®ä¿¡æ¯å‚¨å­˜èµ·æ¥,å¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œæ“ä½œ.</p><p><code>GEOADD</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOADD key longitude latitude name [longitude latitude name ...]</span><br></pre></td></tr></table></figure><p>GEOADD å‘½ä»¤æ¯æ¬¡å¯ä»¥æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªç»çº¬åº¦åœ°ç†ä½ç½®ã€‚ å…¶ä¸­<code>key</code>ä¸ºå‚¨å­˜åœ°ç†ä½ç½®çš„é›†åˆï¼Œ è€Œ <code>longitude</code> ã€ <code>latitude</code> å’Œ <code>name</code> åˆ™åˆ†åˆ«ä¸ºåœ°ç†ä½ç½®çš„ç»åº¦ã€çº¬åº¦ã€åå­—.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; GEOADD geo_test 113.46623629331588745 23.17015353059966287 test_1 113.46620947122573853 23.17010790561879929 test_2</span><br></pre></td></tr></table></figure><p><code>GEOPOS</code><br><code>GEOPOS</code> å‘½ä»¤å¯ä»¥è·å–Geoçš„åæ ‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOPOS key name [name ...]</span><br></pre></td></tr></table></figure><p>å¦‚:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geopos geo_test test_2</span><br><span class="line">1) 1) &quot;113.46620947122573853&quot;</span><br><span class="line">   2) &quot;23.17010790561879929&quot;</span><br></pre></td></tr></table></figure><p><code>GEODIST</code><br>è®¡ç®—ä¸¤ä¸ªåæ ‡ç‚¹ä¹‹é—´çš„è·ç¦»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEODIST key location-x location-y [unit]</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>unit</code>è¡¨ç¤ºå•ä½ é»˜è®¤ä¸º <code>m</code></p><ul><li><code>m</code> è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li><li><code>km</code> è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li><li><code>mi</code> è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li><li><code>ft</code> è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li></ul><p><code>GEORADIUS</code> å’Œ <code>GEORADIUSBYMEMBER</code><br>è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½æ˜¯è·å–ä¸€å®šèŒƒå›´å†…çš„åæ ‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GEORADIUS key longitude latitude radius m|km|ft|mi[WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC] [STORE key] [STOREDIST key]</span><br><span class="line">GEORADIUSBYMEMBER key location radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC] [STORE key] [STOREDIST key]</span><br></pre></td></tr></table></figure><ul><li><code>WITHCOORD</code> åœ¨è¿”å›åŒ¹é…çš„ä½ç½®æ—¶ä¼šå°†ä½ç½®çš„ç»çº¬åº¦ä¸€å¹¶è¿”å›.</li><li><code>WITHDIST</code> æŒ‡å®šä¸­å¿ƒè¿”å›é¡¹ç›®çš„è·ç¦», è·ç¦»ä»¥ä¸æŒ‡å®šä¸ºå‘½ä»¤çš„radiuså‚æ•°çš„å•ä½ç›¸åŒçš„å•ä½è¿”å›.</li><li><code>WITHHASH</code> è¿˜ä»¥52ä½æ— ç¬¦å·æ•´æ•°çš„å½¢å¼è¿”å›é¡¹çš„åŸå§‹geohashç¼–ç çš„æœ‰åºé›†åˆ†æ•°</li><li><code>ASC|DESC</code> <code>ASC</code> å¯ä»¥è®©æŸ¥æ‰¾ç»“æœæ ¹æ®è·ç¦»ä»è¿‘åˆ°è¿œæ’åºï¼Œ è€Œ <code>DESC</code> åˆ™å¯ä»¥è®©æŸ¥æ‰¾ç»“æœæ ¹æ®ä»è¿œåˆ°è¿‘æ’åº</li><li><code>COUNT</code> æŒ‡å®šè¦è¿”å›çš„ç»“æœæ•°é‡</li><li><code>STORE key</code> ç»“æœå­˜åˆ°æ–°çš„æœ‰åºé›†åˆä¸­, ä»¥<code>GeoHash</code>å€¼åš<code>score</code>, è¯¥é€‰é¡¹ä¸<code>WITH[DIST|COORD|HASH]</code>é€‰é¡¹å†²çª</li><li><code>STOREDIST key</code> ç»“æœå­˜åˆ°æ–°çš„æœ‰åºé›†åˆä¸­, ä»¥ä¸æŒ‡å®šä½ç½®çš„è·ç¦»ä½œ<code>score</code>,  è¯¥é€‰é¡¹ä¸<code>WITH[DIST|COORD|HASH]</code>é€‰é¡¹å†²çª</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; georadius key 113.46620947122573853 23.17010790561879929 100 km WITHCOORD WITHDIST</span><br><span class="line">1) 1) &quot;test_2&quot;</span><br><span class="line">   2) &quot;0.0000&quot;</span><br><span class="line">   3) 1) &quot;113.46620947122573853&quot;</span><br><span class="line">      2) &quot;23.17010790561879929&quot;</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure><p><code>GEOHASH</code><br>å°†redisé‡Œçš„<code>Geo</code>è½¬åŒ–ä¸ºæ ‡å‡†çš„<code>GeoHash</code>è¾“å‡º<br>æ³¨æ„:è¿™é‡Œè¾“å‡ºçš„æ˜¯æ ‡å‡†çš„<code>GeoHash</code>, ä¸æ˜¯redisé‡Œé¢å­˜å‚¨çš„<code>HashInt</code>è½¬åŒ–å‡ºæ¥çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GEOHASH key member [member ...]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geohash geo_test test_1 test_2</span><br><span class="line">1) &quot;7pkg3sdkv40&quot;</span><br><span class="line">2) &quot;ws0evczxdm0&quot;</span><br></pre></td></tr></table></figure><h4 id="å­˜å‚¨åŸç†"><a class="header-anchor" href="#å­˜å‚¨åŸç†">â¡ï¸</a>å­˜å‚¨åŸç†</h4><p><code>Redis</code>é‡Œçš„<code>Geo</code>åæ ‡åœ¨å®é™…å­˜å‚¨æ—¶æ˜¯å°†<code>gps</code>åæ ‡åˆ†åˆ«æŒ‰ç…§(-180, 180)å’Œ(-85.05112878, 85.05112878)æ¥åˆ’åˆ†è®¡ç®—æˆ<code>HashInt</code>ä½œä¸º<code>zseté›†åˆ</code>è¿›è¡Œå­˜å‚¨çš„.<br>æ‰€ä»¥<code>Redis</code>çš„<code>Geo</code>æ“ä½œä¸­å¹¶æ²¡æœ‰åˆ é™¤å‘½ä»¤, å¯ä»¥ç›´æ¥ä½¿ç”¨<code>zrem</code>å‘½ä»¤å»åˆ é™¤<code>Geo</code>åæ ‡.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;GeoHashæœ‰ç€ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;GeoHashç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºç»åº¦å’Œçº¬åº¦ä¸¤ä¸ªåæ ‡,ä¾¿äºåŠ ä¸Šç´¢å¼•.&lt;/li&gt;
&lt;li&gt;GeoHashè¡¨ç¤ºçš„å¹¶ä¸æ˜¯ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸ.&lt;/li&gt;
&lt;li&gt;ç¼–ç çš„å‰ç¼€å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„åŒºåŸŸ, å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡ŒåŒºåŸŸæ£€ç´¢, èšåˆç­‰ç›¸å…³æ“ä½œ.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°, GeoHashæ¯”ç›´æ¥ç”¨ç»çº¬åº¦çš„é«˜æ•ˆå¾ˆå¤š.&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="redis" scheme="https://hexo.lilis.xin/tags/redis/"/>
    
      <category term="GeoHash" scheme="https://hexo.lilis.xin/tags/GeoHash/"/>
    
      <category term="GPS" scheme="https://hexo.lilis.xin/tags/GPS/"/>
    
  </entry>
  
  <entry>
    <title>nginxæœåŠ¡è„šæœ¬</title>
    <link href="https://hexo.lilis.xin/posts/5bc4c6e7/"/>
    <id>https://hexo.lilis.xin/posts/5bc4c6e7/</id>
    <published>2018-11-14T04:49:30.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>nginxæœåŠ¡è„šæœ¬</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># nginx - this script starts and stops the nginx daemin</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># chkconfig:   - 85 15</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</span></span><br><span class="line"><span class="bash"><span class="comment">#               proxy and IMAP/POP3 proxy server</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> processname: nginx</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> config:      /usr/<span class="built_in">local</span>/nginx/conf/nginx.conf</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pidfile:     /usr/<span class="built_in">local</span>/nginx/logs/nginx.pid</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Source <span class="keyword">function</span> library.</span></span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Source networking configuration.</span></span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Check that networking is up.</span></span><br><span class="line">[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0</span><br><span class="line"></span><br><span class="line">nginx=&quot;/usr/local/sbin/nginx&quot;</span><br><span class="line">prog=$(basename $nginx)</span><br><span class="line"></span><br><span class="line">NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot;</span><br><span class="line"></span><br><span class="line">lockfile=/var/lock/subsys/nginx</span><br><span class="line"></span><br><span class="line">start() &#123;</span><br><span class="line">    [ -x $nginx ] || exit 5</span><br><span class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</span><br><span class="line">    echo -n $&quot;Starting $prog: &quot;</span><br><span class="line">    daemon $nginx -c $NGINX_CONF_FILE</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop() &#123;</span><br><span class="line">    echo -n $&quot;Stopping $prog: &quot;</span><br><span class="line">    killproc $prog -QUIT</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">restart() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    stop</span><br><span class="line">    start</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reload() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    echo -n $&quot;Reloading $prog: &quot;</span><br><span class="line">    killproc $nginx -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    echo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">force_reload() &#123;</span><br><span class="line">    restart</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configtest() &#123;</span><br><span class="line"><span class="meta">  $</span><span class="bash">nginx -t -c <span class="variable">$NGINX_CONF_FILE</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status() &#123;</span><br><span class="line">    status $prog</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status_q() &#123;</span><br><span class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    start)</span><br><span class="line">        rh_status_q &amp;&amp; exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    restart|configtest)</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    reload)</span><br><span class="line">        rh_status_q || exit 7</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    force-reload)</span><br><span class="line">        force_reload</span><br><span class="line">        ;;</span><br><span class="line">    status)</span><br><span class="line">        rh_status</span><br><span class="line">        ;;</span><br><span class="line">    condrestart|try-restart)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">            ;;</span><br><span class="line">    *)</span><br><span class="line">        echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot;</span><br><span class="line">        exit 2</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;nginxæœåŠ¡è„šæœ¬&lt;/p&gt;
    
    </summary>
    
    
      <category term="nginx" scheme="https://hexo.lilis.xin/tags/nginx/"/>
    
      <category term="server" scheme="https://hexo.lilis.xin/tags/server/"/>
    
  </entry>
  
  <entry>
    <title>PHPåŠ¨æ€giféªŒè¯ç </title>
    <link href="https://hexo.lilis.xin/posts/491b8778/"/>
    <id>https://hexo.lilis.xin/posts/491b8778/</id>
    <published>2018-11-08T04:02:23.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘æ„Ÿè§‰è‡ªå·±çš„é¡¹ç›®ä¸Šçš„éªŒè¯ç å¤ªlowäº†,å†³å®šæ¢ä¸€ä¸ªæœ‰æ„æ€çš„åŠ¨æ€giféªŒè¯ç </p><a id="more"></a><p>æ•ˆæœ<br><img src="https://blog.lilis.xin/wp-admin/Captcha.php" alt="Captcha" title="Captcha"><br>åºŸè¯ä¸å¤šè¯´,ç›´æ¥ä¸Šæºç </p><h4 id="æºç "><a class="header-anchor" href="#æºç ">â¡ï¸</a>æºç </h4><p>ä¸»å‡½æ•°:<br><a href="https://blog.lilis.xin/wp-admin/fonts/comic.ttf" title="comic.ttf">comic.ttf</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ImageCode</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$string</span>=<span class="string">&#x27;&#x27;</span>, <span class="variable">$frames</span> = <span class="number">60</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$time</span> = <span class="number">1</span>,<span class="variable">$width</span>=<span class="number">75</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$height</span>=<span class="number">25</span>, <span class="variable">$font</span> = <span class="number">6</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$loops</span> = <span class="number">0</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">        <span class="variable">$authstr</span> = <span class="variable">$string</span>?:((time()%<span class="number">2</span>==<span class="number">0</span>)?mt_rand(<span class="number">1000</span>,<span class="number">9999</span>):mt_rand(<span class="number">10000</span>,<span class="number">99999</span>));</span><br><span class="line">        <span class="variable">$authlen</span> = strlen(<span class="variable">$authstr</span>);</span><br><span class="line">        <span class="variable">$board_width</span>=<span class="variable">$width</span>;</span><br><span class="line">        <span class="variable">$board_height</span>=<span class="variable">$height</span>;</span><br><span class="line">        <span class="variable">$delay</span> = <span class="variable">$time</span>*<span class="number">100</span>/<span class="variable">$frames</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿæˆä¸€ä¸ªnå¸§çš„GIFåŠ¨ç”»</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$frames</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            ob_start();</span><br><span class="line">            <span class="variable">$image</span>=imagecreate(<span class="variable">$board_width</span>,<span class="variable">$board_height</span>);</span><br><span class="line">            imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¾å®šæ–‡å­—é¢œè‰²æ•°ç»„</span></span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">15</span>,<span class="number">73</span>,<span class="number">210</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">64</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">64</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">128</span>,<span class="number">128</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">27</span>,<span class="number">52</span>,<span class="number">47</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">51</span>,<span class="number">0</span>,<span class="number">102</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">145</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">113</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">51</span>,<span class="number">51</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">158</span>,<span class="number">180</span>,<span class="number">35</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">59</span>,<span class="number">59</span>,<span class="number">59</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">1</span>,<span class="number">128</span>,<span class="number">180</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">153</span>,<span class="number">51</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">60</span>,<span class="number">131</span>,<span class="number">1</span>);</span><br><span class="line">            <span class="variable">$colorList</span>[]=imagecolorallocate(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="variable">$gray</span>=imagecolorallocate(<span class="variable">$image</span>,<span class="number">245</span>,<span class="number">245</span>,<span class="number">245</span>);</span><br><span class="line">            imagefill(<span class="variable">$image</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="variable">$gray</span>);</span><br><span class="line">            <span class="variable">$space</span>=<span class="variable">$font</span>*<span class="number">0.65</span>;<span class="comment">// å­—ç¬¦é—´è·</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$k</span>=<span class="number">0</span>;<span class="variable">$k</span>&lt;<span class="variable">$authlen</span>;<span class="variable">$k</span>++)&#123;</span><br><span class="line">                <span class="variable">$colorRandom</span>=mt_rand(<span class="number">0</span>,sizeof(<span class="variable">$colorList</span>)<span class="number">-1</span>);</span><br><span class="line">                <span class="variable">$float_top</span>=rand(<span class="number">0</span>,<span class="number">4</span>);</span><br><span class="line">                <span class="variable">$float_left</span>=rand(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">                imagettftext(</span><br><span class="line">                    <span class="variable">$image</span>, <span class="variable">$font</span>, <span class="number">0</span>,</span><br><span class="line">                    <span class="variable">$space</span>*<span class="variable">$k</span>+<span class="variable">$float_left</span>, <span class="variable">$font</span>+<span class="variable">$float_top</span>,</span><br><span class="line">                    <span class="variable">$colorList</span>[<span class="variable">$colorRandom</span>],</span><br><span class="line">                    <span class="string">&#x27;./fonts/comic.ttf&#x27;</span>,</span><br><span class="line">                    substr(<span class="variable">$authstr</span>,<span class="variable">$k</span>,<span class="number">1</span>)</span><br><span class="line">                );</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$k</span>=<span class="number">0</span>;<span class="variable">$k</span>&lt;<span class="number">20</span>;<span class="variable">$k</span>++)&#123;</span><br><span class="line">                <span class="variable">$colorRandom</span>=mt_rand(<span class="number">0</span>,sizeof(<span class="variable">$colorList</span>)<span class="number">-1</span>);</span><br><span class="line">                imagesetpixel(<span class="variable">$image</span>,rand()%<span class="number">70</span>,rand()%<span class="number">15</span>,<span class="variable">$colorList</span>[<span class="variable">$colorRandom</span>]);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ·»åŠ å¹²æ‰°çº¿</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$k</span>=<span class="number">0</span>;<span class="variable">$k</span>&lt;<span class="number">3</span>;<span class="variable">$k</span>++)&#123;</span><br><span class="line">                <span class="variable">$colorRandom</span>=mt_rand(<span class="number">0</span>,sizeof(<span class="variable">$colorList</span>)<span class="number">-1</span>);</span><br><span class="line">                <span class="variable">$toDrawLine</span>=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$toDrawLine</span>)&#123;</span><br><span class="line">                    imageline(<span class="variable">$image</span>,mt_rand(<span class="number">0</span>,<span class="variable">$board_width</span>),mt_rand(<span class="number">0</span>,<span class="variable">$board_height</span>),mt_rand(<span class="number">0</span>,<span class="variable">$board_width</span>),mt_rand(<span class="number">0</span>,<span class="variable">$board_height</span>),<span class="variable">$colorList</span>[<span class="variable">$colorRandom</span>]);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$w</span>=mt_rand(<span class="number">0</span>,<span class="variable">$board_width</span>);</span><br><span class="line">                    <span class="variable">$h</span>=mt_rand(<span class="number">0</span>,<span class="variable">$board_width</span>);</span><br><span class="line">                    imagearc(<span class="variable">$image</span>,<span class="variable">$board_width</span>-floor(<span class="variable">$w</span> / <span class="number">2</span>),floor(<span class="variable">$h</span> / <span class="number">2</span>),<span class="variable">$w</span>,<span class="variable">$h</span>, rand(<span class="number">90</span>,<span class="number">180</span>),rand(<span class="number">180</span>,<span class="number">270</span>),<span class="variable">$colorList</span>[<span class="variable">$colorRandom</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            imagegif(<span class="variable">$image</span>);</span><br><span class="line">            imagedestroy(<span class="variable">$image</span>);</span><br><span class="line">            <span class="variable">$imagedata</span>[]=ob_get_contents();</span><br><span class="line">            <span class="variable">$delays</span>[] = <span class="variable">$delay</span>;</span><br><span class="line">            ob_clean();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnimatedGif(<span class="variable">$imagedata</span>, <span class="variable">$delays</span>, <span class="variable">$loops</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>AnimatedGif:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *AnimatedGifç±»</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnimatedGif</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The built gif image</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$image</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The array of images to stack</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$buffer</span> = <span class="keyword">Array</span>();</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * How many times to loop? 0 = infinite</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$number_of_loops</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$DIS</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Which colour is transparent</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$transparent_colour</span> = <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Is this the first frame</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$first_frame</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encode an animated gif</span></span><br><span class="line"><span class="comment">     * AnimatedGif constructor.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $source_images</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $image_delays</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $number_of_loops</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">array</span> <span class="variable">$source_images</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">array</span> <span class="variable">$image_delays</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="variable">$number_of_loops</span></span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * I have no idea what these even do, they appear to do nothing to the image so far</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="variable">$transparent_colour_red</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$transparent_colour_green</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$transparent_colour_blue</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;number_of_loops = ( <span class="variable">$number_of_loops</span> &gt; <span class="number">-1</span> ) ? <span class="variable">$number_of_loops</span> : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;set_transparent_colour(<span class="variable">$transparent_colour_red</span>, <span class="variable">$transparent_colour_green</span>, <span class="variable">$transparent_colour_blue</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;buffer_images(<span class="variable">$source_images</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;addHeader();</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; count(<span class="keyword">$this</span>-&gt;buffer); <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;addFrame(<span class="variable">$i</span>, <span class="variable">$image_delays</span> [<span class="variable">$i</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set the transparent colour</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $red</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $green</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $blue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">set_transparent_colour</span>(<span class="params"><span class="variable">$red</span>, <span class="variable">$green</span>, <span class="variable">$blue</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;transparent_colour = ( <span class="variable">$red</span> &gt; <span class="number">-1</span> &amp;&amp; <span class="variable">$green</span> &gt; <span class="number">-1</span> &amp;&amp; <span class="variable">$blue</span> &gt; <span class="number">-1</span> ) ?</span><br><span class="line">            ( <span class="variable">$red</span> | ( <span class="variable">$green</span> &lt;&lt; <span class="number">8</span> ) | ( <span class="variable">$blue</span> &lt;&lt; <span class="number">16</span> ) ) : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Buffer the images and check to make sure they are vaild</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $source_images</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buffer_images</span>(<span class="params"><span class="variable">$source_images</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; count(<span class="variable">$source_images</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;buffer [] = <span class="variable">$source_images</span> [<span class="variable">$i</span>];</span><br><span class="line">            <span class="keyword">if</span> (substr(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$i</span>], <span class="number">0</span>, <span class="number">6</span>) != <span class="string">&quot;GIF87a&quot;</span> &amp;&amp; substr(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$i</span>], <span class="number">0</span>, <span class="number">6</span>) != <span class="string">&quot;GIF89a&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Image at position &#x27;</span> . <span class="variable">$i</span>. <span class="string">&#x27; is not a gif&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span> = ( <span class="number">13</span> + <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$i</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ) ), <span class="variable">$k</span> = <span class="literal">TRUE</span>; <span class="variable">$k</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$i</span>] &#123; <span class="variable">$j</span> &#125;) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;!&quot;</span>:</span><br><span class="line">                        <span class="keyword">if</span> (( substr(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$i</span>], ( <span class="variable">$j</span> + <span class="number">3</span>), <span class="number">8</span>) ) == <span class="string">&quot;NETSCAPE&quot;</span>) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;You cannot make an animation from an animated gif.&#x27;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;;&quot;</span>:</span><br><span class="line">                        <span class="variable">$k</span> = <span class="literal">FALSE</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add the gif header to the image</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addHeader</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$cmap</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;image = <span class="string">&#x27;GIF89a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span>) &#123;</span><br><span class="line">            <span class="variable">$cmap</span> = <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) );</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">6</span>, <span class="number">7</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">13</span>, <span class="variable">$cmap</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= <span class="string">&quot;!\377\13NETSCAPE2.0\3\1&quot;</span> . <span class="keyword">$this</span>-&gt;word(<span class="keyword">$this</span>-&gt;number_of_loops) . <span class="string">&quot;\0&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add a frame to the animation</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $frame The frame to be added</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $delay The delay associated with the frame</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addFrame</span>(<span class="params"><span class="variable">$frame</span>, <span class="variable">$delay</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$Locals_str</span> = <span class="number">13</span> + <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) );</span><br><span class="line">        <span class="variable">$Locals_end</span> = strlen(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>]) - <span class="variable">$Locals_str</span> - <span class="number">1</span>;</span><br><span class="line">        <span class="variable">$Locals_tmp</span> = substr(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>], <span class="variable">$Locals_str</span>, <span class="variable">$Locals_end</span>);</span><br><span class="line">        <span class="variable">$Global_len</span> = <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">        <span class="variable">$Locals_len</span> = <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">        <span class="variable">$Global_rgb</span> = substr(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>], <span class="number">13</span>, <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ));</span><br><span class="line">        <span class="variable">$Locals_rgb</span> = substr(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>], <span class="number">13</span>, <span class="number">3</span> * ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ));</span><br><span class="line">        <span class="variable">$Locals_ext</span> = <span class="string">&quot;!\xF9\x04&quot;</span> . chr(( <span class="keyword">$this</span>-&gt;DIS &lt;&lt; <span class="number">2</span> ) + <span class="number">0</span>) .</span><br><span class="line">            chr(( <span class="variable">$delay</span> &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span>) . chr(( <span class="variable">$delay</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) . <span class="string">&quot;\x0\x0&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;transparent_colour &gt; <span class="number">-1</span> &amp;&amp; ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; ( <span class="number">2</span> &lt;&lt; ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> ) ); <span class="variable">$j</span>++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (</span><br><span class="line">                    ord(<span class="variable">$Locals_rgb</span> &#123; <span class="number">3</span> * <span class="variable">$j</span> + <span class="number">0</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">16</span> ) &amp; <span class="number">0xFF</span> ) &amp;&amp;</span><br><span class="line">                    ord(<span class="variable">$Locals_rgb</span> &#123; <span class="number">3</span> * <span class="variable">$j</span> + <span class="number">1</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span> ) &amp;&amp;</span><br><span class="line">                    ord(<span class="variable">$Locals_rgb</span> &#123; <span class="number">3</span> * <span class="variable">$j</span> + <span class="number">2</span> &#125;) == ( ( <span class="keyword">$this</span>-&gt;transparent_colour &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span> )</span><br><span class="line">                ) &#123;</span><br><span class="line">                    <span class="variable">$Locals_ext</span> = <span class="string">&quot;!\xF9\x04&quot;</span> . chr(( <span class="keyword">$this</span>-&gt;DIS &lt;&lt; <span class="number">2</span> ) + <span class="number">1</span>) .</span><br><span class="line">                        chr(( <span class="variable">$delay</span> &gt;&gt; <span class="number">0</span> ) &amp; <span class="number">0xFF</span>) . chr(( <span class="variable">$delay</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$j</span>) . <span class="string">&quot;\x0&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$Locals_tmp</span> &#123; <span class="number">0</span> &#125;) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;!&quot;</span>:</span><br><span class="line">                <span class="variable">$Locals_img</span> = substr(<span class="variable">$Locals_tmp</span>, <span class="number">8</span>, <span class="number">10</span>);</span><br><span class="line">                <span class="variable">$Locals_tmp</span> = substr(<span class="variable">$Locals_tmp</span>, <span class="number">18</span>, strlen(<span class="variable">$Locals_tmp</span>) - <span class="number">18</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;,&quot;</span>:</span><br><span class="line">                <span class="variable">$Locals_img</span> = substr(<span class="variable">$Locals_tmp</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">                <span class="variable">$Locals_tmp</span> = substr(<span class="variable">$Locals_tmp</span>, <span class="number">10</span>, strlen(<span class="variable">$Locals_tmp</span>) - <span class="number">10</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x80</span> &amp;&amp; <span class="keyword">$this</span>-&gt;first_frame === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$Global_len</span> == <span class="variable">$Locals_len</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;blockCompare(<span class="variable">$Global_rgb</span>, <span class="variable">$Locals_rgb</span>, <span class="variable">$Global_len</span>)) &#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;image .= ( <span class="variable">$Locals_ext</span> . <span class="variable">$Locals_img</span> . <span class="variable">$Locals_tmp</span> );</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable">$byte</span> = ord(<span class="variable">$Locals_img</span> &#123; <span class="number">9</span> &#125;);</span><br><span class="line">                    <span class="variable">$byte</span> |= <span class="number">0x80</span>;</span><br><span class="line">                    <span class="variable">$byte</span> &amp;= <span class="number">0xF8</span>;</span><br><span class="line">                    <span class="variable">$byte</span> |= ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="number">0</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">                    <span class="variable">$Locals_img</span> &#123; <span class="number">9</span> &#125; = chr(<span class="variable">$byte</span>);</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;image .= ( <span class="variable">$Locals_ext</span> . <span class="variable">$Locals_img</span> . <span class="variable">$Locals_rgb</span> . <span class="variable">$Locals_tmp</span> );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$byte</span> = ord(<span class="variable">$Locals_img</span> &#123; <span class="number">9</span> &#125;);</span><br><span class="line">                <span class="variable">$byte</span> |= <span class="number">0x80</span>;</span><br><span class="line">                <span class="variable">$byte</span> &amp;= <span class="number">0xF8</span>;</span><br><span class="line">                <span class="variable">$byte</span> |= ( ord(<span class="keyword">$this</span>-&gt;buffer [<span class="variable">$frame</span>] &#123; <span class="number">10</span> &#125;) &amp; <span class="number">0x07</span> );</span><br><span class="line">                <span class="variable">$Locals_img</span> &#123; <span class="number">9</span> &#125; = chr(<span class="variable">$byte</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;image .= ( <span class="variable">$Locals_ext</span> . <span class="variable">$Locals_img</span> . <span class="variable">$Locals_rgb</span> . <span class="variable">$Locals_tmp</span> );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;image .= ( <span class="variable">$Locals_ext</span> . <span class="variable">$Locals_img</span> . <span class="variable">$Locals_tmp</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;first_frame = <span class="literal">FALSE</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Add the gif footer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">addFooter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;image .= <span class="string">&quot;;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Compare gif blocks? What is a block?</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $GlobalBlock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $LocalBlock</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $Len</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">blockCompare</span>(<span class="params"><span class="variable">$GlobalBlock</span>, <span class="variable">$LocalBlock</span>, <span class="variable">$Len</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$Len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                <span class="variable">$GlobalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">0</span> &#125; != <span class="variable">$LocalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">0</span> &#125; ||</span><br><span class="line">                <span class="variable">$GlobalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">1</span> &#125; != <span class="variable">$LocalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">1</span> &#125; ||</span><br><span class="line">                <span class="variable">$GlobalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">2</span> &#125; != <span class="variable">$LocalBlock</span> &#123; <span class="number">3</span> * <span class="variable">$i</span> + <span class="number">2</span> &#125;</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="keyword">return</span> ( <span class="number">0</span> );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ( <span class="number">1</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * No clue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $int</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string the char you meant?</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">word</span>(<span class="params"><span class="variable">$int</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ( chr(<span class="variable">$int</span> &amp; <span class="number">0xFF</span>) . chr(( <span class="variable">$int</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>) );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the animated gif</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getAnimation</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;image;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the animated gif</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@echo</span> image</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">display</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//late footer add</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;addFooter();</span><br><span class="line">        header(<span class="string">&#x27;Content-type:image/gif&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;image;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç¤ºä¾‹ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;abcdefghijkmnpqrstuvwxy3456789&#x27;</span>;</span><br><span class="line"><span class="variable">$len</span> = strlen(<span class="variable">$str</span>) - <span class="number">1</span>;</span><br><span class="line"><span class="variable">$text</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">6</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="variable">$text</span> .= <span class="variable">$str</span>[rand(<span class="number">0</span>, <span class="variable">$len</span>)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$gif</span> = ImageCode(</span><br><span class="line"><span class="variable">$text</span>, <span class="number">8</span>, <span class="number">1</span>,</span><br><span class="line"><span class="number">100</span>, <span class="number">35</span>,</span><br><span class="line"><span class="number">23</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$gif</span>-&gt;display();</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘æ„Ÿè§‰è‡ªå·±çš„é¡¹ç›®ä¸Šçš„éªŒè¯ç å¤ªlowäº†,å†³å®šæ¢ä¸€ä¸ªæœ‰æ„æ€çš„åŠ¨æ€giféªŒè¯ç &lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="ä»£ç " scheme="https://hexo.lilis.xin/tags/%E4%BB%A3%E7%A0%81/"/>
    
      <category term="captcha" scheme="https://hexo.lilis.xin/tags/captcha/"/>
    
      <category term="gif" scheme="https://hexo.lilis.xin/tags/gif/"/>
    
  </entry>
  
  <entry>
    <title>gd-è¾“å‡ºå›¾ç‰‡æµ</title>
    <link href="https://hexo.lilis.xin/posts/faad097e/"/>
    <id>https://hexo.lilis.xin/posts/faad097e/</id>
    <published>2018-11-06T10:11:07.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æœ€è¿‘åœ¨ælaravelsé¡¹ç›®,ç”±äºlaravelsæ˜¯é€šè¿‡swooleæ¥åŠ é€Ÿlaravelçš„,php-fpmæ¨¡å¼ä¸‹çš„ä¸€äº›è¾“å‡ºå‡½æ•°æ”¶åˆ°äº†å¹²æ‰°,æ¯”å¦‚:header(),åœ¨laravelsä¸‹è¿”å›è¾“å‡ºå’Œheaderå¤´çš„è®¾å®šéœ€è¦ç”±response()æ¥å®Œæˆ.ä½†æ˜¯gdçš„è¾“å‡ºå°±æ¯”è¾ƒç‰¹åˆ«äº†,å®ƒè¦ä¹ˆè¾“å‡ºç½‘é¡µ,è¦ä¹ˆè¾“å‡ºæ–‡ä»¶.å¦‚æœæƒ³è¦è¾“å‡ºäºŒè¿›åˆ¶æµå†äº¤ç»™PHPå°±æ¯”è¾ƒéº»çƒ¦äº†,ç½‘ä¸Šæ™®éçš„æ–¹æ¡ˆå°±æ˜¯å…ˆæŠŠgdå›¾åƒè¾“å‡ºåˆ°ç¼“å­˜æ–‡ä»¶é‡Œ,å†è¯»å–å‡ºæ¥.å¯æ˜¯åœ¨è¦æœ‰å ç”¨äº†å¤ªå¤šçš„ç£ç›˜I/O</p><a id="more"></a><h4 id="é—®é¢˜"><a class="header-anchor" href="#é—®é¢˜">â¡ï¸</a>é—®é¢˜</h4><p><code>gd</code>ç›´æ¥è¾“å‡ºåˆ°ç½‘é¡µæˆ‘ä»¬åå°æ— æ³•å¾ˆå¥½çš„è®¾ç½®<code>header</code>æ¥æ ‡æ³¨æ–‡ä»¶ç±»å‹.</p><h4 id="æ–¹æ¡ˆ"><a class="header-anchor" href="#æ–¹æ¡ˆ">â¡ï¸</a>æ–¹æ¡ˆ</h4><p><code>gd</code>å…ˆè¾“å‡ºåˆ°æ–‡ä»¶,åœ¨ç”¨<code>file_get_contents</code>è¯»å–.<br>ç¼ºé™·:å¤ªè¿‡äºå ç”¨ç£ç›˜<code>I/O</code><br><code>gd</code>çš„è¾“å‡ºå…ˆç”±<code>ob</code>ç¼“å­˜ä¸‹æ¥,å†ç”¨<code>ob_get_contents</code>è·å–.<br>ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ob_start();</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$type</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;jpg&#x27;</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;jpeg&#x27;</span>:</span><br><span class="line"><span class="variable">$type</span> = <span class="string">&#x27;image/jpeg&#x27;</span>;</span><br><span class="line">imagejpeg(<span class="keyword">$this</span>-&gt;image, <span class="string">&#x27;&#x27;</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;png&#x27;</span>:</span><br><span class="line"><span class="variable">$type</span> = <span class="string">&#x27;image/png&#x27;</span>;</span><br><span class="line">imagepng(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;bmp&#x27;</span>:</span><br><span class="line"><span class="variable">$type</span> = <span class="string">&#x27;image/vnd.wap.wbmp&#x27;</span>;</span><br><span class="line">imagewbmp(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;gif&#x27;</span>:</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="variable">$type</span> = <span class="string">&#x27;image/gif&#x27;</span>;</span><br><span class="line">imagegif(<span class="keyword">$this</span>-&gt;image);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$contents</span> = ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line"><span class="keyword">return</span> response(<span class="variable">$content</span>)</span><br><span class="line">-&gt;header(<span class="string">&#x27;Content-type&#x27;</span>, <span class="variable">$type</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘åœ¨ælaravelsé¡¹ç›®,ç”±äºlaravelsæ˜¯é€šè¿‡swooleæ¥åŠ é€Ÿlaravelçš„,php-fpmæ¨¡å¼ä¸‹çš„ä¸€äº›è¾“å‡ºå‡½æ•°æ”¶åˆ°äº†å¹²æ‰°,æ¯”å¦‚:header(),åœ¨laravelsä¸‹è¿”å›è¾“å‡ºå’Œheaderå¤´çš„è®¾å®šéœ€è¦ç”±response()æ¥å®Œæˆ.ä½†æ˜¯gdçš„è¾“å‡ºå°±æ¯”è¾ƒç‰¹åˆ«äº†,å®ƒè¦ä¹ˆè¾“å‡ºç½‘é¡µ,è¦ä¹ˆè¾“å‡ºæ–‡ä»¶.å¦‚æœæƒ³è¦è¾“å‡ºäºŒè¿›åˆ¶æµå†äº¤ç»™PHPå°±æ¯”è¾ƒéº»çƒ¦äº†,ç½‘ä¸Šæ™®éçš„æ–¹æ¡ˆå°±æ˜¯å…ˆæŠŠgdå›¾åƒè¾“å‡ºåˆ°ç¼“å­˜æ–‡ä»¶é‡Œ,å†è¯»å–å‡ºæ¥.å¯æ˜¯åœ¨è¦æœ‰å ç”¨äº†å¤ªå¤šçš„ç£ç›˜I/O&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="gd" scheme="https://hexo.lilis.xin/tags/gd/"/>
    
      <category term="ob" scheme="https://hexo.lilis.xin/tags/ob/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨Merlinä¸Šå®‰è£…Entware</title>
    <link href="https://hexo.lilis.xin/posts/32c6b91b/"/>
    <id>https://hexo.lilis.xin/posts/32c6b91b/</id>
    <published>2018-11-05T08:01:50.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨ä¹‹å‰å®‰è£…å¥½Merlinå,æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…Entware,ä¸è¿‡åœ¨å®‰è£…Entwareä¹‹å‰éœ€è¦å…ˆæŒ‚è½½Uç›˜å¹¶æ ¼å¼åŒ–ä¸ºext4.</p><a id="more"></a><h3 id="å®‰è£…fdisk"><a class="header-anchor" href="#å®‰è£…fdisk">â¡ï¸</a>å®‰è£…fdisk</h3><p>fdiskä¸€èˆ¬çš„Merlinéƒ½æ˜¯è‡ªå¸¦çš„,æ— éœ€å®‰è£…,å¦‚æœè¿˜æ²¡æœ‰å®‰è£…fdiskè€Œä¸”ä¹Ÿè¿˜æ²¡æœ‰Entwareçš„è¯è¦ä¹ˆå°±ç›´æ¥ç”¨ç”µè„‘æ ¼å¼åŒ–åæŒ‚è½½è¿›å»(è¿™ä¸ªæˆ‘æ²¡æœ‰è¯•è¿‡,åº”è¯¥æ•ˆæœä¸€è‡´)</p><h3 id="æ£€æŸ¥è®¾å¤‡"><a class="header-anchor" href="#æ£€æŸ¥è®¾å¤‡">â¡ï¸</a>æ£€æŸ¥è®¾å¤‡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿™é‡Œå…ˆè¾“å‡ºç³»ç»Ÿåˆ†åŒºä¹‹ç±»çš„ä¸ç”¨ç®¡ï¼Œå¤–ç½®è®¾å¤‡ä¸€èˆ¬åœ¨æœ€å</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸€èˆ¬ä¼šæœ‰ç±»ä¼¼äºè¿™æ ·çš„,å¦‚æœæ²¡æœ‰é‚£ä½ éœ€è¦æ£€æŸ¥ä¸€ä¸‹Uç›˜æ˜¯å¦æ­£å¸¸</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¿¡æ¯æ³¨æ„çœ‹åˆ°å’Œä½ çš„å­˜å‚¨å¤§å°ä¸€æ ·çš„è®¾å¤‡ï¼Œæˆ‘çš„æ˜¯<code>/dev/sda</code>ï¼Œåœ¨å®ƒé‡Œé¢æœ‰ä¸ª<code>/dev/sda1</code>çš„åˆ†åŒº</p><h3 id="åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº"><a class="header-anchor" href="#åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº">â¡ï¸</a>åˆ é™¤å¹¶å»ºç«‹æ–°çš„åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sda # è¿™æ˜¯ä½ çš„è®¾å¤‡åˆ¥æ‰“æˆåˆ†åŒº,æ³¨æ„åˆ«æ‰“æˆäº†sda1</span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.29.2).</span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Command (m for help): d # è¾“å…¥då›è½¦ï¼Œæˆ‘åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œå®ƒè‡ªåŠ¨é€‰æ‹©äº†ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªåˆ†åŒºï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨d</span><br><span class="line">Selected partition 1</span><br><span class="line">Partition 1 has been deleted.</span><br><span class="line"></span><br><span class="line">Command (m for help): n # è¾“å…¥nä¼šè½¦ï¼Œåˆ›å»ºåˆ†åŒº</span><br><span class="line">Partition type</span><br><span class="line">p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">e   extended (container for logical partitions)</span><br><span class="line"></span><br><span class="line">Select (default p): p # é€‰æ‹©p</span><br><span class="line">Partition number (1-4, default 1): # å›è½¦</span><br><span class="line">First sector (2048-2065023, default 2048): #å›è½¦</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G,T,P&#125; (2048-2065023, default 2065023): # å›è½¦</span><br><span class="line">Created a new partition 1 of type &#x27;Linux&#x27; and of size 1007.3 MiB.</span><br><span class="line"></span><br><span class="line">Command (m for help): w # è¾“å…¥wå›è½¦ï¼Œä¿å­˜å¹¶é€€å‡º</span><br><span class="line">The partition table has been altered.</span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><p>ç»è¿‡ä»¥ä¸Šçš„æ“ä½œï¼Œä½ å¯ä»¥ç”¨<code>fdisk -l</code>å‘½ä»¤æŸ¥çœ‹Uç›˜ä¸Šæ˜¯å¦åªæœ‰ä¸€ä¸ª<code>Linux</code>åˆ†åŒº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ‰¾åˆ°ä½ çš„è®¾å¤‡ å¯ä»¥çœ‹åˆ°IDä¸º83å°±å¯¹äº†</span></span><br><span class="line">Disk /dev/sda: 30.7 GB, 30752000000 bytes</span><br><span class="line">64 heads, 32 sectors/track, 29327 cylinders</span><br><span class="line">Units = cylinders of 2048 * 512 = 1048576 bytes</span><br><span class="line">Device Boot      Start         End      Blocks  Id System</span><br><span class="line">/dev/sda1               2       29327    30029824  83 Linux</span><br></pre></td></tr></table></figure><h3 id="æ ¼å¼åŒ–åˆ†åŒº"><a class="header-anchor" href="#æ ¼å¼åŒ–åˆ†åŒº">â¡ï¸</a>æ ¼å¼åŒ–åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 /dev/sda1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœä½ çš„ç¡¬ç›˜æ¯”è¾ƒå¤§ï¼Œ256Gä»¥ä¸Šçš„è¯ï¼Œæ˜¯è¿™ä¸ªå‘½ä»¤ï¼šmkfs.ext4 -T largefile /dev/sda1</span></span><br><span class="line">mke2fs 1.43.3 (04-Sep-2016)</span><br><span class="line">/dev/sda1 contains a ext4 file system labelled &#x27;ONMP&#x27;</span><br><span class="line">last mounted on Sun Nov 12 09:21:22 2017</span><br><span class="line">Proceed anyway? (y,n) y # è¾“å…¥yå›è½¦</span><br><span class="line">umount /dev/sda1 # å¦‚æœå‡ºé”™ï¼Œå¯èƒ½æ˜¯å› ä¸ºå·²ç»è¢«æŒ‚è½½äº†ï¼Œå…ˆæ‰§è¡Œè¿™ä¸ªå¸è½½</span><br></pre></td></tr></table></figure><h3 id="æŒ‚è½½åˆ†åŒº"><a class="header-anchor" href="#æŒ‚è½½åˆ†åŒº">â¡ï¸</a>æŒ‚è½½åˆ†åŒº</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /mnt/sda1</span><br><span class="line">mount -t ext4 /dev/sda1 /mnt/sda1/</span><br><span class="line">df -h</span><br><span class="line">Filesystem                Size      Used Available Use% Mounted on</span><br><span class="line">/dev/sda1               975.5M      2.5M    906.6M   0% /tmp/mnt/sda1</span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯ä»¥çœ‹åˆ°å·²ç»æŒ‚è½½</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…å’Œä½¿ç”¨Entware"><a class="header-anchor" href="#å®‰è£…å’Œä½¿ç”¨Entware">â¡ï¸</a>å®‰è£…å’Œä½¿ç”¨Entware</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entware-setup.sh</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸€ä¸‹é€‰æ‹©åˆ†åŒºçš„æ—¶å€™é€‰æ‹©åˆšæ‰æŒ‚è½½ä¸Šå»çš„é‚£ä¸ª<br>å‚è€ƒ:</p><ul><li><a href="https://github.com/xzhih/ONMP/wiki/%E5%9C%A8%E6%A2%85%E6%9E%97%E4%B8%8A%E5%AE%89%E8%A3%85-Entware" title="åœ¨æ¢…æ—ä¸Šå®‰è£… Entware">åœ¨æ¢…æ—ä¸Šå®‰è£… Entware</a></li><li><a href="https://github.com/xzhih/ONMP/wiki/%E5%A6%82%E4%BD%95%E5%9C%A8%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%8A%E6%A0%BC%E5%BC%8F%E5%8C%96-U-%E7%9B%98%E4%B8%BA-ext4" title="å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ– U ç›˜ä¸º ext4">å¦‚ä½•åœ¨è·¯ç”±å™¨ä¸Šæ ¼å¼åŒ– U ç›˜ä¸º ext4</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ä¹‹å‰å®‰è£…å¥½Merlinå,æ¥ä¸‹æ¥å°±æ˜¯å®‰è£…Entware,ä¸è¿‡åœ¨å®‰è£…Entwareä¹‹å‰éœ€è¦å…ˆæŒ‚è½½Uç›˜å¹¶æ ¼å¼åŒ–ä¸ºext4.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Merlin" scheme="https://hexo.lilis.xin/tags/Merlin/"/>
    
      <category term="R7000" scheme="https://hexo.lilis.xin/tags/R7000/"/>
    
      <category term="è·¯ç”±å™¨" scheme="https://hexo.lilis.xin/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
      <category term="Entware" scheme="https://hexo.lilis.xin/tags/Entware/"/>
    
      <category term="ç£ç›˜ç®¡ç†" scheme="https://hexo.lilis.xin/tags/%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>R7000åˆ·Merlin</title>
    <link href="https://hexo.lilis.xin/posts/50136e28/"/>
    <id>https://hexo.lilis.xin/posts/50136e28/</id>
    <published>2018-11-05T05:56:02.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä¹‹å‰ä¹°äº†ä¸€ä¸ªNetgear R7000 è·¯ç”±å™¨,åˆ°æ‰‹åå°±æ„Ÿè§‰å¿å—ä¸äº†å®ƒçš„é‚£ä¸ªè¶…ä¸å¥½ç”¨çš„web ui,æ‰€ä»¥å°±æ²¡ä¸Šæ‰‹ä¸¤åˆ†é’Ÿæœæ–­åˆ·æœºæˆMerlinäº†.</p><a id="more"></a><h3 id="ä¸»è¦æ­¥éª¤"><a class="header-anchor" href="#ä¸»è¦æ­¥éª¤">â¡ï¸</a>ä¸»è¦æ­¥éª¤</h3><ol><li>åˆ·æœºåˆ°<code>Merlin</code>å’Œ<code>Netgear</code>ä¹‹é—´çš„ä¸€ä¸ªè¿‡æ¸¡å›ºä»¶(è¿™å…¶å®å°±æ˜¯ä¸€äº›ç©å®¶åšçš„<code>Netgear</code>ç‰ˆçš„<code>Merlin</code>å›ºä»¶åŒ…,æ˜¯ä¸€ä¸ªå®Œæ•´ç‰ˆçš„<code>Merlin</code>,åªæ˜¯ç‰ˆæœ¬æ¯”è¾ƒè€)</li><li>åˆ·æœºåˆ°æœ€æ–°ç‰ˆçš„<code>Merlin</code></li></ol><h3 id="æ‰€éœ€ææ–™"><a class="header-anchor" href="#æ‰€éœ€ææ–™">â¡ï¸</a>æ‰€éœ€ææ–™</h3><p><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.chk" title="R7000_380.70_0-X7.9.1-koolshare.chk">R7000_380.70_0-X7.9.1-koolshare.chk</a><br><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.trx" title="R7000_380.70_0-X7.9.1-koolshare.trx">R7000_380.70_0-X7.9.1-koolshare.trx</a></p><h3 id="åˆ·æœºæ–¹æ³•"><a class="header-anchor" href="#åˆ·æœºæ–¹æ³•">â¡ï¸</a>åˆ·æœºæ–¹æ³•</h3><ul><li><a href="http://xn--www-0v1e42ucr2b2w5b9xj.routerlogin.net">æµè§ˆå™¨è¾“å…¥www.routerlogin.net</a></li><li>è¿›å…¥<code>é«˜çº§</code>â€”<code>ç®¡ç†</code>â€”<code>å›ºä»¶æ›´æ–°</code>ï¼Œä¸Šä¼  <code>R7000_380.70_0-X7.9.1-koolshare.chk</code> å›ºä»¶ï¼Œç‚¹æ›´æ–°(æœ‰å¾ˆå¤šæ•™ç¨‹è¯´è¦åœ¨è¿™ä¸€æ­¥ä¹‹å‰æ¢å¤å‡ºå‚è®¾ç½®,ä¸è¿‡æˆ‘è¿™è¾¹æ²¡æœ‰æ¢å¤ä¹Ÿå¯ä»¥,å¦‚æœæœ‰ç©å®¶ä¸æ”¾å¿ƒæ¢å¤å‡ºå‚è®¾ç½®ä¹Ÿå¯ä»¥)<br>æ›´æ–°å›ºä»¶è¿‡ç¨‹ä¸­è·¯ç”±å™¨å¯èƒ½è¦é‡å¯å‡ æ¬¡</li><li>å†è¾“å…¥<a href="http://router.asus.com/" title="http://router.asus.com/">http://router.asus.com/</a>è®¿é—®æ–°çš„å›ºä»¶çš„æ§åˆ¶é¢æ¿</li><li>æ¢å¤ä¸€æ¬¡å‡ºå‚è®¾ç½®(è¿™ä¸€æ¬¡æ¢å¤å‡ºå‚è®¾ç½®å’Œæ ¼å¼åŒ–jffsåˆ†åŒºä¹Ÿä¸æ˜¯æ˜¯å¿…é¡»çš„)</li><li>æ ¼å¼åŒ–jffsåˆ†åŒº è¿›å…¥è·¯ç”±ç®¡ç†ç•Œé¢ -<code>ç³»ç»Ÿç®¡ç†</code>- <code>ç³»ç»Ÿè®¾ç½®</code>ï¼Œå‹¾é€‰<code>Format JFFS partition at next boot</code>ï¼Œç‚¹å‡»åº”ç”¨æœ¬é¡µé¢è®¾ç½®åé‡å¯è·¯ç”±å™¨</li><li>è¿›å…¥è·¯ç”±å™¨è®¾ç½®ã€‚<code>ç³»ç»Ÿç®¡ç†</code>â€”<code>å›ºä»¶å‡çº§</code>ï¼Œé€‰æ‹© <code>R7000_380.70_0-X7.9.1-koolshare.trx</code> ä¸Šä¼ åæ›´æ–°ã€‚</li><li>å†æ¢å¤ä¸€æ¬¡å‡ºå‚è®¾ç½®å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†</li></ul><h5 id="æ¸…é…ç½®è¯´æ˜"><a class="header-anchor" href="#æ¸…é…ç½®è¯´æ˜">â¡ï¸</a>æ¸…é…ç½®è¯´æ˜</h5><table><thead><tr><th>A åˆ· B</th><th>ï¼ˆBï¼‰X6.x</th><th>ï¼ˆBï¼‰X7.x</th><th>ï¼ˆBï¼‰X7.9.1</th></tr></thead><tbody><tr><td>ï¼ˆAï¼‰X6.x</td><td>ä¿æŒ</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td></tr><tr><td>ï¼ˆAï¼‰X7.x</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>ä¿æŒ</td><td>ä¿æŒ</td></tr><tr><td>ï¼ˆAï¼‰X7.9.1</td><td>æ¸…é…ç½®+æ ¼å¼åŒ–jffs</td><td>ä»…æ ¼å¼åŒ–jffs</td><td>ä¿æŒ</td></tr></tbody></table><h5 id="å›ºä»¶åŒæ¸…æ–¹æ³•"><a class="header-anchor" href="#å›ºä»¶åŒæ¸…æ–¹æ³•">â¡ï¸</a>å›ºä»¶åŒæ¸…æ–¹æ³•</h5><p>å¦‚æœå›ºä»¶å‡ºç°é—®é¢˜,ä¸€æ—¶æ‰¾ä¸åˆ°è§£å†³åŠæ³•,å¯ä»¥å°è¯•åŒæ¸…å¹¶æ‰‹åŠ¨é…ç½®,æ–¹æ³•å¦‚ä¸‹</p><ul><li>æ ¼å¼åŒ–jffsåˆ†åŒºï¼šæ–¹æ³•åŒä¸Šï¼›</li><li>æ¢å¤å‡ºå‚è®¾ç½®ï¼šè¿›å…¥è·¯ç”±ç®¡ç†ç•Œé¢ -ã€ã€ç³»ç»Ÿç®¡ç†ã€‘- ã€æ¢å¤/å¯¼å‡º/ä¸Šä¼ è®¾ç½®ã€‘- ã€åŸå‚é»˜è®¤å€¼ã€‘ï¼Œç‚¹å‡»åŸå‚é»˜è®¤å€¼ä¸€æ çš„ã€æ¢å¤ã€‘æŒ‰é’®ï¼›</li><li>å»ºè®®å®ŒæˆåŒæ¸…åæ‰‹åŠ¨é…ç½®è·¯ç”±ï¼Œè€Œä¸æ˜¯ç”¨ä»¥å‰å¤‡ä»½çš„é…ç½®ï¼Œä»¥é¿å…å¯èƒ½çš„é—®é¢˜ï¼›</li></ul><h3 id="èµ„æºä¸‹è½½"><a class="header-anchor" href="#èµ„æºä¸‹è½½">â¡ï¸</a>èµ„æºä¸‹è½½</h3><ul><li>X7.9.1 å›ºä»¶ (trx)</li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9.1-koolshare.trx" title="R6300V2">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9.1-koolshare.trx" title="R6400">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.trx" title="R6900/R7000">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9.1-koolshare.trx" title="R8000">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9.1-koolshare.trx" title="R8500">R8500</a></li><li>X7.9.1 è¿‡æ¸¡å›ºä»¶ (chk)</li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9.1-koolshare.chk" title="R6300V2">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9.1-koolshare.chk" title="R6400">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9.1-koolshare.chk" title="R6900/R7000">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9.1-koolshare.chk" title="R8000">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9.1-koolshare.chk" title="R8500">R8500</a></li><li>X7.9</li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6300V2_380.70_0-X7.9-koolshare.trx" title="R6300V2">R6300V2</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R6400_380.70_0-X7.9-koolshare.trx" title="R6400">R6400</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R7000_380.70_0-X7.9-koolshare.trx" title="R6900/R7000">R6900/R7000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8000_380.70_0-X7.9-koolshare.trx" title="R8000">R8000</a></li><li><a href="https://blog.lilis.xin/pixivTop50/plugin/file/Router/R8500_380.70_0-X7.9-koolshare.trx" title="R8500">R8500</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹å‰ä¹°äº†ä¸€ä¸ªNetgear R7000 è·¯ç”±å™¨,åˆ°æ‰‹åå°±æ„Ÿè§‰å¿å—ä¸äº†å®ƒçš„é‚£ä¸ªè¶…ä¸å¥½ç”¨çš„web ui,æ‰€ä»¥å°±æ²¡ä¸Šæ‰‹ä¸¤åˆ†é’Ÿæœæ–­åˆ·æœºæˆMerlinäº†.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Merlin" scheme="https://hexo.lilis.xin/tags/Merlin/"/>
    
      <category term="R7000" scheme="https://hexo.lilis.xin/tags/R7000/"/>
    
      <category term="è·¯ç”±å™¨" scheme="https://hexo.lilis.xin/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>æµ‹è¯•Emojiè¡¨æƒ…</title>
    <link href="https://hexo.lilis.xin/posts/5cd7067a/"/>
    <id>https://hexo.lilis.xin/posts/5cd7067a/</id>
    <published>2018-10-29T13:43:42.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ğŸ° ğŸ¨ ğŸ¸ ğŸ ğŸ¾ ğŸ˜„ ğŸ’™âœˆï¸ğŸ‘¶ğŸ¤ğŸˆğŸ»ğŸŒµğŸ‘¯ğŸ˜°ğŸ‚ğŸ’‹ğŸƒğŸ™</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;ğŸ° ğŸ¨ ğŸ¸ ğŸ ğŸ¾ ğŸ˜„ ğŸ’™âœˆï¸ğŸ‘¶ğŸ¤ğŸˆğŸ»ğŸŒµğŸ‘¯ğŸ˜°ğŸ‚ğŸ’‹ğŸƒğŸ™&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="emoji" scheme="https://hexo.lilis.xin/tags/emoji/"/>
    
  </entry>
  
  <entry>
    <title>LaravelSå¼€å‘è®°å½•</title>
    <link href="https://hexo.lilis.xin/posts/45ef7ac/"/>
    <id>https://hexo.lilis.xin/posts/45ef7ac/</id>
    <published>2018-10-29T08:35:19.000Z</published>
    <updated>2019-09-13T07:34:45.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ä¸»è¦è®°å½•äº†ç”±æ™®é€šPHPå¼€å‘è€…åˆæ­¥æ¥è§¦laravelSæ˜¯æ‰€é‡åˆ°çš„ä¸€äº›å°å‘</p><a id="more"></a><h3 id="LaravelSä»‹ç»"><a class="header-anchor" href="#LaravelSä»‹ç»">â¡ï¸</a>LaravelSä»‹ç»</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> _                               _  _____</span><br><span class="line">| |                             | |&#x2F; ____|</span><br><span class="line">| |     __ _ _ __ __ ___   _____| | (___</span><br><span class="line">| |    &#x2F; _&#96; | &#39;__&#x2F; _&#96; \ \ &#x2F; &#x2F; _ \ |\___ \</span><br><span class="line">| |___| (_| | | | (_| |\ V &#x2F;  __&#x2F; |____) |</span><br><span class="line">|______\__,_|_|  \__,_| \_&#x2F; \___|_|_____&#x2F;</span><br></pre></td></tr></table></figure><p>LaravelSæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä½¿æ™®é€šçš„laravelé¡¹ç›®å°½å¿«çš„äº«å—ä¸Šswooleçš„ä¼˜åŠ¿çš„laravelæ’ä»¶<br>å®˜æ–¹æè¿°:<br>ğŸš€LaravelSæ˜¯ä¸€ä¸ªèƒ¶æ°´é¡¹ç›®ï¼Œç”¨äºå¿«é€Ÿé›†æˆSwooleåˆ°Laravelæˆ–Lumenï¼Œç„¶åèµ‹äºˆå®ƒä»¬æ›´å¥½çš„æ€§èƒ½ã€æ›´å¤šå¯èƒ½æ€§ã€‚</p><p>GitHubåœ°å€:</p><div style="text-align: center">  <div class="github-card" data-user="hhxsv5" data-repo="laravel-s" data-height="200px" data-width="100%" data-theme="default" data-target="blank" data-client-id data-client-secret></div></div><script src="/github-card-lib/githubcard.js"></script><p>æ–‡æ¡£åœ°å€:<br><a href="https://github.com/hhxsv5/laravel-s/blob/master/README-CN.md" title="laravel-s/README-CN.md">laravel-s/README-CN.md</a><br>Laravel-Chinaåœ°å€:<br><a href="https://laravel-china.org/articles/8050/laravels-speed-up-laravellumen-through-swoole" title="LaravelS - åŸºäº Swoole åŠ é€Ÿ Laravel/Lumen - å¸¦ä½ é£ ğŸš€">LaravelS - åŸºäº Swoole åŠ é€Ÿ Laravel/Lumen - å¸¦ä½ é£ ğŸš€</a></p><h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">â¡ï¸</a>å®‰è£…</h3><h4 id="å®‰è£…è¦æ±‚"><a class="header-anchor" href="#å®‰è£…è¦æ±‚">â¡ï¸</a>å®‰è£…è¦æ±‚</h4><table><thead><tr><th>ä¾èµ–</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>PHP</td><td>&gt;= 5.5.9 æ¨èPHP7+</td></tr><tr><td>Swoole</td><td>&gt;= 1.7.19 ä»2.0.12å¼€å§‹ä¸å†æ”¯æŒPHP5 æ¨è4.2.3+</td></tr><tr><td>Laravel/Lumen</td><td>&gt;= 5.1 æ¨è5.6+</td></tr></tbody></table><h4 id="å®‰è£…swoole"><a class="header-anchor" href="#å®‰è£…swoole">â¡ï¸</a>å®‰è£…swoole</h4><p>è¯¦ç»†è¯·å‚è€ƒ <a href="https://hexo.lilis.xin/2018/07/26/install-swoole/" title="swooleå®‰è£…">swooleå®‰è£…</a></p><h4 id="å®‰è£…laravel"><a class="header-anchor" href="#å®‰è£…laravel">â¡ï¸</a>å®‰è£…laravel</h4><p>å¯ä»¥é€šè¿‡composerç›´æ¥å®‰è£…,æˆ–è€…å®‰è£…å®‰è£…å™¨æˆ–è€…ç›´æ¥ä»GitHubæ‹·è´æºä»£ç æ¥å®‰è£…</p><h4 id="å®‰è£…laravelS"><a class="header-anchor" href="#å®‰è£…laravelS">â¡ï¸</a>å®‰è£…laravelS</h4><ol><li>é€šè¿‡Composerå®‰è£…</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">composer require &quot;hhxsv5/laravel-s:~3.0&quot; -vvv</span><br><span class="line"><span class="meta">#</span><span class="bash"> ç¡®ä¿ä½ çš„composer.lockæ–‡ä»¶æ˜¯åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­</span></span><br></pre></td></tr></table></figure><ol start="2"><li>æ³¨å†Œ<code>Service Provider</code><ul><li>Laravel: ä¿®æ”¹æ–‡ä»¶<code>config/app.php</code>ï¼ŒLaravel 5.5+æ”¯æŒåŒ…è‡ªåŠ¨å‘ç°ï¼Œä½ åº”è¯¥è·³è¿‡è¿™æ­¥</li></ul></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;providers&#x27;</span> =&gt; [</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    Hhxsv5\LaravelS\Illuminate\LaravelSServiceProvider::class,</span><br><span class="line">],</span><br></pre></td></tr></table></figure><pre><code>- Lumen: ä¿®æ”¹æ–‡ä»¶`bootstrap/app.php`</code></pre><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$app</span>-&gt;register(Hhxsv5\LaravelS\Illuminate\LaravelSServiceProvider::class);</span><br></pre></td></tr></table></figure><ol start="3"><li>å‘å¸ƒé…ç½®æ–‡ä»¶.</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan laravels publish</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ç”¨çš„æ˜¯<code>lumen</code>,ä¸éœ€è¦åŠ è½½<code>config/laravels.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªå¯æœ‰å¯æ— </span></span><br><span class="line"><span class="variable">$app</span>-&gt;configure(<span class="string">&#x27;laravels&#x27;</span>);</span><br></pre></td></tr></table></figure><ol start="4"><li>ä¿®æ”¹é…ç½®<code>config/laravels.php</code><br>è¯·å‚è€ƒ<code>laravelSé…ç½®é¡¹</code></li></ol><h4 id="è¿è¡Œ"><a class="header-anchor" href="#è¿è¡Œ">â¡ï¸</a>è¿è¡Œ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan laravels &#123;start|stop|restart|reload|publish&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>start</td><td>å¯åŠ¨<code>LaravelS</code>ã€‚é€‰é¡¹<code>-d</code>æˆ–<code>--daemonize</code>ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œæ­¤é€‰é¡¹å°†è¦†ç›–<code>laravels.php</code>ä¸­<code>swoole.daemonize</code>è®¾ç½®</td></tr><tr><td>stop</td><td>åœæ­¢<code>LaravelS</code></td></tr><tr><td>restart</td><td>é‡å¯<code>LaravelS</code>ï¼Œæ”¯æŒé€‰é¡¹<code>-d</code>æˆ–<code>--daemonize</code></td></tr><tr><td>reload</td><td>å¹³æ»‘é‡å¯æ‰€æœ‰<code>worker</code>è¿›ç¨‹ï¼Œè¿™äº›<code>worker</code>è¿›ç¨‹å†…åŒ…å«ä½ çš„ä¸šåŠ¡ä»£ç å’Œæ¡†æ¶(<code>Laravel/Lumen</code>)ä»£ç ï¼Œä¸ä¼šé‡å¯<code>master/manger</code>è¿›ç¨‹</td></tr><tr><td>publish</td><td>å‘å¸ƒé…ç½®æ–‡ä»¶åˆ°ä½ çš„é¡¹ç›®ä¸­<code>config/laravels.php</code></td></tr></tbody></table><p>ps:å±•ç¤ºå·²ç»å¯åŠ¨çš„é¡¹ç›®:<br><code>ps -ef|grep laravels</code></p><h4 id="é…ç½®nginx"><a class="header-anchor" href="#é…ç½®nginx">â¡ï¸</a>é…ç½®nginx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">gzip on;</span><br><span class="line">gzip_min_length 1024;</span><br><span class="line">gzip_comp_level 2;</span><br><span class="line">gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml application/x-httpd-php image/jpeg image/gif image/png font/ttf font/otf image/svg+xml;</span><br><span class="line">gzip_vary on;</span><br><span class="line">gzip_disable &quot;msie6&quot;;</span><br><span class="line">upstream laravels &#123;</span><br><span class="line">    # By IP:Port</span><br><span class="line">    server 127.0.0.1:9100 weight=5 max_fails=3 fail_timeout=30s; #è¿™é‡Œé…ç½®çš„æ˜¯laravelSç›‘å¬çš„æ¥å£å‚æ•°</span><br><span class="line">    # By UnixSocket Stream file</span><br><span class="line">    #server unix:/xxxpath/laravel-s-test/storage/laravels.sock weight=5 max_fails=3 fail_timeout=30s;</span><br><span class="line">    #server 192.168.1.1:5200 weight=3 max_fails=3 fail_timeout=30s;</span><br><span class="line">    #server 192.168.1.2:5200 backup;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">listen 80;</span><br><span class="line">server_name laravels.com;</span><br><span class="line"><span class="meta">#</span><span class="bash">ä¸ºäº†ç»™nginxå®šä½é™æ€èµ„æº</span></span><br><span class="line">root /xxxpath/laravel-s-test/public;</span><br><span class="line"><span class="meta">#</span><span class="bash"> Nginxå¤„ç†é™æ€èµ„æº(å»ºè®®å¼€å¯gzip)ï¼ŒLaravelSå¤„ç†åŠ¨æ€èµ„æºã€‚</span></span><br><span class="line">location / &#123;</span><br><span class="line">try_files $uri @laravels;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location @laravels &#123;</span><br><span class="line">        proxy_connect_timeout 60s;</span><br><span class="line">        proxy_send_timeout 60s;</span><br><span class="line">        proxy_read_timeout 120s;</span><br><span class="line">        proxy_set_header Connection &quot;keep-alive&quot;;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        proxy_set_header Scheme $scheme;</span><br><span class="line">        proxy_set_header Server-Protocol $server_protocol;</span><br><span class="line">        proxy_set_header Server-Name $server_name;</span><br><span class="line">        proxy_set_header Server-Addr $server_addr;</span><br><span class="line">        proxy_set_header Server-Port $server_port;</span><br><span class="line">        proxy_pass http://laravels;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é…ç½®Apache"><a class="header-anchor" href="#é…ç½®Apache">â¡ï¸</a>é…ç½®Apache</h4><p>ps:æˆ‘ç”¨çš„æ˜¯nginx,æ²¡æœ‰å®é™…é…ç½®è¿‡,å°±ç›´æ¥æŠŠå®˜æ–¹æ–‡æ¡£é‡Œçš„æ‹¿è¿‡æ¥äº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">LoadModule proxy_module /yyypath/modules/mod_deflate.so</span><br><span class="line"><span class="tag">&lt;<span class="name">IfModule</span> <span class="attr">deflate_module</span>&gt;</span></span><br><span class="line">    SetOutputFilter DEFLATE</span><br><span class="line">    DeflateCompressionLevel 2</span><br><span class="line">    AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml application/x-httpd-php image/jpeg image/gif image/png font/ttf font/otf image/svg+xml</span><br><span class="line"><span class="tag">&lt;/<span class="name">IfModule</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">VirtualHost</span> *<span class="attr">:80</span>&gt;</span></span><br><span class="line">    # åˆ«å¿˜äº†ç»‘Hostå“Ÿ</span><br><span class="line">    ServerName www.laravels.com</span><br><span class="line">    ServerAdmin hhxsv5@sina.com</span><br><span class="line"></span><br><span class="line">    DocumentRoot /xxxpath/laravel-s-test/public;</span><br><span class="line">    DirectoryIndex index.html index.htm</span><br><span class="line">    <span class="tag">&lt;<span class="name">Directory</span> &quot;/&quot;&gt;</span></span><br><span class="line">        AllowOverride None</span><br><span class="line">        Require all granted</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy_balancer.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_lbmethod_byrequests.so.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_proxy_http.so.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_slotmem_shm.so</span><br><span class="line">    LoadModule proxy_module /yyypath/modules/mod_rewrite.so</span><br><span class="line"></span><br><span class="line">    ProxyRequests Off</span><br><span class="line">    ProxyPreserveHost On</span><br><span class="line">    <span class="tag">&lt;<span class="name">Proxy</span> <span class="attr">balancer:</span>//<span class="attr">laravels</span>&gt;</span></span><br><span class="line">        BalancerMember http://192.168.1.1:8011 loadfactor=7</span><br><span class="line">        #BalancerMember http://192.168.1.2:8011 loadfactor=3</span><br><span class="line">        #BalancerMember http://192.168.1.3:8011 loadfactor=1 status=+H</span><br><span class="line">        ProxySet lbmethod=byrequests</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Proxy</span>&gt;</span></span><br><span class="line">    #ProxyPass / balancer://laravels/</span><br><span class="line">    #ProxyPassReverse / balancer://laravels/</span><br><span class="line"></span><br><span class="line">    # Apacheå¤„ç†é™æ€èµ„æºï¼ŒLaravelSå¤„ç†åŠ¨æ€èµ„æºã€‚</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteCond %&#123;DOCUMENT_ROOT&#125;%&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">    RewriteCond %&#123;DOCUMENT_ROOT&#125;%&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">    RewriteRule ^/(.*)$ balancer://laravels/%&#123;REQUEST_URI&#125; [P,L]</span><br><span class="line"></span><br><span class="line">    ErrorLog $&#123;APACHE_LOG_DIR&#125;/www.laravels.com.error.log</span><br><span class="line">    CustomLog $&#123;APACHE_LOG_DIR&#125;/www.laravels.com.access.log combined</span><br><span class="line"><span class="tag">&lt;/<span class="name">VirtualHost</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡"><a class="header-anchor" href="#è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡">â¡ï¸</a>è‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡</h4><p>æ­¤ç‰¹æ€§ä¾èµ–<code>Swoole</code>çš„<code>AsyncTask</code>ï¼Œå¿…é¡»å…ˆè®¾ç½®<code>config/laravels.php</code>çš„<code>swoole.task_worker_num</code>ã€‚<br>å¼‚æ­¥äº‹ä»¶çš„å¤„ç†èƒ½åŠ›å—<code>Task</code>è¿›ç¨‹æ•°å½±å“ï¼Œéœ€åˆç†è®¾ç½®<code>task_worker_num</code>ã€‚<br>ä»»åŠ¡ç»“æ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Task</span>\<span class="title">Message</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Traits</span>\<span class="title">Push</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Hhxsv5</span>\<span class="title">LaravelS</span>\<span class="title">Swoole</span>\<span class="title">Task</span>\<span class="title">Task</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reply</span> <span class="keyword">extends</span> <span class="title">Task</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»»åŠ¡é€»è¾‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="comment">//Do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ps: ä»»åŠ¡é‡Œæ²¡æœ‰ä¾èµ–æ³¨å…¥è¿™ç§ä¾¿æ·çš„ä¸œè¥¿<br>æŠ•é€’ä»»åŠ¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹åŒ–$actionå¹¶é€šè¿‡deliveræŠ•é€’</span></span><br><span class="line"><span class="comment">//æ­¤æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼ŒæŠ•é€’åç«‹å³è¿”å›</span></span><br><span class="line"><span class="comment">//ç”±Taskè¿›ç¨‹ç»§ç»­å¤„ç†$actionä¸­çš„handleé€»è¾‘</span></span><br><span class="line"><span class="variable">$task</span> = <span class="keyword">new</span> \App\Task\Message\Reply(<span class="variable">$dat</span>);</span><br><span class="line"><span class="comment">// $task-&gt;delay(3);// å»¶è¿Ÿ3ç§’æŠ•æ”¾ä»»åŠ¡</span></span><br><span class="line">\Hhxsv5\LaravelS\Swoole\Task\Task::deliver(<span class="variable">$task</span>);</span><br></pre></td></tr></table></figure><h4 id="laravelSé…ç½®é¡¹"><a class="header-anchor" href="#laravelSé…ç½®é¡¹">â¡ï¸</a>laravelSé…ç½®é¡¹</h4><ul><li><p><code>listen_ip</code>ï¼š<code>string</code> ç›‘å¬çš„IPï¼Œç›‘å¬æœ¬æœº<code>127.0.0.1</code>(IPv4) <code>::1</code>(IPv6)ï¼Œç›‘å¬æ‰€æœ‰åœ°å€ <code>0.0.0.0</code>(IPv4) ::(IPv6)ï¼Œ é»˜è®¤<code>127.0.0.1</code>ã€‚</p></li><li><p><code>listen_port</code>ï¼š<code>int</code> ç›‘å¬çš„ç«¯å£ï¼Œå¦‚æœç«¯å£å°äº1024åˆ™éœ€è¦rootæƒé™ï¼Œ<code>default 5200</code>ã€‚</p></li><li><p><code>socket_type</code>ï¼šé»˜è®¤<code>SWOOLE_SOCK_TCP</code>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ— éœ€å…³å¿ƒè¿™ä¸ªé…ç½®ã€‚è‹¥éœ€Nginxä»£ç†è‡³<code>UnixSocket Stream</code>æ–‡ä»¶ï¼Œåˆ™éœ€ä¿®æ”¹ä¸º<code>SWOOLE_SOCK_UNIX_STREAM</code>ï¼Œæ­¤æ—¶<code>listen_ip</code>åˆ™æ˜¯<code>UnixSocket Stream</code>æ–‡ä»¶çš„è·¯å¾„ã€‚</p></li><li><p><code>enable_gzip</code>ï¼šbool å½“é€šè¿‡LaravelSå“åº”æ•°æ®æ—¶ï¼Œæ˜¯å¦å¯ç”¨gzipå‹ç¼©å“åº”çš„å†…å®¹ï¼Œä¾èµ–åº“<code>zlib</code>ï¼Œé€šè¿‡å‘½ä»¤<code>php --ri swoole|grep zlib</code>æ£€æŸ¥<code>gzip</code>æ˜¯å¦å¯ç”¨ã€‚å¦‚æœå¼€å¯åˆ™ä¼šè‡ªåŠ¨åŠ ä¸Šå¤´éƒ¨<code>Content-Encoding</code>ï¼Œé»˜è®¤<code>false</code>ã€‚å¦‚æœå­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼ˆä¾‹å¦‚Nginxï¼‰ï¼Œå»ºè®®ä»£ç†æœåŠ¡å™¨å¼€å¯<code>gzip</code>ï¼Œ<code>LaravelS</code>å…³é—­gzipï¼Œé¿å…é‡å¤<code>gzip</code>å‹ç¼©ã€‚</p></li><li><p><code>server</code>ï¼š<code>string</code> å½“é€šè¿‡<code>LaravelS</code>å“åº”æ•°æ®æ—¶ï¼Œè®¾ç½®<code>HTTP</code>å¤´éƒ¨<code>Server</code>çš„å€¼ï¼Œè‹¥ä¸ºç©ºåˆ™ä¸è®¾ç½®ï¼Œ<code>default LaravelS</code>ã€‚</p></li><li><p><code>handle_static</code>ï¼š<code>bool</code> æ˜¯å¦å¼€å¯<code>LaravelS</code>å¤„ç†é™æ€èµ„æº(è¦æ±‚ <code>Swoole &gt;= 1.7.21</code>ï¼Œè‹¥<code>Swoole &gt;= 1.9.17</code>åˆ™ç”±Swooleè‡ªå·±å¤„ç†)ï¼Œé»˜è®¤<code>false</code>ï¼Œå»ºè®®<code>Nginx</code>å¤„ç†é™æ€èµ„æºï¼Œ<code>LaravelS</code>ä»…å¤„ç†åŠ¨æ€èµ„æºã€‚é™æ€èµ„æºçš„é»˜è®¤è·¯å¾„ä¸º<code>base_path('public')</code>ï¼Œå¯é€šè¿‡ä¿®æ”¹<code>swoole.document_root</code>å˜æ›´ã€‚</p></li><li><p><code>laravel_base_path</code>ï¼š<code>string</code> <code>Laravel/Lumen</code>çš„åŸºç¡€è·¯å¾„ï¼Œé»˜è®¤<code>base_path()</code>ï¼Œå¯ç”¨äºé…ç½®ç¬¦å·é“¾æ¥ã€‚</p></li><li><p><code>inotify_reload.enable</code>ï¼š<code>bool</code> æ˜¯å¦å¼€å¯<code>Inotify Reload</code>ï¼Œç”¨äºå½“ä¿®æ”¹ä»£ç åå®æ—¶<code>Reload</code>æ‰€æœ‰<code>worker</code>è¿›ç¨‹ï¼Œä¾èµ–åº“<code>inotify</code>ï¼Œé€šè¿‡å‘½ä»¤<code>php --ri inotify</code>æ£€æŸ¥æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤<code>false</code>ï¼Œå»ºè®®ä»…å¼€å‘ç¯å¢ƒå¼€å¯ï¼Œä¿®æ”¹ç›‘å¬æ•°ä¸Šé™ã€‚</p></li><li><p><code>inotify_reload.watch_path</code>ï¼š<code>string</code> <code>Inotify</code> ç›‘æ§çš„æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤æœ‰<code>base_path()</code>ã€‚</p></li><li><p><code>inotify_reload.file_types</code>ï¼š<code>array</code> <code>Inotify</code> ç›‘æ§çš„æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤æœ‰<code>.php</code>ã€‚</p></li><li><p><code>inotify_reload.log</code>ï¼š<code>bool</code> æ˜¯å¦è¾“å‡º<code>Reload</code>çš„æ—¥å¿—ï¼Œé»˜è®¤<code>true</code>ã€‚</p></li><li><p><code>websocket.enable</code>ï¼š<code>bool</code> æ˜¯å¦å¯ç”¨<code>WebSocket</code>æœåŠ¡å™¨ã€‚å¯ç”¨å<code>WebSocket</code>æœåŠ¡å™¨ç›‘å¬çš„<code>IP</code>å’Œç«¯å£ä¸<code>Http</code>æœåŠ¡å™¨ç›¸åŒï¼Œé»˜è®¤<code>false</code>ã€‚</p></li><li><p><code>websocket.handler</code>ï¼š<code>string</code> <code>WebSocket</code>é€»è¾‘å¤„ç†çš„ç±»åï¼Œéœ€å®ç°æ¥å£<code>WebSocketHandlerInterface</code>ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>sockets</code>ï¼š<code>array</code> é…ç½®<code>TCP/UDP</code>å¥—æ¥å­—åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>processes</code>ï¼š<code>array</code> é…ç½®è‡ªå®šä¹‰è¿›ç¨‹åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>events</code>ï¼š<code>array</code> è‡ªå®šä¹‰çš„å¼‚æ­¥äº‹ä»¶å’Œç›‘å¬çš„ç»‘å®šåˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>swoole_tables</code>ï¼š<code>array</code> å®šä¹‰çš„<code>swoole_table</code>åˆ—è¡¨ï¼Œå‚è€ƒç¤ºä¾‹ã€‚</p></li><li><p><code>register_providers</code>ï¼š<code>array</code> æ¯æ¬¡è¯·æ±‚éœ€è¦é‡æ–°æ³¨å†Œçš„<code>Service Provider</code>åˆ—è¡¨ï¼Œè‹¥å­˜åœ¨<code>boot()</code>æ–¹æ³•ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œã€‚ä¸€èˆ¬ç”¨äºæ¸…ç†æ³¨å†Œäº†å•ä¾‹çš„<code>ServiceProvider</code>ã€‚</p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="string">&#x27;register_providers&#x27;</span> =&gt; [</span><br><span class="line">    <span class="comment">//ä¾‹å¦‚ï¼šé‡æ–°æ³¨å†Œjwtçš„ServiceProvider</span></span><br><span class="line">    \Tymon\JWTAuth\Providers\LaravelServiceProvider::class,</span><br><span class="line">],</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><ul><li>swooleï¼š<code>array</code> <code>Swoole</code>çš„åŸå§‹é…ç½®é¡¹ï¼Œè¯·å‚è€ƒ<a href="https://wiki.swoole.com/wiki/page/274.html" title="Swooleé…ç½®é¡¹">Swooleé…ç½®é¡¹</a>ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸»è¦è®°å½•äº†ç”±æ™®é€šPHPå¼€å‘è€…åˆæ­¥æ¥è§¦laravelSæ˜¯æ‰€é‡åˆ°çš„ä¸€äº›å°å‘&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="å¼‚æ­¥" scheme="https://hexo.lilis.xin/tags/%E5%BC%82%E6%AD%A5/"/>
    
      <category term="laravel" scheme="https://hexo.lilis.xin/tags/laravel/"/>
    
      <category term="LaravelS" scheme="https://hexo.lilis.xin/tags/LaravelS/"/>
    
      <category term="Lumen" scheme="https://hexo.lilis.xin/tags/Lumen/"/>
    
      <category term="swoole" scheme="https://hexo.lilis.xin/tags/swoole/"/>
    
  </entry>
  
  <entry>
    <title>phpåœ¨linuxä¸‹call to undefined function imagettftext()</title>
    <link href="https://hexo.lilis.xin/posts/d90db6f7/"/>
    <id>https://hexo.lilis.xin/posts/d90db6f7/</id>
    <published>2018-09-19T11:13:43.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>åœ¨çº¿ä¸Šç¯å¢ƒæµ‹è¯•å›¾ç‰‡ç”Ÿæˆçš„æ—¶å€™æŠ¥é”™:<code>call to undefined function imagettftext()</code></p><a id="more"></a><h4 id="è§£å†³æ–¹æ¡ˆ"><a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ">â¡ï¸</a>è§£å†³æ–¹æ¡ˆ</h4><p>ä¸‹è½½å®‰è£…<a href="https://sourceforge.net/projects/freetype/files/freetype2/2.7.1/freetype-2.7.1.tar.gz/download" title="freetype">freetype</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/local/freetype/2.7.1 --without-harfbuzz //ç¼–è¯‘</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>å†é‡æ–°ç¼–è¯‘å®‰è£…gd</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">phpize</span><br><span class="line">make clean</span><br><span class="line">./configure --with-php-config=/usr/local/php/php72/bin/php-config--with-freetype-dir=/usr/local/freetype/2.7.1/ --enable-gd-native-ttf</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨çº¿ä¸Šç¯å¢ƒæµ‹è¯•å›¾ç‰‡ç”Ÿæˆçš„æ—¶å€™æŠ¥é”™:&lt;code&gt;call to undefined function imagettftext()&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="gd" scheme="https://hexo.lilis.xin/tags/gd/"/>
    
      <category term="freetype" scheme="https://hexo.lilis.xin/tags/freetype/"/>
    
  </entry>
  
  <entry>
    <title>phpæ“ä½œredis</title>
    <link href="https://hexo.lilis.xin/posts/a8f30b9a/"/>
    <id>https://hexo.lilis.xin/posts/a8f30b9a/</id>
    <published>2018-09-19T03:32:16.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>è¿™é‡Œä¸»è¦æ˜¯ç”¨çš„predis</p><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//éªŒè¯æ˜¯å¦å®‰è£…OK:æ‰“å¼€dosçª—å£-&gt;è¾“å…¥redis-server åœ¨æ‰“å¼€ä¸€ä¸ªdosçª—å£--&gt;è¾“å…¥redis-cli æ˜¾ç¤ºï¼š127.0.0.1:6379&gt;åˆ™æˆåŠŸï¼</span></span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> redis();</span><br><span class="line"><span class="variable">$redis</span>-&gt;connect(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="string">&#x27;6379&#x27;</span>) || <span class="keyword">die</span>(<span class="string">&quot;è¿æ¥å¤±è´¥ï¼&quot;</span>);</span><br><span class="line"><span class="variable">$redis</span>-&gt;auth(<span class="string">&quot;admin&quot;</span>); <span class="comment">//æˆæƒ</span></span><br><span class="line"><span class="comment">//******************************stringç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//String æ˜¯æœ€ç®€å•çš„ç±»å‹ï¼Œä¸€ä¸ªKeyå¯¹åº”ä¸€ä¸ªValueï¼ŒStringç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚Redisçš„Stringå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ï¼Œæ¯”å¦‚jpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;set(<span class="string">&#x27;test&#x27;</span>, <span class="number">200</span>); <span class="comment">//èµ‹å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;mset(<span class="keyword">array</span>(<span class="string">&#x27;key0&#x27;</span> =&gt; <span class="string">&#x27;value0&#x27;</span>, <span class="string">&#x27;key1&#x27;</span> =&gt; <span class="string">&#x27;value1&#x27;</span>));<span class="comment">//æ‰¹é‡èµ‹å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;mget(<span class="keyword">array</span>(<span class="string">&#x27;key0&#x27;</span>, <span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>));<span class="comment">//æ‰¹é‡è·å–å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;setnx(<span class="string">&#x27;key&#x27;</span>,value);<span class="comment">//è®¾ç½®keyå¯¹åº”çš„å€¼ä¸ºstringç±»å‹çš„value,å¦‚æœkeyå·²ç»å­˜åœ¨ï¼Œè¿”å›0,nxæ˜¯not existçš„æ„æ€</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;msetnx(<span class="keyword">array</span>(<span class="string">&#x27;key0&#x27;</span> =&gt; <span class="string">&#x27;value0&#x27;</span>, <span class="string">&#x27;key1&#x27;</span> =&gt; <span class="string">&#x27;value1&#x27;</span>));<span class="comment">//å…¨éƒ¨æˆåŠŸè¿”å›1ï¼Œå¦åˆ™å¤±è´¥ä¸€ä¸ªä¹Ÿè¿”å›0</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;getset(<span class="string">&quot;key&quot;</span>,<span class="string">&#x27;newvalue&#x27;</span>);<span class="comment">//getsetè®¾ç½®keyçš„å€¼ï¼Œå¹¶è¿”å›keyçš„æ—§å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;setex(<span class="string">&#x27;key&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;value10&#x27;</span>);<span class="comment">//å¸¦ç”Ÿå­˜æ—¶é—´çš„å†™å…¥å€¼å•ä½s</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;setrange(<span class="string">&#x27;key&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;hello&#x27;</span>);<span class="comment">//è®¾ç½®å­å­—ç¬¦ä¸²æ›¿æ¢ï¼Œkeyï¼Œå¼€å§‹ä½ç½®ï¼Œæ›¿æ¢å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;getrange(<span class="string">&quot;key&quot;</span>,<span class="number">0</span>,<span class="number">2</span>);<span class="comment">//getrangeè·å–å­å­—ç¬¦ä¸²ï¼Œgetrange key start end</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;ttl(<span class="string">&#x27;key&#x27;</span>);<span class="comment">//è·å–keyçš„ç”Ÿå­˜æ—¶é—´,æ²¡è®¾ç½®çš„ä¸º-1</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;keys(<span class="string">&quot;*a*&quot;</span>);<span class="comment">//è·å–æ‰€æœ‰keyï¼Œä¹Ÿå¯è·å–å…·ä½“keyï¼Œæ¨¡ç³ŠåŒ¹é…key</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;get(<span class="string">&quot;test&quot;</span>); <span class="comment">//æ ¹æ®keyè·å–value</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;getMultiple(<span class="keyword">array</span>(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>, <span class="string">&#x27;key3&#x27;</span>));</span><br><span class="line"><span class="variable">$exits</span> = <span class="variable">$redis</span>-&gt;exists(<span class="string">&#x27;test&#x27;</span>); <span class="comment">//åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ã€‚å­˜åœ¨ true ä¸å­˜åœ¨ false</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$exists</span>?<span class="variable">$res2</span>:<span class="string">&quot;null&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res1</span>?<span class="variable">$res2</span>:<span class="string">&quot;null&quot;</span>;<span class="keyword">die</span>;</span><br><span class="line"><span class="variable">$redis</span>-&gt;delete(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>); <span class="comment">//åˆ é™¤,å¯åˆ é™¤å¤šä¸ª</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;delete(<span class="keyword">array</span>(<span class="string">&#x27;key3&#x27;</span>, <span class="string">&#x27;key4&#x27;</span>, <span class="string">&#x27;key5&#x27;</span>));<span class="comment">//åˆ é™¤,å¯åˆ é™¤å¤šä¸ª</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;delete( <span class="variable">$redis</span>-&gt;keys(<span class="string">&quot;*&quot;</span>));<span class="comment">//ä¼ æ•°ç»„ï¼Œåˆ é™¤æ‰€æœ‰key</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;incr(<span class="string">&quot;key&quot;</span>,<span class="number">1</span>);<span class="comment">//è‡ªå¢ï¼Œé»˜è®¤å€¼1</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;incrBy(<span class="string">&#x27;key&#x27;</span>,<span class="number">10</span>);<span class="comment">//å¿…é¡»ç»™å®šå‚æ•°å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;decr(<span class="string">&quot;key&quot;</span>,<span class="number">10</span>);<span class="comment">//è‡ªå‡ï¼Œé»˜è®¤å€¼1</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;decrBy(<span class="string">&#x27;key&#x27;</span>,<span class="number">10</span>);<span class="comment">//å¿…é¡»ç»™å®šå‚æ•°å€¼</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;append(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;appendvalue&quot;</span>);<span class="comment">//ç»™æŒ‡å®šçš„keyçš„å­—ç¬¦ä¸²è¿½åŠ value,è¿”å›æ–°å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;strlen(<span class="string">&#x27;key&#x27;</span>);<span class="comment">//è·å–æŒ‡å®škeyçš„å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line"><span class="comment">//******************************stringç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//******************************hashç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">// Redis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ã€‚å®ƒçš„æ·»åŠ åˆ é™¤éƒ½æ˜¯0(1)</span></span><br><span class="line"><span class="comment">// hashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚ç›¸å¯¹äºå°†å¯¹è±¡çš„æ¯ä¸ªå­—æ®µå­˜æˆå•ä¸ªstringç±»å‹ã€‚</span></span><br><span class="line"><span class="comment">//å°†ä¸€ä¸ªå¯¹è±¡å­˜å‚¨åœ¨hashç±»å‹ä¸­ä¼šå ç”¨æ›´å°‘çš„å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥æ›´æ–¹ä¾¿çš„å­˜å–æ•´ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;flushall();<span class="keyword">die</span>;<span class="comment">//æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line"> <span class="variable">$redis</span>-&gt;flushdb();<span class="keyword">die</span>;<span class="comment">//æ¸…ç©ºå½“å‰æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$redis</span>-&gt;hset(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;username&quot;</span>,<span class="string">&quot;admin&quot;</span>);<span class="comment">//å•ä¸ªè®¾ç½®</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hget(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;username&quot;</span>);<span class="comment">//å•ä¸ªè·å–</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hsetnx(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;username&quot;</span>,<span class="string">&quot;admin@qq.com&quot;</span>);<span class="comment">//è®¾ç½®hash field ä¸ºæŒ‡å®šçš„å€¼value,å¦‚æœfeildå·²ç»å­˜åœ¨ï¼Œè¿”å›0,nxæ˜¯not existçš„æ„æ€  </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hmset(<span class="string">&quot;testabc&quot;</span>,<span class="keyword">array</span>(<span class="string">&quot;a&quot;</span>=&gt;<span class="number">1</span>,<span class="string">&quot;b&quot;</span>=&gt;<span class="number">2</span>,<span class="string">&quot;c&quot;</span>=&gt;<span class="number">3</span>,<span class="string">&#x27;d&#x27;</span>=&gt;<span class="number">4</span>));<span class="comment">//æ‰¹é‡è®¾ç½®</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hmget(<span class="string">&quot;testabc&quot;</span>,<span class="keyword">array</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>));<span class="comment">//æ‰¹é‡è·å–</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hincrBy(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123456&quot;</span>);<span class="comment">//è®¾ç½®hash field æ·»åŠ keyå’Œvalue</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hexists(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;usernames&quot;</span>);<span class="comment">//æµ‹è¯•hash field  å­˜åœ¨1ï¼Œä¸å­˜åœ¨0</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hlen(<span class="string">&quot;test&quot;</span>); <span class="comment">//è¿”å›hash é‡Œæ‰€æœ‰çš„ field çš„æ•°é‡</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hdel(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;key&quot;</span>);<span class="comment">//åˆ é™¤æŒ‡å®šhashçš„field</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hkeys(<span class="string">&quot;test&quot;</span>); <span class="comment">//è¿”å›hash æ‰€æœ‰ field</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hvals(<span class="string">&quot;test&quot;</span>);<span class="comment">//è¿”å›hash æ‰€æœ‰ field values</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;hgetall(<span class="string">&quot;test&quot;</span>);<span class="comment">//è·å–hashä¸­å…¨éƒ¨çš„fieldå’Œvalue</span></span><br><span class="line"><span class="comment">//******************************hashç±»å‹**********************************************************</span></span><br><span class="line"><span class="comment">//******************************listé“¾è¡¨**********************************************************</span></span><br><span class="line"><span class="comment">//æ ˆå…ˆè¿›åå‡ºï¼›é˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºï¼›</span></span><br><span class="line"><span class="comment">//List æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œä¸»è¦åŠŸèƒ½æ˜¯push,pop,è·å–ä¸€ä¸ªèŒƒå›´çš„æ‰€æœ‰å€¼ç­‰ç­‰ï¼Œæ“ä½œä¸­keyç†è§£ä¸ºé“¾è¡¨çš„åå­—ã€‚</span></span><br><span class="line"><span class="comment">//Redisçš„listç±»å‹å…¶å®å°±æ˜¯ä¸€ä¸ªæ¯ä¸ªå­å…ƒç´ éƒ½æ˜¯stringç±»å‹çš„åŒå‘é“¾è¡¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡push,popæ“ä½œä»é“¾è¡¨çš„å¤´éƒ¨æˆ–è€…å°¾éƒ¨æ·»åŠ åˆ é™¤å…ƒç´ ï¼Œè¿™æ ·LISTæ—¢å¯ä»¥ä½œä¸ºæ ˆï¼Œåˆå¯ä»¥ä½œä¸ºé˜Ÿåˆ—ã€‚</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lrange(<span class="string">&quot;list&quot;</span>,<span class="number">0</span>,<span class="number">-1</span>);<span class="comment">//å–é“¾è¡¨list ä»0ä½å¼€å§‹å–åˆ°æœ€åä½ç½®ï¼›0ä»£è¡¨å¤´  -1ä»£è¡¨å°¾</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lpush(<span class="string">&quot;list&quot;</span>,<span class="string">&quot;1&quot;</span>); <span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å¤´éƒ¨æ·»åŠ å­—ç¬¦ä¸²å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;rpush(<span class="string">&quot;list&quot;</span>,<span class="string">&quot;test&quot;</span>); <span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å°¾éƒ¨æ·»åŠ å­—ç¬¦ä¸²å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lpop(<span class="string">&quot;list&quot;</span>);<span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å¤´éƒ¨åˆ é™¤å­—ç¬¦ä¸²å…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤å­—ç¬¦</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;rpop(<span class="string">&quot;list&quot;</span>);<span class="comment">//åœ¨keyå¯¹åº”çš„listçš„å°¾éƒ¨åˆ é™¤å­—ç¬¦ä¸²å…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤å­—ç¬¦</span></span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$redis</span>-&gt;lrem(<span class="string">&quot;list&quot;</span>,<span class="number">2</span>,<span class="string">&#x27;key&#x27;</span>);<span class="comment">//åœ¨listä¸­åˆ é™¤Nä¸ªå’Œvalueç›¸åŒçš„å…ƒç´ (n&lt;0ä»å°¾åˆ é™¤,n=0å…¨éƒ¨åˆ é™¤),è¿”å›çš„å€¼ä¸ºåˆ é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lset(<span class="string">&quot;list&quot;</span>,<span class="number">-1</span>,<span class="string">&quot;å•Š&quot;</span>);<span class="comment">//è®¾ç½®listä¸­æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ å€¼ lset(list,ä½ç½®ï¼Œå€¼)ï¼Œä½ç½®å¯ä»¥ä»å¤´æˆ–è€…ä»å°¾</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lindex(<span class="string">&quot;list&quot;</span>,<span class="number">0</span>);<span class="comment">//è¿”å›listä¸­indexä½ç½®çš„å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;llen(<span class="string">&quot;list&quot;</span>);<span class="comment">//è¿”å›listçš„é•¿åº¦</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;ltrim(<span class="string">&quot;list&quot;</span>,<span class="number">0</span>,<span class="number">1</span>);<span class="comment">//ä¿ç•™æŒ‡å®škeyçš„å€¼çš„èŒƒå›´å†…çš„æ•°æ® 0ä¸ºå¤´  -1ä¸ºå°¾</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;linsert(<span class="string">&quot;list&quot;</span>);<span class="comment">//********</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;rpoplpush(<span class="string">&quot;list&quot;</span>,<span class="string">&quot;listt&quot;</span>);<span class="comment">//ä»ç¬¬ä¸€ä¸ªLISTçš„å°¾éƒ¨ç§»é™¤å…ƒç´ å¹¶æ·»åŠ åˆ°ç¬¬äºŒä¸ªLISTçš„å¤´éƒ¨</span></span><br><span class="line"><span class="comment">//******************************listé“¾è¡¨**********************************************************</span></span><br><span class="line"><span class="comment">//******************************seté›†åˆ**********************************************************</span></span><br><span class="line"><span class="comment">//  Setæ˜¯é›†åˆï¼Œå®ƒæ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚setæ˜¯é€šè¿‡hash tableå®ç°çš„ï¼Œæ·»åŠ ï¼Œåˆ é™¤å’ŒæŸ¥æ‰¾çš„å¤æ‚ç¨‹åº¦éƒ½æ˜¯0(1)</span></span><br><span class="line"><span class="comment">//   å¯¹é›†åˆæˆ‘ä»¬å¯ä»¥å–å¹¶é›†ï¼Œäº¤é›†ï¼Œå·®é›†ã€‚é€šè¿‡è¿™äº›æ“ä½œæˆ‘ä»¬å¯ä»¥å®ç°SNSä¸­çš„å¥½å‹æ¨èå’Œblogçš„tagåŠŸèƒ½</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sadd(<span class="string">&quot;col&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>);<span class="comment">//å‘é›†åˆä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;smembers(<span class="string">&quot;col&quot;</span>);<span class="comment">//é›†åˆå…ƒç´ åˆ—è¡¨</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;srem(<span class="string">&quot;col&quot;</span>,<span class="string">&#x27;d&#x27;</span>);<span class="comment">//é›†åˆç§»é™¤å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;spop(<span class="string">&quot;col&quot;</span>);<span class="comment">//éšæœºåˆ é™¤é›†åˆå…ƒç´ å¹¶è¿”å›åˆ é™¤çš„å…ƒç´ ã€‚åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ æ—¶ï¼Œåˆ™é›†åˆä¹Ÿè¢«åˆ é™¤</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sdiff(<span class="string">&quot;set1&quot;</span>,<span class="string">&quot;set2&quot;</span>);<span class="comment">//å–å¤šä¸ªé›†åˆçš„å·®é›†ï¼Œè°åœ¨å‰é¢å·²è°ä¸ºæ ‡å‡†ï¼ˆå·®é›†å°±æ˜¯å‰é¢ç¬¬ä¸€ä¸ªé›†åˆæœ‰è€Œåé¢æ‰€æœ‰é›†åˆéƒ½æ²¡æœ‰ï¼‰</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sdiffstore(<span class="string">&quot;dif&quot;</span>,<span class="string">&quot;set1&quot;</span>,<span class="string">&quot;set2&quot;</span>);<span class="comment">//è¿”å›å¤šä¸ªé›†åˆçš„å·®é›†ï¼Œå­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sinter(<span class="string">&quot;set&quot;</span>,<span class="string">&quot;set1&quot;</span>,<span class="string">&#x27;set2&#x27;</span>);<span class="comment">//äº¤é›†ï¼ˆæ‰€æœ‰é›†åˆéƒ½æœ‰çš„å…ƒç´ ï¼‰</span></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$redis</span>-&gt;sinterstore(<span class="string">&quot;inter&quot;</span>,<span class="string">&quot;set&quot;</span>,<span class="string">&quot;set1&quot;</span>);<span class="comment">///å–å¤šä¸ªé›†åˆçš„äº¤é›†,å­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sunion(<span class="string">&quot;set&quot;</span>,<span class="string">&quot;set1&quot;</span>,<span class="string">&#x27;set2&#x27;</span>);<span class="comment">//å¹¶é›†ï¼ˆæ‰€æœ‰é›†åˆåˆå¹¶å»é‡çš„å…ƒç´ ï¼‰</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sunionstore(<span class="string">&quot;union&quot;</span>,<span class="string">&quot;set&quot;</span>,<span class="string">&quot;set1&quot;</span>);<span class="comment">///å–å¤šä¸ªé›†åˆçš„å¹¶é›†,å­˜åœ¨ç¬¬ä¸‰ä¸ªé›†åˆé‡Œé¢</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;smove(<span class="string">&quot;set1&quot;</span>,<span class="string">&quot;set2&quot;</span>,<span class="string">&quot;value&quot;</span>);<span class="comment">///ç¬¬ä¸€ä¸ªé›†åˆå…ƒç´ å‰ªåˆ‡åˆ°ç¬¬äºŒä¸ªé›†åˆé‡Œé¢ã€‚</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;scard(<span class="string">&quot;set&quot;</span>);<span class="comment">//è¿”å›é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;sismember(<span class="string">&quot;set&quot;</span>,<span class="string">&quot;value&quot;</span>);<span class="comment">//åˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦ä¸ºé›†åˆçš„å…ƒç´ </span></span><br><span class="line"><span class="variable">$redis</span>-&gt;srandmember(<span class="string">&quot;set&quot;</span>);<span class="comment">//éšæœºè¿”å›é›†åˆå†…çš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸ä¼šåˆ é™¤å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="variable">$redis</span>-&gt;keys(<span class="string">&quot;*&quot;</span>);   <span class="comment">//è¿”å›æ‰€æœ‰key</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;keys(<span class="string">&quot;*t&quot;</span>);   <span class="comment">//è¿”å›æ‰€æœ‰så¼€å¤´çš„key</span></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$redis</span>-&gt;keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$res</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$v</span>.<span class="string">&quot;=&gt;&quot;</span>.<span class="variable">$redis</span>-&gt;get(<span class="variable">$v</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$redis</span>-&gt;exists(<span class="string">&quot;set&quot;</span>);   <span class="comment">//åˆ¤æ–­è¯¥keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;del(<span class="string">&quot;inter&quot;</span>);   <span class="comment">//åˆ é™¤è¯¥key</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;expire(<span class="string">&quot;set2&quot;</span>,<span class="number">100</span>);   <span class="comment">//è®¾ç½®key è¿‡æœŸæ—¶é—´10s</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;ttl(<span class="string">&quot;set3&quot;</span>);<span class="comment">//æŸ¥çœ‹è¿‡æœŸå‰©ä½™æ—¶é—´s</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$redis</span>-&gt;select(<span class="string">&quot;1&quot;</span>);<span class="comment">// é€‰æ‹©æ•°æ®åº“</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;test&quot;</span>);<span class="comment">// è®¾ç½®key=&gt;value</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;get(<span class="string">&quot;name&quot;</span>);<span class="comment">// æ ¹æ®keyè·å–value</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;move(<span class="string">&quot;get&quot;</span>,<span class="number">1</span>);<span class="comment">// æŠŠkeyç§»åˆ°å¦ä¸€ä¸ªæ•°æ®åº“</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;persist(<span class="string">&quot;set2&quot;</span>);<span class="comment">// ç§»é™¤è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;randomkey();<span class="comment">//éšæœºè¿”å›ä¸€ä¸ªkey</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;rename(<span class="string">&quot;names&quot;</span>,<span class="string">&quot;newname&quot;</span>);<span class="comment">//é‡å‘½åkey</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;type(<span class="string">&quot;zset&quot;</span>);<span class="comment">//è·å–keyç±»å‹</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;dbsize();<span class="comment">//è·å–æ•°æ®åº“keyä¸ªæ•°</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;info();<span class="comment">//è·å–redisæœåŠ¡ä¿¡æ¯</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;echo(<span class="string">&quot;helloï¼Œworld&quot;</span>);<span class="comment">//è¾“å‡ºå‡½æ•°</span></span><br><span class="line"><span class="comment">//******************************seté›†åˆ**********************************************************</span></span><br><span class="line"><span class="comment">//redisæœ‰äº”å¤§æ•°æ®ç±»å‹</span></span><br><span class="line"><span class="comment">//å­—ç¬¦ä¸² string</span></span><br><span class="line"><span class="comment">//hash è¡¨</span></span><br><span class="line"><span class="comment">//é“¾è¡¨ç»“æ„ list</span></span><br><span class="line"><span class="comment">//set é›†åˆ(æ— åº)</span></span><br><span class="line"><span class="comment">//zset æœ‰åºé›†åˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//stringæ¥å­˜å‚¨ç”¨æˆ·çš„æœ€å¤§id,ç”¨æ¥idçš„è‡ªå¢</span></span><br><span class="line"><span class="comment">//hash è¡¨æ¥å­˜å‚¨ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="comment">//listé“¾è¡¨ç»“æ„æ¥å­˜å‚¨ç”¨æˆ·çš„idå·</span></span><br><span class="line"><span class="variable">$uid</span> = <span class="variable">$redis</span>-&gt;incr(<span class="string">&quot;blog:id&quot;</span>);  <span class="comment">//è‡ªå¢é•¿</span></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$redis</span>-&gt;hmset(<span class="string">&#x27;blog:user:&#x27;</span> . <span class="variable">$uid</span>, <span class="keyword">array</span>(<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$uid</span>, <span class="string">&#x27;username&#x27;</span> =&gt;<span class="string">&#x27;admin&#x27;</span>.time() . time(), <span class="string">&#x27;password&#x27;</span> =&gt; md5(time()))); <span class="comment">//hashè¡¨æ’å…¥ä¸€æ¡è®°å½•</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;rpush(<span class="string">&quot;blog:uid&quot;</span>, <span class="variable">$uid</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$redis</span>-&gt;hgetall(<span class="string">&quot;blog:user:&quot;</span>.<span class="variable">$uid</span>);</span><br><span class="line"><span class="variable">$redis</span>-&gt;del(<span class="string">&quot;blog:user:&quot;</span>.<span class="variable">$uid</span>);<span class="comment">//åˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;lrem(<span class="string">&quot;blog:uid&quot;</span>,<span class="variable">$uid</span>);<span class="comment">//åˆ é™¤é“¾è¡¨ä¸­çš„id</span></span><br><span class="line">print_R(<span class="variable">$res</span>);<span class="keyword">die</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$count</span> = <span class="variable">$redis</span>-&gt;lsize(<span class="string">&quot;blog:uid&quot;</span>); <span class="comment">//listç±»å‹countæ€»æ•° </span></span><br><span class="line"><span class="variable">$page_size</span> = <span class="number">3</span>;</span><br><span class="line"><span class="variable">$page_num</span> = !<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>] : <span class="number">1</span>;</span><br><span class="line"><span class="variable">$page_count</span> = ceil(<span class="variable">$count</span> / <span class="variable">$page_size</span>);</span><br><span class="line"><span class="variable">$ids</span> = <span class="variable">$redis</span>-&gt;lrange(<span class="string">&quot;blog:uid&quot;</span>, (<span class="variable">$page_num</span> - <span class="number">1</span>) * <span class="variable">$page_size</span>, ((<span class="variable">$page_num</span> - <span class="number">1</span>) * <span class="variable">$page_size</span> + <span class="variable">$page_size</span> - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$ids</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line"><span class="variable">$ress</span>[] = <span class="variable">$redis</span>-&gt;hgetall(<span class="string">&quot;blog:user:&quot;</span> . <span class="variable">$v</span>); <span class="comment">//è·å–è®°å½•</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span><span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">print_r(<span class="variable">$ress</span>);</span><br></pre></td></tr></table></figure><p>åŸæ–‡é“¾æ¥:<br><a href="https://www.jianshu.com/p/c1c798828477" title="phpæ“ä½œredisç¬”è®°ï¼">phpæ“ä½œredisç¬”è®°ï¼</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é‡Œä¸»è¦æ˜¯ç”¨çš„predis&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="redis" scheme="https://hexo.lilis.xin/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>laravel-adminå®‰è£…</title>
    <link href="https://hexo.lilis.xin/posts/16eb654d/"/>
    <id>https://hexo.lilis.xin/posts/16eb654d/</id>
    <published>2018-09-10T04:13:57.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>1.5ç‰ˆæœ¬éœ€è¦å®‰è£…PHP 7+å’ŒLaravel 5.5</p><p>é¦–å…ˆç¡®ä¿å®‰è£…å¥½äº†laravelï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥è®¾ç½®æ­£ç¡®ã€‚</p><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer <span class="keyword">require</span> encore/laravel-admin <span class="string">&quot;1.5.*&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å‘å¸ƒèµ„æºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan vendor:publish --provider=<span class="string">&quot;Encore\Admin\AdminServiceProvider&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨è¯¥å‘½ä»¤ä¼šç”Ÿæˆé…ç½®æ–‡ä»¶config/admin.phpï¼Œå¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å®‰è£…çš„åœ°å€ã€æ•°æ®åº“è¿æ¥ã€ä»¥åŠè¡¨åï¼Œéƒ½å¯ä»¥ç”¨é»˜è®¤é…ç½®ä¸ä¿®æ”¹ã€‚</p><p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤å®Œæˆå®‰è£…ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan admin:install</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://localhost/admin/</code> ,ä½¿ç”¨ç”¨æˆ·å <code>admin</code> å’Œå¯†ç  <code>admin</code>ç™»é™†.<br>ps å¦‚æœæŠ¥ä¸€ä¸‹é”™è¯¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Specified key was too long error</span><br></pre></td></tr></table></figure><p>éœ€è¦åœ¨<code>/app/Providers/AppServiceProvider.php</code>æ–‡ä»¶ä¸­ä¿®æ”¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Providers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\&#123;</span><br><span class="line">    <span class="title">ServiceProvider</span>,</span><br><span class="line">    <span class="title">Facades</span>\<span class="title">Schema</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::defaultStringLength(<span class="number">191</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;1.5ç‰ˆæœ¬éœ€è¦å®‰è£…PHP 7+å’ŒLaravel 5.5&lt;/p&gt;
&lt;p&gt;é¦–å…ˆç¡®ä¿å®‰è£…å¥½äº†laravelï¼Œå¹¶ä¸”æ•°æ®åº“è¿æ¥è®¾ç½®æ­£ç¡®ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="https://hexo.lilis.xin/tags/PHP/"/>
    
      <category term="laravel" scheme="https://hexo.lilis.xin/tags/laravel/"/>
    
      <category term="laravel-admin" scheme="https://hexo.lilis.xin/tags/laravel-admin/"/>
    
  </entry>
  
  <entry>
    <title>Hashç´¢å¼•å’ŒB-Treeç´¢å¼•</title>
    <link href="https://hexo.lilis.xin/posts/294f33b7/"/>
    <id>https://hexo.lilis.xin/posts/294f33b7/</id>
    <published>2018-08-28T12:03:58.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ç´¢å¼•æ˜¯å¸®åŠ©mysqlè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚æœ€å¸¸è§çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•å’ŒHashç´¢å¼•ã€‚</p><p>ä¸åŒçš„å¼•æ“å¯¹äºç´¢å¼•æœ‰ä¸åŒçš„æ”¯æŒï¼šInnodbå’ŒMyISAMé»˜è®¤çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•ï¼›è€ŒMermoryé»˜è®¤çš„ç´¢å¼•æ˜¯Hashç´¢å¼•ã€‚</p><a id="more"></a><p>åŸæ–‡é“¾æ¥ï¼š<br><a href="https://blog.csdn.net/u014307117/article/details/47325091" title="Hashç´¢å¼•å’ŒBTreeç´¢å¼•">Hashç´¢å¼•å’ŒBTreeç´¢å¼•</a></p><h3 id="Hashç´¢å¼•"><a class="header-anchor" href="#Hashç´¢å¼•">â¡ï¸</a>Hashç´¢å¼•</h3><p>æ‰€è°“Hashç´¢å¼•ï¼Œå½“æˆ‘ä»¬è¦ç»™æŸå¼ è¡¨æŸåˆ—å¢åŠ ç´¢å¼•æ—¶ï¼Œå°†è¿™å¼ è¡¨çš„è¿™ä¸€åˆ—è¿›è¡Œå“ˆå¸Œç®—æ³•è®¡ç®—ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œæ’åºåœ¨å“ˆå¸Œæ•°ç»„ä¸Šã€‚æ‰€ä»¥Hashç´¢å¼•å¯ä»¥ä¸€æ¬¡å®šä½ï¼Œå…¶æ•ˆç‡å¾ˆé«˜ï¼Œè€ŒBtreeç´¢å¼•éœ€è¦ç»è¿‡å¤šæ¬¡çš„ç£ç›˜IOï¼Œä½†æ˜¯innodbå’Œmyisamä¹‹æ‰€ä»¥æ²¡æœ‰é‡‡ç”¨å®ƒï¼Œæ˜¯å› ä¸ºå®ƒå­˜åœ¨ç€å¥½å¤šç¼ºç‚¹ï¼š<br>å› ä¸ºHashç´¢å¼•æ¯”è¾ƒçš„æ˜¯ç»è¿‡Hashè®¡ç®—çš„å€¼ï¼Œæ‰€ä»¥åªèƒ½è¿›è¡Œç­‰å¼æ¯”è¾ƒï¼Œä¸èƒ½ç”¨äºèŒƒå›´æŸ¥è¯¢</p><ul><li>æ¯æ¬¡éƒ½è¦å…¨è¡¨æ‰«æ</li><li>ç”±äºå“ˆå¸Œå€¼æ˜¯æŒ‰ç…§é¡ºåºæ’åˆ—çš„ï¼Œä½†æ˜¯å“ˆå¸Œå€¼æ˜ å°„çš„çœŸæ­£æ•°æ®åœ¨å“ˆå¸Œè¡¨ä¸­å°±ä¸ä¸€å®šæŒ‰ç…§é¡ºåºæ’åˆ—ï¼Œæ‰€ä»¥æ— æ³•åˆ©ç”¨Hashç´¢å¼•æ¥åŠ é€Ÿä»»ä½•æ’åºæ“ä½œ</li><li>ä¸èƒ½ç”¨éƒ¨åˆ†ç´¢å¼•é”®æ¥æœç´¢ï¼Œå› ä¸ºç»„åˆç´¢å¼•åœ¨è®¡ç®—å“ˆå¸Œå€¼çš„æ—¶å€™æ˜¯ä¸€èµ·è®¡ç®—çš„ã€‚</li><li>å½“å“ˆå¸Œå€¼å¤§é‡é‡å¤ä¸”æ•°æ®é‡éå¸¸å¤§æ—¶ï¼Œå…¶æ£€ç´¢æ•ˆç‡å¹¶æ²¡æœ‰Btreeç´¢å¼•é«˜çš„ã€‚</li></ul><h3 id="B-Treeç´¢å¼•"><a class="header-anchor" href="#B-Treeç´¢å¼•">â¡ï¸</a>B-Treeç´¢å¼•</h3><p>è‡³äºBtreeç´¢å¼•ï¼Œå®ƒæ˜¯ä»¥B+æ ‘ä¸ºå­˜å‚¨ç»“æ„å®ç°çš„ã€‚</p><p>ä½†æ˜¯Btreeç´¢å¼•çš„å­˜å‚¨ç»“æ„åœ¨Innodbå’ŒMyISAMä¸­æœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><p>åœ¨MyISAMä¸­ï¼Œæˆ‘ä»¬å¦‚æœè¦å¯¹æŸå¼ è¡¨çš„æŸåˆ—å»ºç«‹Btreeç´¢å¼•çš„è¯ï¼Œå¦‚å›¾ï¼š<br><img src="https://img-blog.csdn.net/20150806231335315"><br>æ‰€ä»¥æˆ‘ä»¬ç»å¸¸ä¼šè¯´MyISAMä¸­æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶æ˜¯åˆ†å¼€çš„ã€‚</p><p>å› æ­¤MyISAMçš„ç´¢å¼•æ–¹å¼ä¹Ÿç§°ä¸ºéèšé›†ï¼ŒInnodbçš„ç´¢å¼•æ–¹å¼æˆä¸ºèšé›†ç´¢å¼•ã€‚</p><p>è‡³äºè¾…åŠ©ç´¢å¼•ï¼Œç±»ä¼¼äºä¸»ç´¢å¼•ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ä¸»ç´¢å¼•ä¸Šçš„å€¼ä¸èƒ½é‡å¤ï¼Œè€Œè¾…åŠ©ç´¢å¼•å¯ä»¥é‡å¤ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç´¢å¼•æ˜¯å¸®åŠ©mysqlè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚æœ€å¸¸è§çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•å’ŒHashç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„å¼•æ“å¯¹äºç´¢å¼•æœ‰ä¸åŒçš„æ”¯æŒï¼šInnodbå’ŒMyISAMé»˜è®¤çš„ç´¢å¼•æ˜¯Btreeç´¢å¼•ï¼›è€ŒMermoryé»˜è®¤çš„ç´¢å¼•æ˜¯Hashç´¢å¼•ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="https://hexo.lilis.xin/tags/MySQL/"/>
    
      <category term="æ•°æ®ç»“æ„" scheme="https://hexo.lilis.xin/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨</title>
    <link href="https://hexo.lilis.xin/posts/3d56cf7f/"/>
    <id>https://hexo.lilis.xin/posts/3d56cf7f/</id>
    <published>2018-08-23T03:33:28.000Z</published>
    <updated>2019-09-12T06:27:03.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>saræ˜¯System Activity Reporterï¼ˆç³»ç»Ÿæ´»åŠ¨æƒ…å†µæŠ¥å‘Šï¼‰çš„ç¼©å†™ã€‚sarå·¥å…·å°†å¯¹ç³»ç»Ÿå½“å‰çš„çŠ¶æ€è¿›è¡Œå–æ ·ï¼Œç„¶åé€šè¿‡è®¡ç®—æ•°æ®å’Œæ¯”ä¾‹æ¥è¡¨è¾¾ç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥è¿ç»­å¯¹ç³»ç»Ÿå–æ ·ï¼Œè·å¾—å¤§é‡çš„å–æ ·æ•°æ®ï¼›å–æ ·æ•°æ®å’Œåˆ†æçš„ç»“æœéƒ½å¯ä»¥å­˜å…¥æ–‡ä»¶ï¼Œæ‰€éœ€çš„è´Ÿè½½å¾ˆå°ã€‚saræ˜¯ç›®å‰Linuxä¸Šæœ€ä¸ºå…¨é¢çš„ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥ä»14ä¸ªå¤§æ–¹é¢å¯¹ç³»ç»Ÿçš„æ´»åŠ¨è¿›è¡ŒæŠ¥å‘Šï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„è¯»å†™æƒ…å†µã€ç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µã€ä¸²å£ã€CPUæ•ˆç‡ã€å†…å­˜ä½¿ç”¨çŠ¶å†µã€è¿›ç¨‹æ´»åŠ¨åŠIPCæœ‰å…³çš„æ´»åŠ¨ç­‰ï¼Œä½¿ç”¨ä¹Ÿæ˜¯è¾ƒä¸ºå¤æ‚ã€‚</p><a id="more"></a><p>åŸæ–‡é“¾æ¥:<br><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/sar.html" title="sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨">sar æ‰¾å‡ºç³»ç»Ÿç“¶é¢ˆçš„åˆ©å™¨</a><br>saræ˜¯æŸ¥çœ‹æ“ä½œç³»ç»ŸæŠ¥å‘ŠæŒ‡æ ‡çš„å„ç§å·¥å…·ä¸­ï¼Œæœ€ä¸ºæ™®éå’Œæ–¹ä¾¿çš„ï¼›å®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼›</p><ol><li>è¿½æº¯è¿‡å»çš„ç»Ÿè®¡æ•°æ®ï¼ˆé»˜è®¤ï¼‰</li><li>å‘¨æœŸæ€§çš„æŸ¥çœ‹å½“å‰æ•°æ®</li></ol><h3 id="æŸ¥çœ‹CPUä½¿ç”¨ç‡"><a class="header-anchor" href="#æŸ¥çœ‹CPUä½¿ç”¨ç‡">â¡ï¸</a>æŸ¥çœ‹CPUä½¿ç”¨ç‡</h3><p><code>sar -u</code> é»˜è®¤æƒ…å†µä¸‹æ˜¾ç¤ºçš„cpuä½¿ç”¨ç‡ç­‰ä¿¡æ¯å°±æ˜¯<code>sar -u</code>;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -u</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">12:00:01 AM     CPU     %user     %nice   %system   %iowait    %steal     %idle</span><br><span class="line">12:10:01 AM     all      0.85      0.00      0.29      0.04      0.00     98.83</span><br><span class="line">12:20:01 AM     all      1.63      0.00      0.34      0.07      0.00     97.96</span><br><span class="line">12:30:01 AM     all      0.73      0.00      0.25      0.04      0.00     98.98</span><br><span class="line">12:40:01 AM     all      0.28      0.00      0.25      0.01      0.00     99.46</span><br><span class="line">12:50:01 AM     all      0.31      0.00      0.26      0.01      0.00     99.43</span><br><span class="line">01:00:01 AM     all      1.63      0.00      0.34      0.10      0.00     97.94</span><br><span class="line">01:10:01 AM     all      0.66      0.00      0.29      0.03      0.00     99.02</span><br><span class="line">01:20:01 AM     all      1.27      0.00      0.30      0.06      0.00     98.37</span><br><span class="line">01:30:01 AM     all      0.29      0.00      0.27      0.01      0.00     99.44</span><br></pre></td></tr></table></figure><ul><li>%user ç”¨æˆ·æ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹ï¼›</li><li>%nice é€šè¿‡niceæ”¹å˜äº†è¿›ç¨‹è°ƒåº¦ä¼˜å…ˆçº§çš„è¿›ç¨‹ï¼Œåœ¨ç”¨æˆ·æ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹</li><li>%system ç³»ç»Ÿæ¨¡å¼ä¸‹æ¶ˆè€—çš„CPUæ—¶é—´çš„æ¯”ä¾‹ï¼›</li><li>%iowait CPUç­‰å¾…ç£ç›˜I/Oå¯¼è‡´ç©ºé—²çŠ¶æ€æ¶ˆè€—çš„æ—¶é—´æ¯”ä¾‹ï¼›</li><li>%steal åˆ©ç”¨Xenç­‰æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œç­‰å¾…å…¶å®ƒè™šæ‹ŸCPUè®¡ç®—å ç”¨çš„æ—¶é—´æ¯”ä¾‹ï¼›</li><li>%idle CPUç©ºé—²æ—¶é—´æ¯”ä¾‹ï¼›</li></ul><h3 id="æŸ¥çœ‹å¹³å‡è´Ÿè½½"><a class="header-anchor" href="#æŸ¥çœ‹å¹³å‡è´Ÿè½½">â¡ï¸</a>æŸ¥çœ‹å¹³å‡è´Ÿè½½</h3><p><code>sar -q</code> æŸ¥çœ‹å¹³å‡è´Ÿè½½<br>æŒ‡å®š-qåï¼Œå°±èƒ½æŸ¥çœ‹è¿è¡Œé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹æ•°ã€ç³»ç»Ÿä¸Šçš„è¿›ç¨‹å¤§å°ã€å¹³å‡è´Ÿè½½ç­‰ï¼›ä¸å…¶å®ƒå‘½ä»¤ç›¸æ¯”ï¼Œå®ƒèƒ½æŸ¥çœ‹å„é¡¹æŒ‡æ ‡éšæ—¶é—´å˜åŒ–çš„æƒ…å†µï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -q</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">12:00:01 AM   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15   blocked</span><br><span class="line">12:10:01 AM         3       187      0.00      0.02      0.05         0</span><br><span class="line">12:20:01 AM         4       190      0.06      0.03      0.05         0</span><br><span class="line">12:30:01 AM         4       187      0.00      0.01      0.05         1</span><br><span class="line">12:40:01 AM         3       187      0.00      0.01      0.05         0</span><br><span class="line">12:50:01 AM         3       187      0.07      0.10      0.08         1</span><br><span class="line">01:00:01 AM         2       190      0.24      0.08      0.06         0</span><br><span class="line">01:10:01 AM         2       187      0.08      0.03      0.05         0</span><br><span class="line">01:20:01 AM         1       187      0.00      0.03      0.05         1</span><br><span class="line">01:30:01 AM         3       187      0.00      0.01      0.05         0</span><br><span class="line">01:40:01 AM         2       187      0.01      0.03      0.05         1</span><br><span class="line">01:50:01 AM         3       187      0.00      0.01      0.05         1</span><br><span class="line">02:00:01 AM         2       187      0.00      0.01      0.05         0</span><br><span class="line">02:10:01 AM         3       190      0.00      0.04      0.05         0</span><br></pre></td></tr></table></figure><ul><li>runq-szï¼šè¿è¡Œé˜Ÿåˆ—çš„é•¿åº¦ï¼ˆç­‰å¾…è¿è¡Œçš„è¿›ç¨‹æ•°ï¼‰</li><li>plist-szï¼šè¿›ç¨‹åˆ—è¡¨ä¸­è¿›ç¨‹ï¼ˆprocessesï¼‰å’Œçº¿ç¨‹ï¼ˆthreadsï¼‰çš„æ•°é‡</li><li>ldavg-1ï¼šæœ€å1åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½ ldavg-5ï¼šè¿‡å»5åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½</li><li>ldavg-15ï¼šè¿‡å»15åˆ†é’Ÿçš„ç³»ç»Ÿå¹³å‡è´Ÿè½½</li></ul><h3 id="æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ"><a class="header-anchor" href="#æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ">â¡ï¸</a>æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ</h3><p><code>sar -W</code> æŸ¥çœ‹é¡µé¢äº¤æ¢å‘ç”ŸçŠ¶å†µ<br>é¡µé¢å‘ç”Ÿäº¤æ¢æ—¶ï¼ŒæœåŠ¡å™¨çš„ååé‡ä¼šå¤§å¹…ä¸‹é™ï¼›æœåŠ¡å™¨çŠ¶å†µä¸è‰¯æ—¶ï¼Œå¦‚æœæ€€ç–‘å› ä¸ºå†…å­˜ä¸è¶³è€Œå¯¼è‡´äº†é¡µé¢äº¤æ¢çš„å‘ç”Ÿï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥ç¡®è®¤æ˜¯å¦å‘ç”Ÿäº†å¤§é‡çš„äº¤æ¢ï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@lilis ~]# sar -W 1 10</span><br><span class="line">Linux 3.10.0-862.9.1.el7.x86_64 (lilis) 08/23/2018 _x86_64_(1 CPU)</span><br><span class="line"></span><br><span class="line">11:43:35 AM  pswpin/s pswpout/s</span><br><span class="line">11:43:36 AM      0.00      0.00</span><br><span class="line">11:43:37 AM      0.00      0.00</span><br><span class="line">11:43:38 AM      0.00      0.00</span><br><span class="line">11:43:39 AM      0.00      0.00</span><br><span class="line">11:43:40 AM      0.00      0.00</span><br><span class="line">11:43:41 AM      0.00      0.00</span><br><span class="line">11:43:42 AM      0.00      0.00</span><br><span class="line">11:43:43 AM      0.00      0.00</span><br><span class="line">11:43:44 AM      0.00      0.00</span><br><span class="line">11:43:45 AM      0.00      0.00</span><br><span class="line">Average:         0.00      0.00</span><br></pre></td></tr></table></figure><ul><li><p>pswpin/sï¼šæ¯ç§’ç³»ç»Ÿæ¢å…¥çš„äº¤æ¢é¡µé¢ï¼ˆswap pageï¼‰æ•°é‡</p></li><li><p>pswpout/sï¼šæ¯ç§’ç³»ç»Ÿæ¢å‡ºçš„äº¤æ¢é¡µé¢ï¼ˆswap pageï¼‰æ•°é‡<br>è¦åˆ¤æ–­ç³»ç»Ÿç“¶é¢ˆé—®é¢˜ï¼Œæœ‰æ—¶éœ€å‡ ä¸ª sar å‘½ä»¤é€‰é¡¹ç»“åˆèµ·æ¥ï¼›</p></li><li><p>æ€€ç–‘CPUå­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨ sar -u å’Œ sar -q ç­‰æ¥æŸ¥çœ‹</p></li><li><p>æ€€ç–‘å†…å­˜å­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨sar -Bã€sar -r å’Œ sar -W ç­‰æ¥æŸ¥çœ‹</p></li><li><p>æ€€ç–‘I/Oå­˜åœ¨ç“¶é¢ˆï¼Œå¯ç”¨ sar -bã€sar -u å’Œ sar -d ç­‰æ¥æŸ¥çœ‹</p></li></ul><h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">â¡ï¸</a>å®‰è£…</h3><p>æœ‰çš„linuxç³»ç»Ÿä¸‹ï¼Œé»˜è®¤å¯èƒ½æ²¡æœ‰å®‰è£…è¿™ä¸ªåŒ…ï¼Œä½¿ç”¨<code>yum install sysstat</code> æ¥å®‰è£…ï¼›<br>å®‰è£…å®Œæ¯•ï¼Œå°†æ€§èƒ½æ”¶é›†å·¥å…·çš„å¼€å…³æ‰“å¼€ï¼š <code>vim /etc/default/sysstat</code><br>è®¾ç½® ENABLED=â€trueâ€</p><h3 id="sarå‚æ•°è¯´æ˜"><a class="header-anchor" href="#sarå‚æ•°è¯´æ˜">â¡ï¸</a>sarå‚æ•°è¯´æ˜</h3><ul><li>-A æ±‡æ€»æ‰€æœ‰çš„æŠ¥å‘Š</li><li>-a æŠ¥å‘Šæ–‡ä»¶è¯»å†™ä½¿ç”¨æƒ…å†µ</li><li>-B æŠ¥å‘Šé™„åŠ çš„ç¼“å­˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-b æŠ¥å‘Šç¼“å­˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-c æŠ¥å‘Šç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µ</li><li>-d æŠ¥å‘Šç£ç›˜çš„ä½¿ç”¨æƒ…å†µ</li><li>-g æŠ¥å‘Šä¸²å£çš„ä½¿ç”¨æƒ…å†µ</li><li>-h æŠ¥å‘Šå…³äºbufferä½¿ç”¨çš„ç»Ÿè®¡æ•°æ®</li><li>-m æŠ¥å‘ŠIPCæ¶ˆæ¯é˜Ÿåˆ—å’Œä¿¡å·é‡çš„ä½¿ç”¨æƒ…å†µ</li><li>-n æŠ¥å‘Šå‘½åcacheçš„ä½¿ç”¨æƒ…å†µ</li><li>-p æŠ¥å‘Šè°ƒé¡µæ´»åŠ¨çš„ä½¿ç”¨æƒ…å†µ</li><li>-q æŠ¥å‘Šè¿è¡Œé˜Ÿåˆ—å’Œäº¤æ¢é˜Ÿåˆ—çš„å¹³å‡é•¿åº¦</li><li>-R æŠ¥å‘Šè¿›ç¨‹çš„æ´»åŠ¨æƒ…å†µ</li><li>-r æŠ¥å‘Šæ²¡æœ‰ä½¿ç”¨çš„å†…å­˜é¡µé¢å’Œç¡¬ç›˜å—</li><li>-u æŠ¥å‘ŠCPUçš„åˆ©ç”¨ç‡</li><li>-v æŠ¥å‘Šè¿›ç¨‹ã€ièŠ‚ç‚¹ã€æ–‡ä»¶å’Œé”è¡¨çŠ¶æ€</li><li>-w æŠ¥å‘Šç³»ç»Ÿäº¤æ¢æ´»åŠ¨çŠ¶å†µ</li><li>-y æŠ¥å‘ŠTTYè®¾å¤‡æ´»åŠ¨çŠ¶å†µ</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;saræ˜¯System Activity Reporterï¼ˆç³»ç»Ÿæ´»åŠ¨æƒ…å†µæŠ¥å‘Šï¼‰çš„ç¼©å†™ã€‚sarå·¥å…·å°†å¯¹ç³»ç»Ÿå½“å‰çš„çŠ¶æ€è¿›è¡Œå–æ ·ï¼Œç„¶åé€šè¿‡è®¡ç®—æ•°æ®å’Œæ¯”ä¾‹æ¥è¡¨è¾¾ç³»ç»Ÿçš„å½“å‰è¿è¡ŒçŠ¶æ€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥è¿ç»­å¯¹ç³»ç»Ÿå–æ ·ï¼Œè·å¾—å¤§é‡çš„å–æ ·æ•°æ®ï¼›å–æ ·æ•°æ®å’Œåˆ†æçš„ç»“æœéƒ½å¯ä»¥å­˜å…¥æ–‡ä»¶ï¼Œæ‰€éœ€çš„è´Ÿè½½å¾ˆå°ã€‚saræ˜¯ç›®å‰Linuxä¸Šæœ€ä¸ºå…¨é¢çš„ç³»ç»Ÿæ€§èƒ½åˆ†æå·¥å…·ä¹‹ä¸€ï¼Œå¯ä»¥ä»14ä¸ªå¤§æ–¹é¢å¯¹ç³»ç»Ÿçš„æ´»åŠ¨è¿›è¡ŒæŠ¥å‘Šï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„è¯»å†™æƒ…å†µã€ç³»ç»Ÿè°ƒç”¨çš„ä½¿ç”¨æƒ…å†µã€ä¸²å£ã€CPUæ•ˆç‡ã€å†…å­˜ä½¿ç”¨çŠ¶å†µã€è¿›ç¨‹æ´»åŠ¨åŠIPCæœ‰å…³çš„æ´»åŠ¨ç­‰ï¼Œä½¿ç”¨ä¹Ÿæ˜¯è¾ƒä¸ºå¤æ‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://hexo.lilis.xin/tags/Linux/"/>
    
  </entry>
  
</feed>
